<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>12.10. Action variables</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Action variables" -->
<!-- SEARCH SECTION "12.10" -->
<!-- SEARCH SORT "000-012-010-000" -->
<!-- START IGNORE 185 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc185.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 12: Advanced Actions</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc187.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง12.10. Action variables</p>
<p>For some complex situations, it can be useful to keep track of a few values throughout the processing of the action. This is not an everyday occurrence: in the Standard Rules, for instance, only two or three out of 90 actions need to do this. But suppose we want to write a more deluxe version of our &quot;photographing&quot; action. This time, rather than having a single thing called the &quot;camera&quot;, we will provide a whole range of possible cameras, varying in quality:</p>
<!-- START CODE "c3353" -->
<a id="c3353"></a><blockquote class="code"><p class="quoted">
Photographing is an action applying to one visible thing and requiring light. Understand &quot;photograph [something]&quot; as photographing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3354" -->
<a id="c3354"></a><blockquote class="code"><p class="quoted">
The Studio is a room. Sally is a woman in the Studio. A foam-lined tote bag is in the Studio.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3355" -->
<a id="c3355"></a><blockquote class="code"><p class="quoted">
A camera is a kind of thing. A camera has a number called picture quality. The digital SLR camera is a camera in the tote bag. The player carries a camera called the instant one-shot camera. The picture quality of the SLR camera is 10. The picture quality of the one-shot is 2. Definition: a camera is sharp if its picture quality is 5 or more.
</p></blockquote>
<!-- END CODE -->
<p>And we will want the photographing action to have the player use the best-quality camera which comes to hand. We will give the action a variable called the 'camera photographed with', thus:</p>
<!-- START CODE "c3356" -->
<a id="c3356"></a><blockquote class="code"><p class="quoted">
The photographing action has an object called the camera photographed with.
</p></blockquote>
<!-- END CODE -->
<p>Every action's variables must be named differently from those of all other actions, because there are some &quot;before&quot; rules (for instance) which take effect for many different actions, and which might need access to any of their variables. So action variables should be named in a way marking out to which action they belong. The best way to do this is to include the past participle of the action name - just as &quot;camera photographed with&quot; contains the past participle &quot;photographed&quot; of the action &quot;photographing&quot;.</p>
<p>This value is created when the action begins, and disappears when the action ends. (If the action should happen a second time before the first time was completed, a second copy of the value is created, leaving the original undisturbed.) When the action begins, the value starts out as something neutral - so if it is a number, it starts out as 0, if a text, it starts out as the blank text &quot;&quot;, and so on. Here it is an object, so it starts out as nothing - the value meaning no object at all. But of course we want to give it a value ourselves. We can do that using the &quot;setting action variables&quot; rulebook. For instance:</p>
<!-- START CODE "c3357" -->
<a id="c3357"></a><blockquote class="code"><p class="quoted">
Setting action variables for photographing:
<br />&#160;&#160;&#160;&#160;now the camera photographed with is the sharpest camera which is carried by the actor.
</p></blockquote>
<!-- END CODE -->
<p>The &quot;setting action variables&quot; rulebook is run through before even the before rules, and it has no power to stop or change the action. Its rules should say nothing and do nothing other than to set rulebook variables like this one. Note that it is intended to work for any actor, not only the player: so rather than referring to the player as the performer of the action, we need to write &quot;the actor&quot;, as in the example above. (See subsequent sections for more on actors.)</p>
<p>We can now write rules such as:</p>
<!-- START CODE "c3358" -->
<a id="c3358"></a><blockquote class="code"><p class="quoted">
A check photographing rule:
<br />&#160;&#160;&#160;&#160;if the camera photographed with is nothing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can hardly photograph without a camera, now can you?&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>Only rules to do with the photographing action - before, instead, after, check, carry out, or report rules, and so on - are allowed to see the 'camera photographed with' value: it's the private property of the action.</p>
<p>A further elaboration allows us to make rules about photographing neater to write. If we create our variable like so:</p>
<!-- START CODE "c3359" -->
<a id="c3359"></a><blockquote class="code"><p class="quoted">
The photographing action has an object called the camera photographed with (matched as &quot;using&quot;).
</p></blockquote>
<!-- END CODE -->
<p>...then we are now allowed to add an optional 'using ...' clause onto a description of the action. The clause has to be introduced with a single word: here, it's 'using'. For instance, we could write rules such as</p>
<!-- START CODE "c3360" -->
<a id="c3360"></a><blockquote class="code"><p class="quoted">
Instead of photographing something using the one-shot camera:
<br />&#160;&#160;&#160;&#160;say &quot;But you promised to give this to Sally's nephew.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3361" -->
<a id="c3361"></a><blockquote class="code"><p class="quoted">
Check photographing something using the noun:
<br />&#160;&#160;&#160;&#160;say &quot;That would require some sort of contraption with mirrors.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3362" -->
<a id="c3362"></a><blockquote class="code"><p class="quoted">
Report photographing something using a sharp camera:
<br />&#160;&#160;&#160;&#160;say &quot;You feel cool and important as the shutter clicks.&quot;
</p></blockquote>
<!-- END CODE -->
<p>(This is the method used by the Standard Rules to attach optional clauses such as 'to', 'with' and 'through' to the going action.)</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "198: The Second Oldest Problem" "e75" -->
<a id="e75"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example75'); return false;"><b>198</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example75'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Second Oldest Problem</span></b></a><br />Adapting the going action so that something special can happen when going from a dark room to another dark room.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc37.html#e75"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example75" style="display: none;">
<p>Text in this example is drawn from Will Crowther's original 1976 FORTRAN implementation of ADVENTURE, the founding work of the genre, whose source code was rediscovered by Dennis G. Jerz in 2007. Note the capitals: the program ran on an early computer without lower case lettering. They look a little mimsy now, but picture them glowing green on an old-style cathode ray tube monitor in a darkened room late at night.</p>
<p>The problem alluded to is that the player is forbidden to walk between two dark rooms, so that he must always have light to see by from at least one end of any movement. Writing source text to achieve this is tricky to get right in every case, because the determination of light is hard to do. Here we interleave the necessary rules into the existing &quot;going&quot; action, using a new action variable to record the number of ends which are dark as experienced by the player, which might be 0, 1 or 2:</p>
<!-- START CODE "c3363_75" -->
<a id="c3363_75"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]THE SECOND OLDEST PROBLEM[=0x0022=][=0x000A=][=0x000A=]The going action has a number called the dark terminus count.[=0x000A=]Setting action variables for going:[=0x000A=][=0x0009=]now the dark terminus count is 0;[=0x000A=][=0x0009=]if in darkness, increment the dark terminus count.[=0x000A=]The last carry out going rule:[=0x000A=][=0x0009=]if in darkness, increment the dark terminus count;[=0x000A=][=0x0009=]if the dark terminus count is 2, end the story saying [=0x0022=]YOU FELL INTO A PIT AND BROKE EVERY BONE IN YOUR BODY![=0x0022=] instead.[=0x000A=][=0x000A=][And now three early rooms to try this out.][=0x000A=][=0x000A=]COBBLE CRAWL is a room. [=0x0022=]YOU ARE CRAWLING OVER COBBLES IN A LOW PASSAGE. THERE IS A DIM LIGHT AT THE EAST END OF THE PASSAGE.[=0x0022=][=0x000A=][=0x000A=]DEBRIS ROOM is west of COBBLE CRAWL. [=0x0022=]YOU ARE IN A DEBRIS ROOM, FILLED WITH STUFF WASHED IN FROM THE SURFACE. A LOW WIDE PASSAGE WITH COBBLES BECOMES PLUGGED WITH MUD AND DEBRIS HERE,BUT AN AWKWARD CANYON LEADS UPWARD AND WEST.[=0x0022=][=0x000A=][=0x000A=]AWKWARD CANYON is west of DEBRIS ROOM. [=0x0022=]YOU ARE IN AN AWKWARD SLOPING EAST/WEST CANYON.[=0x0022=][=0x000A=][=0x000A=]DEBRIS ROOM and AWKWARD CANYON are dark.[=0x000A=][=0x000A=]Rule for printing the name of a dark room: say [=0x0022=]DARKNESS[=0x0022=] instead.[=0x000A=]Rule for printing the description of a dark room: say [=0x0022=]IT IS NOW PITCH BLACK. IF YOU PROCEED YOU WILL LIKELY FALL INTO A PIT.[=0x0022=] instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]w / e / w / w[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;THE SECOND OLDEST PROBLEM&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3364_75" -->
<a id="c3364_75"></a><blockquote class="code"><p class="quoted">
The going action has a number called the dark terminus count.
<br />Setting action variables for going:
<br />&#160;&#160;&#160;&#160;now the dark terminus count is 0;
<br />&#160;&#160;&#160;&#160;if in darkness, increment the dark terminus count.
<br />The last carry out going rule:
<br />&#160;&#160;&#160;&#160;if in darkness, increment the dark terminus count;
<br />&#160;&#160;&#160;&#160;if the dark terminus count is 2, end the story saying &quot;YOU FELL INTO A PIT AND BROKE EVERY BONE IN YOUR BODY!&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>And now three early rooms to try this out.</p>
<!-- START CODE "c3365_75" -->
<a id="c3365_75"></a><blockquote class="code"><p class="quoted">
COBBLE CRAWL is a room. &quot;YOU ARE CRAWLING OVER COBBLES IN A LOW PASSAGE. THERE IS A DIM LIGHT AT THE EAST END OF THE PASSAGE.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3366_75" -->
<a id="c3366_75"></a><blockquote class="code"><p class="quoted">
DEBRIS ROOM is west of COBBLE CRAWL. &quot;YOU ARE IN A DEBRIS ROOM, FILLED WITH STUFF WASHED IN FROM THE SURFACE. A LOW WIDE PASSAGE WITH COBBLES BECOMES PLUGGED WITH MUD AND DEBRIS HERE,BUT AN AWKWARD CANYON LEADS UPWARD AND WEST.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3367_75" -->
<a id="c3367_75"></a><blockquote class="code"><p class="quoted">
AWKWARD CANYON is west of DEBRIS ROOM. &quot;YOU ARE IN AN AWKWARD SLOPING EAST/WEST CANYON.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3368_75" -->
<a id="c3368_75"></a><blockquote class="code"><p class="quoted">
DEBRIS ROOM and AWKWARD CANYON are dark.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3369_75" -->
<a id="c3369_75"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a dark room: say &quot;DARKNESS&quot; instead.
<br />Rule for printing the description of a dark room: say &quot;IT IS NOW PITCH BLACK. IF YOU PROCEED YOU WILL LIKELY FALL INTO A PIT.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3370_75" -->
<a id="c3370_75"></a><blockquote class="code"><p class="quoted">
Test me with &quot;w / e / w / w&quot;.
</p></blockquote>
<!-- END CODE -->
<p>This is only the second oldest problem in the IF literature: the earliest puzzle is unlocking the steel grate which bars entrance to the cave.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "199: Further Reasons Why All Poets Are Liars" "e287" -->
<a id="e287"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example287'); return false;"><b>199</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example287'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Further Reasons Why All Poets Are Liars</span></b></a><br />The young William Wordsworth, pushing a box about in his room, must struggle to achieve a Romantic point of view.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc10.html#e287"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example287" style="display: none;">
<p>We begin with the location and its fittings, and we create a kind of value which names the different internal positions we will allow.</p>
<!-- START CODE "c3371_287" -->
<a id="c3371_287"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Further Reasons Why All Poets Are Liars[=0x0022=][=0x000A=][=0x000A=]Nook Obscure is a room. [=0x0022=]Above the College kitchens, which make a humming sound, less tuneable than bees, but hardly less industrious, with shrill notes of sharp command and scolding intermixed: and below Trinity[=0x0027=]s loquacious clock, who never lets the quarters, night or day, slip by him unproclaimed, and tells the hours twice over with a male and female voice. In short, the kind of rubbish room they give to a northern villager. But you get a bed and a high shelf all of your own. And you long to find some Romantic way to look out of the window.[=0x0022=][=0x000A=][=0x000A=]The window, the shelf and the bed are scenery in the Nook Obscure. The shelf and the bed are supporters. The bed is enterable.[=0x000A=][=0x000A=]Internal position is a kind of value. The internal positions are nowhere at all, over by the window, under the shelf and near the bed.[=0x000A=][=0x000A=]The box is an enterable supporter in Nook Obscure. The current box position is an internal position that varies. The current box position is near the bed. [=0x0022=]Your packing case, stamped W. WORDSWORTH (KENDAL), is [current box position].[=0x0022=] Instead of taking the box, say [=0x0022=]It is filled with your peerless rock collection and too heavy to lift, but could be pushed.[=0x0022=] Instead of opening the box, say [=0x0022=]It is securely nailed shut.[=0x0022=][=0x000A=][=0x000A=][We create an action, [=0x0022=]pushing it over to[=0x0022=], for pushing a box around on the floor of a single location. (Calling this [=0x0022=]pushing it over to[=0x0022=] prevents clashes with the existing [=0x0022=]pushing it to[=0x0022=] action, which is for pushing things from one room to another.) Almost half of the text which defines the action is concerned with the two action variables, but they make the implementation of everything else so much easier that we end up writing less than if we hadn[=0x0027=]t used them.][=0x000A=][=0x000A=]Understand [=0x0022=]push [box][=0x0022=] as a mistake ([=0x0022=]You can push the box to the window, the bed or the shelf.[=0x0022=]).[=0x000A=][=0x000A=]Understand [=0x0022=]push [something] to [something][=0x0022=] as pushing it over to. Pushing it over to is an action applying to two things.[=0x000A=][=0x000A=]The pushing it over to action has an internal position called the old position.[=0x000A=]The pushing it over to action has an internal position called the new position.[=0x000A=]Setting action variables for pushing something over to something:[=0x000A=][=0x0009=]now the old position is the current box position;[=0x000A=][=0x0009=]now the new position is nowhere at all;[=0x000A=][=0x0009=]if the second noun is the window, now the new position is over by the window;[=0x000A=][=0x0009=]if the second noun is the bed, now the new position is near the bed;[=0x000A=][=0x0009=]if the second noun is the shelf, now the new position is under the shelf.[=0x000A=][=0x000A=]Check pushing it over to:[=0x000A=][=0x0009=]if the noun is not the box, say [=0x0022=]That[=0x0027=]s not something you can push.[=0x0022=] instead;[=0x000A=][=0x0009=]if the player is on the bed, say [=0x0022=]You can[=0x0027=]t reach from here.[=0x0022=] instead;[=0x000A=][=0x0009=]if the player is on the noun, say [=0x0022=]Not while you are standing on [the noun].[=0x0022=] instead;[=0x000A=][=0x0009=]if the new position is nowhere at all, say [=0x0022=]You can only push [the noun] to the window, the bed or the shelf.[=0x0022=] instead;[=0x000A=][=0x0009=]if the new position is the old position, say [=0x0022=]The [noun] is already [new position].[=0x0022=] instead.[=0x000A=]Carry out pushing it over to:[=0x000A=][=0x0009=]now the current box position is the new position.[=0x000A=]Report pushing it over to:[=0x000A=][=0x0009=]say [=0x0022=]With some effort, you shove [the noun] from [old position] to [new position].[=0x0022=][=0x000A=][=0x000A=][Everything which remains simply provides a couple of puzzles to test this arrangement.][=0x000A=][=0x000A=]Euclid[=0x0027=]s Elements is on the shelf. Understand [=0x0022=]euclid[=0x0022=] or [=0x0022=]book[=0x0022=] as the Elements.[=0x000A=]Instead of taking something (called the item) which is on the shelf:[=0x000A=][=0x0009=]if the player is on the box and the current box position is under the shelf, continue the action;[=0x000A=][=0x0009=]say [=0x0022=]You cannot reach [the item], which is up on the shelf.[=0x0022=][=0x000A=][=0x000A=]Instead of examining the window:[=0x000A=][=0x0009=]say [=0x0022=]This window opens rather unpromisingly onto the chapel wall opposite, so even granted the moonlight it is dark in here. Still, surely there[=0x0027=]s a poem here somewhere?[=0x0022=][=0x000A=][=0x000A=]Instead of examining the window when the player is on the bed:[=0x000A=][=0x0009=]say [=0x0022=]Just a blank patch of chapel wall.[=0x0022=][=0x000A=][=0x000A=]Instead of examining the window when the player is on the box:[=0x000A=][=0x0009=]if the current box position is near the bed:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Tantalisingly, you are not quite able to spy the statue.[=0x0022=];[=0x000A=][=0x0009=]otherwise if the current box position is under the shelf:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]All you can see is the antechapel wall, and the dull silver gleam of the pealing organ.[=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]At last! You can just, standing on tiptoes on the box right up at the window, make out the top of the statue! Of such epiphanies are Poesy born. Let[=0x0027=]s see now... oh yes...[paragraph break]And from my pillow, looking forth by light[line break]Of moon or favouring stars, I could behold[line break]The antechapel where the statue stood[line break]Of Newton with his prism and silent face,[line break]The marble index of a mind for ever[line break]Voyaging through strange seas of Thought, alone.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]end the story finally.[=0x000A=][=0x000A=]Test me with [=0x0022=]get on bed / x window / get off / x window /get elements / get on box / x window / get elements / push box to shelf / get off / push box to shelf / get on box / get elements / x window / get off / push box to window / get on box / x window[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Further Reasons Why All Poets Are Liars&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3372_287" -->
<a id="c3372_287"></a><blockquote class="code"><p class="quoted">
Nook Obscure is a room. &quot;Above the College kitchens, which make a humming sound, less tuneable than bees, but hardly less industrious, with shrill notes of sharp command and scolding intermixed: and below Trinity's loquacious clock, who never lets the quarters, night or day, slip by him unproclaimed, and tells the hours twice over with a male and female voice. In short, the kind of rubbish room they give to a northern villager. But you get a bed and a high shelf all of your own. And you long to find some Romantic way to look out of the window.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3373_287" -->
<a id="c3373_287"></a><blockquote class="code"><p class="quoted">
The window, the shelf and the bed are scenery in the Nook Obscure. The shelf and the bed are supporters. The bed is enterable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3374_287" -->
<a id="c3374_287"></a><blockquote class="code"><p class="quoted">
Internal position is a kind of value. The internal positions are nowhere at all, over by the window, under the shelf and near the bed.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3375_287" -->
<a id="c3375_287"></a><blockquote class="code"><p class="quoted">
The box is an enterable supporter in Nook Obscure. The current box position is an internal position that varies. The current box position is near the bed. &quot;Your packing case, stamped W. WORDSWORTH (KENDAL), is [current box position].&quot; Instead of taking the box, say &quot;It is filled with your peerless rock collection and too heavy to lift, but could be pushed.&quot; Instead of opening the box, say &quot;It is securely nailed shut.&quot;
</p></blockquote>
<!-- END CODE -->
<p>We create an action, &quot;pushing it over to&quot;, for pushing a box around on the floor of a single location. (Calling this &quot;pushing it over to&quot; prevents clashes with the existing &quot;pushing it to&quot; action, which is for pushing things from one room to another.) Almost half of the text which defines the action is concerned with the two action variables, but they make the implementation of everything else so much easier that we end up writing less than if we hadn't used them.</p>
<!-- START CODE "c3376_287" -->
<a id="c3376_287"></a><blockquote class="code"><p class="quoted">
Understand &quot;push [box]&quot; as a mistake (&quot;You can push the box to the window, the bed or the shelf.&quot;).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3377_287" -->
<a id="c3377_287"></a><blockquote class="code"><p class="quoted">
Understand &quot;push [something] to [something]&quot; as pushing it over to. Pushing it over to is an action applying to two things.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3378_287" -->
<a id="c3378_287"></a><blockquote class="code"><p class="quoted">
The pushing it over to action has an internal position called the old position.
<br />The pushing it over to action has an internal position called the new position.
<br />Setting action variables for pushing something over to something:
<br />&#160;&#160;&#160;&#160;now the old position is the current box position;
<br />&#160;&#160;&#160;&#160;now the new position is nowhere at all;
<br />&#160;&#160;&#160;&#160;if the second noun is the window, now the new position is over by the window;
<br />&#160;&#160;&#160;&#160;if the second noun is the bed, now the new position is near the bed;
<br />&#160;&#160;&#160;&#160;if the second noun is the shelf, now the new position is under the shelf.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3379_287" -->
<a id="c3379_287"></a><blockquote class="code"><p class="quoted">
Check pushing it over to:
<br />&#160;&#160;&#160;&#160;if the noun is not the box, say &quot;That's not something you can push.&quot; instead;
<br />&#160;&#160;&#160;&#160;if the player is on the bed, say &quot;You can't reach from here.&quot; instead;
<br />&#160;&#160;&#160;&#160;if the player is on the noun, say &quot;Not while you are standing on [the noun].&quot; instead;
<br />&#160;&#160;&#160;&#160;if the new position is nowhere at all, say &quot;You can only push [the noun] to the window, the bed or the shelf.&quot; instead;
<br />&#160;&#160;&#160;&#160;if the new position is the old position, say &quot;The [noun] is already [new position].&quot; instead.
<br />Carry out pushing it over to:
<br />&#160;&#160;&#160;&#160;now the current box position is the new position.
<br />Report pushing it over to:
<br />&#160;&#160;&#160;&#160;say &quot;With some effort, you shove [the noun] from [old position] to [new position].&quot;
</p></blockquote>
<!-- END CODE -->
<p>Everything which remains simply provides a couple of puzzles to test this arrangement.</p>
<!-- START CODE "c3380_287" -->
<a id="c3380_287"></a><blockquote class="code"><p class="quoted">
Euclid's Elements is on the shelf. Understand &quot;euclid&quot; or &quot;book&quot; as the Elements.
<br />Instead of taking something (called the item) which is on the shelf:
<br />&#160;&#160;&#160;&#160;if the player is on the box and the current box position is under the shelf, continue the action;
<br />&#160;&#160;&#160;&#160;say &quot;You cannot reach [the item], which is up on the shelf.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3381_287" -->
<a id="c3381_287"></a><blockquote class="code"><p class="quoted">
Instead of examining the window:
<br />&#160;&#160;&#160;&#160;say &quot;This window opens rather unpromisingly onto the chapel wall opposite, so even granted the moonlight it is dark in here. Still, surely there's a poem here somewhere?&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3382_287" -->
<a id="c3382_287"></a><blockquote class="code"><p class="quoted">
Instead of examining the window when the player is on the bed:
<br />&#160;&#160;&#160;&#160;say &quot;Just a blank patch of chapel wall.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3383_287" -->
<a id="c3383_287"></a><blockquote class="code"><p class="quoted">
Instead of examining the window when the player is on the box:
<br />&#160;&#160;&#160;&#160;if the current box position is near the bed:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Tantalisingly, you are not quite able to spy the statue.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise if the current box position is under the shelf:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;All you can see is the antechapel wall, and the dull silver gleam of the pealing organ.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;At last! You can just, standing on tiptoes on the box right up at the window, make out the top of the statue! Of such epiphanies are Poesy born. Let's see now... oh yes...[paragraph break]And from my pillow, looking forth by light[line break]Of moon or favouring stars, I could behold[line break]The antechapel where the statue stood[line break]Of Newton with his prism and silent face,[line break]The marble index of a mind for ever[line break]Voyaging through strange seas of Thought, alone.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3384_287" -->
<a id="c3384_287"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get on bed / x window / get off / x window /get elements / get on box / x window / get elements / push box to shelf / get off / push box to shelf / get on box / get elements / x window / get off / push box to window / get on box / x window&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "200: Removal" "e409" -->
<a id="e409"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example409'); return false;"><b>200</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example409'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Removal</span></b></a><br />TAKE expanded to give responses such as "You take the book from the shelf." or "You pick up the toy from the ground."</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc36.html#e409"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example409" style="display: none;">
<p>Suppose that we want to change the reporting of &quot;take&quot; so that the player is always told something like &quot;You take the book from the shelf.&quot; or &quot;You pick up the toy from the ground.&quot; In order to generate these reports, we will need to know where the object started, even though by the time we are printing the output, the object will have moved.</p>
<!-- START CODE "c3385_409" -->
<a id="c3385_409"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Removal[=0x0022=][=0x000A=][=0x000A=]The Pharmacy is a room. A desk and a trash can are in the Pharmacy. The pill-counter, a prescription, and a computer are on the desk. The computer is fixed in place. The pill-counter contains some Vicodin. The trash can contains an empty box.[=0x000A=][=0x000A=]The taking action has an object called previous locale (matched as [=0x0022=]from[=0x0022=]).[=0x000A=][=0x000A=][The previous locale could in theory be either a thing or a room, so we make it [=0x0022=]an object[=0x0022=] -- that is, the most generic possible kind, to which both things and rooms belong. Now we record what the previous locale is at the beginning of each taking action:][=0x000A=][=0x000A=]Setting action variables for taking:[=0x000A=][=0x0009=]now previous locale is the holder of the noun.[=0x000A=][=0x000A=]Report taking something from the location:[=0x000A=][=0x0009=]say [=0x0022=]You pick up [the noun] from the ground.[=0x0022=] instead.[=0x000A=][=0x000A=]Report taking something:[=0x000A=][=0x0009=]say [=0x0022=]You take [the noun] from [the previous locale].[=0x0022=] instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]get all[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Removal&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3386_409" -->
<a id="c3386_409"></a><blockquote class="code"><p class="quoted">
The Pharmacy is a room. A desk and a trash can are in the Pharmacy. The pill-counter, a prescription, and a computer are on the desk. The computer is fixed in place. The pill-counter contains some Vicodin. The trash can contains an empty box.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3387_409" -->
<a id="c3387_409"></a><blockquote class="code"><p class="quoted">
The taking action has an object called previous locale (matched as &quot;from&quot;).
</p></blockquote>
<!-- END CODE -->
<p>The previous locale could in theory be either a thing or a room, so we make it &quot;an object&quot; -- that is, the most generic possible kind, to which both things and rooms belong. Now we record what the previous locale is at the beginning of each taking action:</p>
<!-- START CODE "c3388_409" -->
<a id="c3388_409"></a><blockquote class="code"><p class="quoted">
Setting action variables for taking:
<br />&#160;&#160;&#160;&#160;now previous locale is the holder of the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3389_409" -->
<a id="c3389_409"></a><blockquote class="code"><p class="quoted">
Report taking something from the location:
<br />&#160;&#160;&#160;&#160;say &quot;You pick up [the noun] from the ground.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3390_409" -->
<a id="c3390_409"></a><blockquote class="code"><p class="quoted">
Report taking something:
<br />&#160;&#160;&#160;&#160;say &quot;You take [the noun] from [the previous locale].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3391_409" -->
<a id="c3391_409"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get all&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "201: Puff of Orange Smoke" "e434" -->
<a id="e434"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example434'); return false;"><b>201</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example434'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Puff of Orange Smoke</span></b></a><br />A system in which every character has a body, which is left behind when the person dies; attempts to do something to the body are redirected to the person while the person is alive.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc51.html#e434"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example434" style="display: none;">
<p>Suppose we want to let the player kill characters, leaving behind corpses.</p>
<!-- START CODE "c3392_434" -->
<a id="c3392_434"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Puff of Orange Smoke[=0x0022=][=0x000A=][=0x000A=]Paraguay is a room. Bolivia is north of Paraguay. Lydia is a woman in Paraguay. [=0x0022=]Lydia is, as usual, here.[=0x0022=] The description of Lydia is [=0x0022=]Long, long legs and a sarcastic attitude.[=0x0022=] Instead of touching Lydia: say [=0x0022=][=0x0027=]Watch it, sailor,[=0x0027=] she snaps.[=0x0022=][=0x000A=][=0x000A=]A body is a kind of thing. A body is a part of every person. Instead of touching a body: say [=0x0022=][The noun] is grotesquely inert.[=0x0022=][=0x000A=][=0x000A=]The description of Lydia[=0x0027=]s body is [=0x0022=]Long, long legs and no attitude at all.[=0x0022=] The initial appearance of Lydia[=0x0027=]s body is [=0x0022=]Lydia[=0x0027=]s corpse is sprawled at your feet.[=0x0022=][=0x000A=][=0x000A=][Using our [=0x0022=]part of every person...[=0x0022=] line, we[=0x0027=]ve conveniently assigned one body per person. Since we[=0x0027=]re going to separate people from their bodies when the bodies die, though, we also want a more permanent relation that will help us keep track of which bodies used to belong to which people:][=0x000A=][=0x000A=]Spirit-possession relates one person to one body. The verb to be owner of means the spirit-possession relation.[=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]repeat with victim running through people:[=0x000A=][=0x0009=][=0x0009=]let the corpse be a random body which is part of the victim;[=0x000A=][=0x0009=][=0x0009=]now the victim is owner of the corpse.[=0x000A=][=0x000A=][When Lydia is alive, we want [=0x003E=]TOUCH LYDIA[=0x0027=]S BODY to mean the same thing as [=0x003E=]TOUCH LYDIA, so we use the setting action variables rules as a convenient point at which to reassign the action:][=0x000A=][=0x000A=]Setting action variables when the noun is a body which is part of a person (called owner):[=0x000A=][=0x0009=]now the noun is the owner.[=0x000A=][=0x000A=]Setting action variables when the second noun is a body which is part of a person (called owner):[=0x000A=][=0x0009=]now the second noun is the owner.[=0x000A=][=0x000A=][This doesn[=0x0027=]t change Inform[=0x0027=]s idea about what action is being performed; just about the object it[=0x0027=]s being performed on. The rest of the action will now proceed as if the player had typed [=0x003E=]TOUCH LYDIA.][=0x000A=][=0x000A=][Along similar lines, once Lydia is dead, we want [=0x003E=]MOVE LYDIA to mean [=0x003E=]MOVE LYDIA[=0x0027=]S BODY if the body is in view:][=0x000A=][=0x000A=]Setting action variables when the noun is a dead person and the noun is owner of a visible body (called the mortal remains):[=0x000A=][=0x0009=]now the noun is the mortal remains.[=0x000A=][=0x000A=][The trick is, though, that [=0x003E=]MOVE LYDIA will only be understood if there is something called Lydia that the player can see and refer to, even after she[=0x0027=]s dead. There are various ways to do this, but the least painful here will be to make the deceased Lydia permanently visible, by putting her in an always-accessible backdrop. The backdrop itself will never be mentioned in the game, and we should make its name something that the player is unlikely to type casually; we don[=0x0027=]t want the player to interact with it directly. So:][=0x000A=][=0x000A=]The worldview is a privately-named backdrop. It is everywhere. The spirit-world is a privately-named transparent closed unopenable container. It is part of the worldview.[=0x000A=][=0x000A=]Definition: a person is dead if he is in the spirit-world.[=0x000A=][=0x000A=][It[=0x0027=]s also possible that the player will type something like [=0x003E=]X LYDIA when Lydia[=0x0027=]s corpse is not in view, so we should have an appropriate answer to that as well:][=0x000A=][=0x000A=]Before doing something to a dead person:[=0x000A=][=0x0009=]say [=0x0022=][The noun] is dead; or had you blocked that out?[=0x0022=] instead.[=0x000A=][=0x000A=][Because the before rules happen after the setting action variables rules, this will only ever happen if the corpse is not visible.][=0x000A=][=0x000A=][Now we define the attack itself, which should discard the body, move the spirit to its eternal resting place, and describe the event to the player:][=0x000A=][=0x000A=]Instead of attacking someone:[=0x000A=][=0x0009=]let the corpse be a random body which is part of the noun;[=0x000A=][=0x0009=]move the corpse to the location;[=0x000A=][=0x0009=]move the noun to the spirit-world;[=0x000A=][=0x0009=]say [=0x0022=]With a single blow, you rid the world of [the noun].[=0x0022=][=0x000A=][=0x000A=][And finally a trick borrowed from the chapter on understanding, so that we can refer to [=0x0022=]Lydia[=0x0027=]s body[=0x0022=] while Lydia is alive, but [=0x0022=]Lydia[=0x0027=]s corpse[=0x0022=] only after Lydia has died:][=0x000A=][=0x000A=]Understand [=0x0022=]corpse[=0x0022=] as a body when the item described is not part of a person.[=0x000A=][=0x000A=]Test me with [=0x0022=]x body / x lydia[=0x0027=]s body / touch lydia[=0x0027=]s body / x corpse / kill lydia / look / x lydia[=0x0027=]s body / x lydia[=0x0027=]s corpse / x corpse / x lydia / touch lydia / lydia, hello / n / x lydia / touch lydia / lydia, hello[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Puff of Orange Smoke&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3393_434" -->
<a id="c3393_434"></a><blockquote class="code"><p class="quoted">
Paraguay is a room. Bolivia is north of Paraguay. Lydia is a woman in Paraguay. &quot;Lydia is, as usual, here.&quot; The description of Lydia is &quot;Long, long legs and a sarcastic attitude.&quot; Instead of touching Lydia: say &quot;'Watch it, sailor,' she snaps.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3394_434" -->
<a id="c3394_434"></a><blockquote class="code"><p class="quoted">
A body is a kind of thing. A body is a part of every person. Instead of touching a body: say &quot;[The noun] is grotesquely inert.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3395_434" -->
<a id="c3395_434"></a><blockquote class="code"><p class="quoted">
The description of Lydia's body is &quot;Long, long legs and no attitude at all.&quot; The initial appearance of Lydia's body is &quot;Lydia's corpse is sprawled at your feet.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Using our &quot;part of every person...&quot; line, we've conveniently assigned one body per person. Since we're going to separate people from their bodies when the bodies die, though, we also want a more permanent relation that will help us keep track of which bodies used to belong to which people:</p>
<!-- START CODE "c3396_434" -->
<a id="c3396_434"></a><blockquote class="code"><p class="quoted">
Spirit-possession relates one person to one body. The verb to be owner of means the spirit-possession relation.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3397_434" -->
<a id="c3397_434"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;repeat with victim running through people:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the corpse be a random body which is part of the victim;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the victim is owner of the corpse.
</p></blockquote>
<!-- END CODE -->
<p>When Lydia is alive, we want &gt;TOUCH LYDIA'S BODY to mean the same thing as &gt;TOUCH LYDIA, so we use the setting action variables rules as a convenient point at which to reassign the action:</p>
<!-- START CODE "c3398_434" -->
<a id="c3398_434"></a><blockquote class="code"><p class="quoted">
Setting action variables when the noun is a body which is part of a person (called owner):
<br />&#160;&#160;&#160;&#160;now the noun is the owner.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3399_434" -->
<a id="c3399_434"></a><blockquote class="code"><p class="quoted">
Setting action variables when the second noun is a body which is part of a person (called owner):
<br />&#160;&#160;&#160;&#160;now the second noun is the owner.
</p></blockquote>
<!-- END CODE -->
<p>This doesn't change Inform's idea about what action is being performed; just about the object it's being performed on. The rest of the action will now proceed as if the player had typed &gt;TOUCH LYDIA.</p>
<p>Along similar lines, once Lydia is dead, we want &gt;MOVE LYDIA to mean &gt;MOVE LYDIA'S BODY if the body is in view:</p>
<!-- START CODE "c3400_434" -->
<a id="c3400_434"></a><blockquote class="code"><p class="quoted">
Setting action variables when the noun is a dead person and the noun is owner of a visible body (called the mortal remains):
<br />&#160;&#160;&#160;&#160;now the noun is the mortal remains.
</p></blockquote>
<!-- END CODE -->
<p>The trick is, though, that &gt;MOVE LYDIA will only be understood if there is something called Lydia that the player can see and refer to, even after she's dead. There are various ways to do this, but the least painful here will be to make the deceased Lydia permanently visible, by putting her in an always-accessible backdrop. The backdrop itself will never be mentioned in the game, and we should make its name something that the player is unlikely to type casually; we don't want the player to interact with it directly. So:</p>
<!-- START CODE "c3401_434" -->
<a id="c3401_434"></a><blockquote class="code"><p class="quoted">
The worldview is a privately-named backdrop. It is everywhere. The spirit-world is a privately-named transparent closed unopenable container. It is part of the worldview.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3402_434" -->
<a id="c3402_434"></a><blockquote class="code"><p class="quoted">
Definition: a person is dead if he is in the spirit-world.
</p></blockquote>
<!-- END CODE -->
<p>It's also possible that the player will type something like &gt;X LYDIA when Lydia's corpse is not in view, so we should have an appropriate answer to that as well:</p>
<!-- START CODE "c3403_434" -->
<a id="c3403_434"></a><blockquote class="code"><p class="quoted">
Before doing something to a dead person:
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] is dead; or had you blocked that out?&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>Because the before rules happen after the setting action variables rules, this will only ever happen if the corpse is not visible.</p>
<p>Now we define the attack itself, which should discard the body, move the spirit to its eternal resting place, and describe the event to the player:</p>
<!-- START CODE "c3404_434" -->
<a id="c3404_434"></a><blockquote class="code"><p class="quoted">
Instead of attacking someone:
<br />&#160;&#160;&#160;&#160;let the corpse be a random body which is part of the noun;
<br />&#160;&#160;&#160;&#160;move the corpse to the location;
<br />&#160;&#160;&#160;&#160;move the noun to the spirit-world;
<br />&#160;&#160;&#160;&#160;say &quot;With a single blow, you rid the world of [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>And finally a trick borrowed from the chapter on understanding, so that we can refer to &quot;Lydia's body&quot; while Lydia is alive, but &quot;Lydia's corpse&quot; only after Lydia has died:</p>
<!-- START CODE "c3405_434" -->
<a id="c3405_434"></a><blockquote class="code"><p class="quoted">
Understand &quot;corpse&quot; as a body when the item described is not part of a person.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3406_434" -->
<a id="c3406_434"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x body / x lydia's body / touch lydia's body / x corpse / kill lydia / look / x lydia's body / x lydia's corpse / x corpse / x lydia / touch lydia / lydia, hello / n / x lydia / touch lydia / lydia, hello&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "202: Croft" "e381" -->
<a id="e381"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example381'); return false;"><b>202</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example381'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Croft</span></b></a><br />Adding special reporting and handling for objects dropped when the player is on a supporter, and special entering rules for moving from one supporter to another.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc36.html#e381"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example381" style="display: none;">
<p>Suppose that we have a design in which the player spends lots of time on enterable supporters, and in which we want to report certain actions -- dropping things onto those supporters, or leaping from one to another -- in a new way. We might begin by adding some action variables to help us keep track of the situation:</p>
<!-- START CODE "c3407_381" -->
<a id="c3407_381"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Croft[=0x0022=][=0x000A=][=0x000A=]The dropping action has an object called the container dropped into (matched as [=0x0022=]into[=0x0022=]).[=0x000A=][=0x000A=]The dropping action has an object called the supporter dropped onto (matched as [=0x0022=]onto[=0x0022=]).[=0x000A=][=0x000A=]Rule for setting action variables for dropping:[=0x000A=][=0x0009=]if the actor is in a container (called C), now the container dropped into is C;[=0x000A=][=0x0009=]if the actor is on a supporter (called C), now the supporter dropped onto is C.[=0x000A=][=0x000A=]Report dropping a heavy thing onto a metallic thing:[=0x000A=][=0x0009=]say [=0x0022=]You drop [the noun], and [the supporter dropped onto] clangs protestingly.[=0x0022=] instead.[=0x000A=][=0x000A=]Report someone dropping a heavy thing onto a metallic thing:[=0x000A=][=0x0009=]say [=0x0022=][The actor] drops [the noun] onto [the supporter dropped onto], which clangs protestingly.[=0x0022=] instead.[=0x000A=][=0x000A=]A thing can be heavy or light. A thing can be metallic or ordinary. A thing is usually ordinary. A thing is usually light.[=0x000A=][=0x000A=]The Ancient Cambodian Temple is a room. [=0x0022=]A vast space built for ancient and forgotten rituals. The stone floor crawls with vermin. Well above the floor, and separated by some feet, are twin platforms built into the wall: the one carved of jointed wood, the other of sheets of graven bronze.[=0x0022=][=0x000A=][=0x000A=]A platform is a kind of supporter. A platform is always enterable. A platform is usually scenery.[=0x000A=][=0x000A=]The bronze platform is a metallic platform in the Temple. Lara is a woman. She is on the bronze platform. She wears safari pants and a tank top. She carries a gun and a map. The gun is heavy.[=0x000A=][=0x000A=]The wood platform is an ordinary platform in the Temple. The player is on the wood platform. The player carries a rope, an Ancient Cambodian/English Phrasebook, a pickaxe, and a precious idol. The idol and the pickaxe are heavy.[=0x000A=][=0x000A=]Persuasion rule: persuasion succeeds.[=0x000A=][=0x000A=]The entering action has an object called the place left (matched as [=0x0022=]from[=0x0022=]).[=0x000A=][=0x0009=]Check entering a platform from a platform:[=0x000A=][=0x0009=][=0x0009=]if actor is the player, say [=0x0022=]You leap into midair to cross the distance...[=0x0022=];[=0x000A=][=0x0009=]otherwise say [=0x0022=][The actor] leaps gracefully across the distance...[=0x0022=];[=0x000A=][=0x0009=]move the actor to the holder of the noun, without printing a room description.[=0x000A=][=0x000A=][Because this rule occurs before the [=0x0022=]implicitly pass through other barriers rule[=0x0022=], that rule will not occur when we move from platform to platform; we[=0x0027=]ll use our own custom rule instead.][=0x000A=][=0x000A=]Rule for setting action variables for entering:[=0x000A=][=0x0009=]now the place left is the holder of the actor.[=0x000A=][=0x000A=]Report entering a platform from a platform:[=0x000A=][=0x0009=]say [=0x0022=]You land in a cat-like crouch on [the noun].[=0x0022=] instead.[=0x000A=][=0x000A=]Report Lara entering a platform from a platform:[=0x000A=][=0x0009=]say [=0x0022=]Lara lands soundlessly on [the noun][if the noun supports the player] beside you[end if].[=0x0022=] instead.[=0x000A=][=0x000A=]Report entering a platform from the location:[=0x000A=][=0x0009=]say [=0x0022=]You jump, catch the edge of [the noun] in your hands, and -- exerting considerable upper-body strength -- pull yourself up onto it.[=0x0022=] instead.[=0x000A=][=0x000A=]Report Lara entering a platform from a location:[=0x000A=][=0x0009=]say [=0x0022=]Lara jumps, catches the edge of [the noun], and is standing upright on it, all in less time than it takes to tell.[=0x0022=][=0x000A=][=0x000A=]Instead of examining a person who is not the player:[=0x000A=][=0x0009=]say [=0x0022=][The noun] carries [list of things carried by the noun] and wears [list of things worn by the noun].[=0x0022=][=0x000A=][=0x000A=]Instead of climbing a platform, try entering the noun.[=0x000A=][=0x000A=]Test me with [=0x0022=]Lara, drop map / lara, drop gun / drop idol / enter bronze platform / drop pickaxe / get off / climb wood[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a>  &quot;Croft&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3408_381" -->
<a id="c3408_381"></a><blockquote class="code"><p class="quoted">
The dropping action has an object called the container dropped into (matched as &quot;into&quot;).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3409_381" -->
<a id="c3409_381"></a><blockquote class="code"><p class="quoted">
The dropping action has an object called the supporter dropped onto (matched as &quot;onto&quot;).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3410_381" -->
<a id="c3410_381"></a><blockquote class="code"><p class="quoted">
Rule for setting action variables for dropping:
<br />&#160;&#160;&#160;&#160;if the actor is in a container (called C), now the container dropped into is C;
<br />&#160;&#160;&#160;&#160;if the actor is on a supporter (called C), now the supporter dropped onto is C.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3411_381" -->
<a id="c3411_381"></a><blockquote class="code"><p class="quoted">
Report dropping a heavy thing onto a metallic thing:
<br />&#160;&#160;&#160;&#160;say &quot;You drop [the noun], and [the supporter dropped onto] clangs protestingly.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3412_381" -->
<a id="c3412_381"></a><blockquote class="code"><p class="quoted">
Report someone dropping a heavy thing onto a metallic thing:
<br />&#160;&#160;&#160;&#160;say &quot;[The actor] drops [the noun] onto [the supporter dropped onto], which clangs protestingly.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3413_381" -->
<a id="c3413_381"></a><blockquote class="code"><p class="quoted">
A thing can be heavy or light. A thing can be metallic or ordinary. A thing is usually ordinary. A thing is usually light.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3414_381" -->
<a id="c3414_381"></a><blockquote class="code"><p class="quoted">
The Ancient Cambodian Temple is a room. &quot;A vast space built for ancient and forgotten rituals. The stone floor crawls with vermin. Well above the floor, and separated by some feet, are twin platforms built into the wall: the one carved of jointed wood, the other of sheets of graven bronze.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3415_381" -->
<a id="c3415_381"></a><blockquote class="code"><p class="quoted">
A platform is a kind of supporter. A platform is always enterable. A platform is usually scenery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3416_381" -->
<a id="c3416_381"></a><blockquote class="code"><p class="quoted">
The bronze platform is a metallic platform in the Temple. Lara is a woman. She is on the bronze platform. She wears safari pants and a tank top. She carries a gun and a map. The gun is heavy.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3417_381" -->
<a id="c3417_381"></a><blockquote class="code"><p class="quoted">
The wood platform is an ordinary platform in the Temple. The player is on the wood platform. The player carries a rope, an Ancient Cambodian/English Phrasebook, a pickaxe, and a precious idol. The idol and the pickaxe are heavy.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3418_381" -->
<a id="c3418_381"></a><blockquote class="code"><p class="quoted">
Persuasion rule: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3419_381" -->
<a id="c3419_381"></a><blockquote class="code"><p class="quoted">
The entering action has an object called the place left (matched as &quot;from&quot;).
<br />&#160;&#160;&#160;&#160;Check entering a platform from a platform:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if actor is the player, say &quot;You leap into midair to cross the distance...&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;[The actor] leaps gracefully across the distance...&quot;;
<br />&#160;&#160;&#160;&#160;move the actor to the holder of the noun, without printing a room description.
</p></blockquote>
<!-- END CODE -->
<p>Because this rule occurs before the &quot;implicitly pass through other barriers rule&quot;, that rule will not occur when we move from platform to platform; we'll use our own custom rule instead.</p>
<!-- START CODE "c3420_381" -->
<a id="c3420_381"></a><blockquote class="code"><p class="quoted">
Rule for setting action variables for entering:
<br />&#160;&#160;&#160;&#160;now the place left is the holder of the actor.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3421_381" -->
<a id="c3421_381"></a><blockquote class="code"><p class="quoted">
Report entering a platform from a platform:
<br />&#160;&#160;&#160;&#160;say &quot;You land in a cat-like crouch on [the noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3422_381" -->
<a id="c3422_381"></a><blockquote class="code"><p class="quoted">
Report Lara entering a platform from a platform:
<br />&#160;&#160;&#160;&#160;say &quot;Lara lands soundlessly on [the noun][if the noun supports the player] beside you[end if].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3423_381" -->
<a id="c3423_381"></a><blockquote class="code"><p class="quoted">
Report entering a platform from the location:
<br />&#160;&#160;&#160;&#160;say &quot;You jump, catch the edge of [the noun] in your hands, and -- exerting considerable upper-body strength -- pull yourself up onto it.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3424_381" -->
<a id="c3424_381"></a><blockquote class="code"><p class="quoted">
Report Lara entering a platform from a location:
<br />&#160;&#160;&#160;&#160;say &quot;Lara jumps, catches the edge of [the noun], and is standing upright on it, all in less time than it takes to tell.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3425_381" -->
<a id="c3425_381"></a><blockquote class="code"><p class="quoted">
Instead of examining a person who is not the player:
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] carries [list of things carried by the noun] and wears [list of things worn by the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3426_381" -->
<a id="c3426_381"></a><blockquote class="code"><p class="quoted">
Instead of climbing a platform, try entering the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3427_381" -->
<a id="c3427_381"></a><blockquote class="code"><p class="quoted">
Test me with &quot;Lara, drop map / lara, drop gun / drop idol / enter bronze platform / drop pickaxe / get off / climb wood&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc185.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc187.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
