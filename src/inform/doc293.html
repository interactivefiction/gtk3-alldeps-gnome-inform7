<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>18.7. Beginning and ending activities manually</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Beginning and ending activities manually" -->
<!-- SEARCH SECTION "18.7" -->
<!-- SEARCH SORT "000-018-007-000" -->
<!-- START IGNORE 292 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc292.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 18: Activities</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc294.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง18.7. Beginning and ending activities manually</p>
<p>If we have declared a new activity, like &quot;analysing&quot;, the normal way to make it happen would be to write</p>
<!-- START CODE "c6379" -->
<a id="c6379"></a><blockquote class="code"><p class="quoted">
carry out the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->
<p>which goes through the whole machinery of rules - before, for, after - and then resumes, the activity having started, taken place and come to an end.</p>
<p>But there are times when it is not convenient to write a suitable &quot;for ...&quot; rule, or where we need more control, and do not wish to hand the whole business over to a single phrase. For such times we are allowed to write:</p>
<!-- START PHRASE "defn250" -->
<div class="definition"><a id="defn250"></a><p class="defnprototype"><b>begin the </b>(activity)<b> activity</b></p>
<!-- END PHRASE -->
<!-- definition of ph_beginactivity -->

<p>This phrase causes the named activity to become active, and runs its &quot;before&quot; rulebook. The activity must be one which applies to nothing. Example:</p>
<!-- START CODE "c6380" -->
<a id="c6380"></a><blockquote class="code"><p class="quoted">
begin the assaying activity;
</p></blockquote>
<!-- END CODE -->
<p>In all cases a matching &quot;end the ... activity&quot; or else &quot;abandon the ... activity&quot; phrase must be reached.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn251" -->
<div class="definition"><a id="defn251"></a><p class="defnprototype"><b>begin the </b>(activity on values)<b> activity with </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_beginactivitywith -->

<p>This phrase causes the named activity to become active, and runs its &quot;before&quot; rulebook. The activity must be one which applies to a value of a matching kind. Example:</p>
<!-- START CODE "c6381" -->
<a id="c6381"></a><blockquote class="code"><p class="quoted">
begin the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->
<p>In all cases a matching &quot;end the ... activity with ...&quot; or else &quot;abandon the ... activity with...&quot; phrase must be reached.</p>

<!-- end definition -->
</div>

<p>And when we are done:</p>
<!-- START PHRASE "defn252" -->
<div class="definition"><a id="defn252"></a><p class="defnprototype"><b>end the </b>(activity)<b> activity</b></p>
<!-- END PHRASE -->
<!-- definition of ph_endactivity -->

<p>This phrase runs the &quot;after&quot; rulebook of the activity and then causes it to become inactive. The activity must be one which applies to nothing. Example:</p>
<!-- START CODE "c6382" -->
<a id="c6382"></a><blockquote class="code"><p class="quoted">
end the assaying activity;
</p></blockquote>
<!-- END CODE -->
<p>This must only happen to match an earlier &quot;begin the ... activity&quot; phrase.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn253" -->
<div class="definition"><a id="defn253"></a><p class="defnprototype"><b>end the </b>(activity on values)<b> activity with </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_endactivitywith -->

<p>This phrase runs the &quot;after&quot; rulebook of the activity and then causes it to become inactive. The activity must be one which applies to a value of a matching kind. Example:</p>
<!-- START CODE "c6383" -->
<a id="c6383"></a><blockquote class="code"><p class="quoted">
end the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->
<p>This must only happen to match an earlier &quot;begin the ... activity with...&quot; phrase.</p>

<!-- end definition -->
</div>

<p>So the usual structure is like so:</p>
<!-- START CODE "c6384" -->
<a id="c6384"></a><blockquote class="code"><p class="quoted">
begin the analysing activity with the pitchblende;
<br />...
<br />end the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->
<p>This time the activity is ongoing throughout as many phrases as we care to write between the &quot;begin&quot; and &quot;end&quot;. The before rules are considered at the time of the &quot;begin ...&quot; phrase; the after rules at the &quot;end ...&quot;.</p>
<p>What, then, of the &quot;for&quot; rules? In the above setup, they would simply be ignored. But we can make them effectual thus</p>
<!-- START CODE "c6385" -->
<a id="c6385"></a><blockquote class="code"><p class="quoted">
begin the analysing activity with the pitchblende;
<br />...
<br />if handling the analysing activity with the pitchblende:
<br />&#160;&#160;&#160;&#160;...
<br />...
<br />end the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->
<p>We place the activity's normal behaviour inside the &quot;if&quot;; the condition, &quot;if handling...&quot;, is true only if no rule has intervened. This means that we (or other authors using our activity) can create their own for rules to substitute here. If we elsewhere write</p>
<!-- START CODE "c6386" -->
<a id="c6386"></a><blockquote class="code"><p class="quoted">
Rule for handling the analysing activity with the pitchblende when the player is not sober:
<br />&#160;&#160;&#160;&#160;say &quot;You can't seem to focus.&quot;
</p></blockquote>
<!-- END CODE -->
<p>that rule will intervene and take the place of whatever we have placed inside the condition.</p>
<!-- START PHRASE "defn254" -->
<div class="definition"><a id="defn254"></a><p class="defnprototype"><b>if handling </b>(activity)<b> activity:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_handlingactivity -->

<p>This should be used only where the given activity has been started with &quot;begin ...&quot; and will be finished with &quot;end ...&quot;. It runs the &quot;for&quot; rules for the activity, and then comes out true if none of those for rules intervened in the handling of that activity. (The activity must be one which doesn't apply to any value.)</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn255" -->
<div class="definition"><a id="defn255"></a><p class="defnprototype"><b>if handling </b>(activity on values)<b> activity with </b>(value)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_handlingactivitywith -->

<p>This should be used only where the given activity has been started with &quot;begin ...&quot; and will be finished with &quot;end ...&quot;. It runs the &quot;for&quot; rules for the activity, and then comes out true if none of those for rules intervened in the handling of that activity. (The given value must be the one it is being applied to.)</p>

<!-- end definition -->
</div>

<p>It is also legal to force an early end to an activity with:</p>
<!-- START PHRASE "defn256" -->
<div class="definition"><a id="defn256"></a><p class="defnprototype"><b>abandon the </b>(activity)<b> activity</b></p>
<!-- END PHRASE -->
<!-- definition of ph_abandonactivity -->

<p>This phrase ends an activity at once (without consulting any further rulebooks, including its &quot;after&quot; rulebook). It can only be used with an activity which has had its &quot;begin&quot; but not yet its &quot;end&quot; phrase; it is a drastic remedy best taken only if it is clear that circumstances have changed so that the activity now seems inappropriate. It must not be used during one of the rules for the activity: it can only be used between the begin and for stages, or between the for and end stages.</p>
<!-- START CODE "c6387" -->
<a id="c6387"></a><blockquote class="code"><p class="quoted">
abandon the assaying activity;
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<!-- START PHRASE "defn257" -->
<div class="definition"><a id="defn257"></a><p class="defnprototype"><b>abandon the </b>(activity on values)<b> activity with </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_abandonactivitywith -->

<p>This phrase ends an activity at once (without consulting any further rulebooks, including its &quot;after&quot; rulebook). It can only be used with an activity which has had its &quot;begin&quot; but not yet its &quot;end&quot; phrase; it is a drastic remedy best taken only if it is clear that circumstances have changed so that the activity now seems inappropriate. It must not be used during one of the rules for the activity: it can only be used between the begin and for stages, or between the for and end stages.</p>
<!-- START CODE "c6388" -->
<a id="c6388"></a><blockquote class="code"><p class="quoted">
abandon the analysing activity with the pitchblende;
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>We need to follow three golden rules: all activities must end, they must never last longer than a turn, and if activity B starts during activity A then it must also finish during activity A. We must also be careful to make sure that if an activity applies to something, then it begins and ends with the same something (the pitchblende, in the above example).</p>
<hr />
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc292.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc294.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
