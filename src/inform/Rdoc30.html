<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>6.2. Writing New Commands</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Writing New Commands" -->
<!-- SEARCH SECTION "6.2" -->
<!-- SEARCH SORT "001-006-002-000" -->
<!-- START IGNORE 29 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="Rdoc29.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 6: Commands</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="Rdoc31.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง6.2. Writing New Commands</p>
<p>Once we've considered all the design issues pertaining to a new action, we're ready to start writing the source text. First we need to give the player a way to issue the command:</p>
<!-- START CODE "c11382" -->
<a id="c11382"></a><blockquote class="code"><p class="quoted">
Understand &quot;smile&quot; as smiling.
<br />Understand &quot;fold [something]&quot; as folding.
<br />Understand &quot;shoot [something preferably held] at [something]&quot; as shooting it with.
<br />Understand &quot;wrap [something preferably held] in [something preferably held]&quot; as wrapping it in.
</p></blockquote>
<!-- END CODE -->
<p>(Note how &quot;it&quot; stands in for the first item when we have an action requiring two objects.) The things that go in square brackets are called &quot;tokens&quot;: they are blank spaces for the player to fill in with story objects. The different kinds of tokens are explained in the chapter on Understanding.</p>
<p>We can add synonyms with</p>
<!-- START CODE "c11383" -->
<a id="c11383"></a><blockquote class="code"><p class="quoted">
Understand the command &quot;grin&quot; as &quot;smile&quot;.
</p></blockquote>
<!-- END CODE -->
<p>and we can create reversed versions of commands with</p>
<!-- START CODE "c11384" -->
<a id="c11384"></a><blockquote class="code"><p class="quoted">
Understand &quot;shoot [something] with [something preferably held]&quot; as shooting it with (with nouns reversed).
</p></blockquote>
<!-- END CODE -->
<p>These variations are also covered in the Understanding chapter. If the action needs to work on things that aren't within the player's sight or reach in the normal way, we may need to use an [any thing] token (see the Understanding chapter), as in</p>
<!-- START CODE "c11385" -->
<a id="c11385"></a><blockquote class="code"><p class="quoted">
Understand &quot;contemplate [any thing]&quot; as considering.
</p></blockquote>
<!-- END CODE -->
<p>We may also need to modify reach or light levels (see Changing reachability and Changing visibility in the Advanced Actions chapter), or rely on the Deciding the scope of... activity.</p>
<p>As for guessing the player's intention when he isn't clear, we may want to consult the Does the player mean rules (to help Inform make guesses between multiple possible targets) and the activities Supplying a missing noun and Supplying a missing second noun (to help Inform guess an appropriate item when the player leaves something entirely out of his command). For instance, if the player typed SHOOT HENRY, it is the supplying a missing noun/second noun activity that would allow us to make Inform draw the obvious conclusion that he shoots Henry with the pistol in his hand. The Does the player mean rules are discussed in the chapter on Advanced Actions; the activities in the Activities chapter.</p>
<p>Next we need to define our new action, as in</p>
<!-- START CODE "c11386" -->
<a id="c11386"></a><blockquote class="code"><p class="quoted">
Smiling is an action applying to nothing.
<br />Folding is an action applying to one thing.
<br />Wrapping it in is an action applying to two carried things.
</p></blockquote>
<!-- END CODE -->
<p>In cases where we're using an &quot;[any thing]&quot; token to let the player affect objects that aren't normally visible or reachable, we'll need to define the action to apply to <span class="italic">visible objects</span>. This tells Inform that the player doesn't have to be able to touch the object for it to work. So for instance</p>
<!-- START CODE "c11387" -->
<a id="c11387"></a><blockquote class="code"><p class="quoted">
Considering is an action applying to one visible thing.
</p></blockquote>
<!-- END CODE -->
<p>For more on this topic, see Visible vs. touchable vs. carried in the Advanced Actions chapter.</p>
<p>The next step is to create rules for Inform to follow when the action happens. These can be check rules (which make sure that the conditions for the action to occur are fulfilled); carry out rules (which perform the action); and report rules (which describe the results of the action to the player). Any new action should have at least a report rule to let the player know what has happened (if anything), and a carry out rule if there are any ramifications for the world model. For instance:</p>
<!-- START CODE "c11388" -->
<a id="c11388"></a><blockquote class="code"><p class="quoted">
Carry out folding:
<br />&#160;&#160;&#160;&#160;now the noun is swan-like.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11389" -->
<a id="c11389"></a><blockquote class="code"><p class="quoted">
Report folding:
<br />&#160;&#160;&#160;&#160;say &quot;You deftly fold [the noun] into the shape of a swan.&quot;
</p></blockquote>
<!-- END CODE -->
<p>It's important to remember that report rules may be describing something whose name is plural, such as papers or shoes, and write our text so that it sounds right either way; see the chapter on Adaptive Text and Responses.</p>
<p>More about defining actions and creating carry out and report rules may be found in the chapter on Advanced Actions.</p>
<p>Meanwhile, the check rules give us a chance to provide sensible restrictions on how the command works, as in</p>
<!-- START CODE "c11390" -->
<a id="c11390"></a><blockquote class="code"><p class="quoted">
Check folding:
<br />&#160;&#160;&#160;&#160;if the noun is not a napkin:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The noun] won't bend.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11391" -->
<a id="c11391"></a><blockquote class="code"><p class="quoted">
Check shooting something with the noun:
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] is incapable of aiming at itself.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11392" -->
<a id="c11392"></a><blockquote class="code"><p class="quoted">
Check burning something which contains the player:
<br />&#160;&#160;&#160;&#160;say &quot;You're not quite desperate enough to make a funeral pyre for yourself just yet.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>The chapter on Advanced Actions explains how check rules work. In the special case where we want the player to take things automatically before using them, we may want to define the action to work only on carried objects, as in</p>
<!-- START CODE "c11393" -->
<a id="c11393"></a><blockquote class="code"><p class="quoted">
Wrapping it in is an action applying to two carried things.
</p></blockquote>
<!-- END CODE -->
<p>The activity Implicitly taking something (documented in the Activities chapter) allows us to modify what should happen during this process.</p>
<p>Lastly, a word or two about trouble-shooting. If a newly created command seems not to be working, we can discover what action Inform is really generating with the ACTIONS testing command, as in</p>
<!-- START CODE "c11394" -->
<a id="c11394"></a><blockquote class="code"><p class="quoted">
&gt;actions
<br />Actions listing on.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11395" -->
<a id="c11395"></a><blockquote class="code"><p class="quoted">
&gt;i
<br />[taking inventory]
<br />You are carrying nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11396" -->
<a id="c11396"></a><blockquote class="code"><p class="quoted">
[taking inventory - succeeded]
</p></blockquote>
<!-- END CODE -->
<p>If the desired command is not happening, we may need to review our understand lines. A common problem is that our new action conflicts with one already defined by default. In that case, we may want to check the Actions index and see whether there are already-defined actions which might conflict with it. If so, we may need to redefine a command with a line like</p>
<!-- START CODE "c11397" -->
<a id="c11397"></a><blockquote class="code"><p class="quoted">
Understand the command &quot;stand&quot; as something new.
</p></blockquote>
<!-- END CODE -->
<p>If that's not enough, we can get a comprehensive view of everything that happens during an action with RULES: this will list all the check, carry out, and report rules that Inform is using to perform the command.</p>
<p class="crossreference"><a href="Rdoc27.html" class="xreflink"><img class="asterisk" alt="*" src="inform:/doc_images/xref.png" />&#160;<i>See </i><b>Memory and Knowledge</b></a><i> for more about the any token and the concept of scope to control what the player may refer to in a command</i></p><hr />
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="Rdoc29.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="Rdoc31.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
