<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>6.15. Actions on Multiple Objects</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Actions on Multiple Objects" -->
<!-- SEARCH SECTION "6.15" -->
<!-- SEARCH SORT "001-006-015-000" -->
<!-- START IGNORE 42 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="Rdoc42.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 6: Commands</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="Rdoc44.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง6.15. Actions on Multiple Objects</p>
<p>Inform allows a handful of actions - TAKE, DROP, PUT, INSERT - to apply to more than one item at a time, so that the player can move things around easily.</p>
<p>The general principle is that multiple objects are allowed if the actions are likely to be successful but not interesting most of the time, and if they're things that the player could plausibly do all at once. For most actions, the use of ALL would seem weirdly indiscriminate: EAT ALL, say, describes very implausible behavior, and EXAMINE ALL would likely generate a screenful of text at once.</p>
<p>But this is all under our control. To create an action that uses multiples, or to allow the use of multiple objects with an already-existing action, we need to create an understand statement that uses the &quot;[things]&quot; token (note the plural). For instance:</p>
<!-- START CODE "c11938" -->
<a id="c11938"></a><blockquote class="code"><p class="quoted">
Understand &quot;give [things] to [someone]&quot; as giving it to.
</p></blockquote>
<!-- END CODE -->
<p>This would let the existing give action apply to multiple objects, in just the same way that &quot;take&quot; does. <span class="boldface">Shawn's Bad Day</span> demonstrates how we might allow EXAMINE ALL to print descriptions of every visible item.</p>
<p>Alternatively, we could generate a new action:</p>
<!-- START CODE "c11939" -->
<a id="c11939"></a><blockquote class="code"><p class="quoted">
Understand &quot;give [things] to [someone]&quot; as multiply-giving it to. Multiply-giving it to is an action applying to one carried thing and one thing.
</p></blockquote>
<!-- END CODE -->
<p>(In theory the language here should perhaps be &quot;several carried things&quot; -- but Inform is still going to process multiply-giving item by item, unless we redirect it. More about this in a moment.)</p>
<p>When handling an action that uses the &quot;[things]&quot; token, the parser makes a list of every item to which it is going to apply the action: this is called the multiple objects list. The multiple objects list can be the result of a vague request (GET ALL) or a specific one involving identical multiples (GET PENNIES, GET THREE APPLES) or a very specific one involving unique, named nouns (GET GERBIL, APPLE, AND POMEGRANATE).</p>
<p>We can manipulate what Inform includes in &quot;ALL&quot; in sentences like TAKE ALL with the &quot;deciding whether all includes...&quot; activity; for instance</p>
<!-- START CODE "c11940" -->
<a id="c11940"></a><blockquote class="code"><p class="quoted">
Rule for deciding whether all includes scenery: it does not.
</p></blockquote>
<!-- END CODE -->
<p>prevents TAKE ALL from applying to things that can't be moved anyway, avoiding lots of lines like</p>
<!-- START CODE "c11941" -->
<a id="c11941"></a><blockquote class="code"><p class="quoted">
tree: That's hardly portable.
<br />swing set: That's hardly portable.
</p></blockquote>
<!-- END CODE -->
<p>A slightly tedious technical note: the multiple objects list is not strictly a list in the standard Inform sense, because it is used so frequently in parsing that it would be cumbersome to handle it with the more flexible but less efficient structure used for lists. However, if we want to manipulate the multiple objects list as though it were an ordinary list -- that is, sort it, rotate it, truncate it, remove entries from it, etc -- we may do so by creating a list like this:</p>
<!-- START CODE "c11942" -->
<a id="c11942"></a><blockquote class="code"><p class="quoted">
let L be the multiple object list.
</p></blockquote>
<!-- END CODE -->
<p>and later after making L conform to our desires:</p>
<!-- START CODE "c11943" -->
<a id="c11943"></a><blockquote class="code"><p class="quoted">
alter the multiple object list to L.
</p></blockquote>
<!-- END CODE -->
<p>Inform next repeatedly runs the action rulebook for the action generated, using each item from the multiple object list as &quot;noun&quot; in turn (or as &quot;second noun&quot;, if that's where the [things] token appeared in the understand line). Since it is possible to alter the multiple object list before the &quot;generate action rule&quot; portion of the turn sequence consults the rulebooks, we can also affect the order in which the player's matched objects are handled; see <span class="boldface">Formicidae</span>. We should not attempt to change the multiple object list after this point, because this is likely to introduce bugs.</p>
<p>Each time Inform tries the action on a new noun, it prefixes the action-attempt with the name of the item it's currently working on. This is where we get such output as &quot;frog eyeballs:&quot; and &quot;newt toes:&quot; in long lists like</p>
<!-- START CODE "c11944" -->
<a id="c11944"></a><blockquote class="code"><p class="quoted">
frog eyeballs: Taken.
<br />newt toes: Taken.
</p></blockquote>
<!-- END CODE -->
<p>These names are generated by the &quot;announce items from multiple object lists rule&quot; in the action-handling rules; <span class="boldface">Escape from the Seraglio</span> shows how to alter them. In the context of this rule, the thing we are currently printing the name of can be called &quot;the current item from the multiple object list&quot;.</p>
<p>Suppressing names of objects entirely, while occasionally tempting, may have unintended consequences, especially if some of the attempted actions are prevented by check rules that themselves print things. It is safest to suppress the multiple object names in the case where we already know that the action will succeed wherever it is attempted (more often for observational actions like examining than for manipulative actions like taking, or where we mean to completely override default handling).</p>
<p>Given that our hypothetical &quot;multiply-giving&quot; applies to each given object in turn, it might seem to be useless to create &quot;multiply-giving&quot; as an action different from &quot;giving&quot; -- but the convenience is that manipulating the multiple object list makes it possible to group behavior artificially. The trick here is that, on the first pass of the multiply-giving rulebook, we look at the entire multiple object list, perform actions, print output, and set a flag saying that the action has been handled. The flag tells Inform not to do or print anything for any of the subsequent passes through that action rulebook; thus we artificially create a situation where, instead of performing an action on each object in turn, Inform acts once on the entire group. That allows us to assess the cumulative qualities of the group and have the action respond differently than it might when assessing each item individually.</p>
<p><span class="boldface">The Facts Were These</span> demonstrates how we might write an action for GIVE THREE DOLLARS TO MAN or GIVE PIE AND HAT TO MAN where the man would only accept the collective gift when its total proved satisfactory.</p>
<p><span class="boldface">Western Art History 305</span> demonstrates how we might allow EXAMINE, which doesn't normally permit multiple objects, to take them, but to give vaguer responses to a mass examination than an individual one.</p>
<p class="crossreference"><a href="Rdoc33.html" class="xreflink"><img class="asterisk" alt="*" src="inform:/doc_images/xref.png" />&#160;<i>See </i><b>Examining</b></a><i> for groups of objects that have a collective description different from their individual descriptions, and for commands that search multiple things at once</i></p><p class="crossreference"><a href="Rdoc82.html" class="xreflink"><img class="asterisk" alt="*" src="inform:/doc_images/xref.png" />&#160;<i>See </i><b>Dispensers and Supplies of Small Objects</b></a><i> for ways to let the player pick up a number of identical items from a dispenser or supply</i></p><hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "294: Shawn's Bad Day" "e311" -->
<a id="e311"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example311'); return false;"><b>294</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example311'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Shawn's Bad Day</span></b></a><br />Allowing the player to EXAMINE ALL.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc268.html#e311"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example311" style="display: none;">
<p>We can add the handling of multiple objects to an existing action simply by adding in a line of grammar using &quot;[things]&quot;. In response, Inform will consider every object accepted by the token, and perform the action once for each of those objects. Thus:</p>
<!-- START CODE "c11945_311" -->
<a id="c11945_311"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Shawn[=0x0027=]s Bad Day[=0x0022=][=0x000A=][=0x000A=]The Treasury is a room. The vault is a lockable locked closed openable container in the Treasury. It is fixed in place. [=0x0022=]A massive vault fills up one wall.[=0x0022=] The description is [=0x0022=]The vault[=0x0027=]s system includes [a list of things which are part of the vault].[=0x0022=][=0x000A=][=0x000A=]A little green light, a little blue light, a little red light, a thin black pane of glass, a laser beam, a retinal scanner, a thumbprint ID plate, a dial, and a large lever are part of the vault.[=0x000A=][=0x000A=]The security guard is a man in the Treasury. The description is [=0x0022=]His name is Shawn, and he doesn[=0x0027=]t look happy.[=0x0022=][=0x000A=][=0x000A=]The description of the green light is [=0x0022=]Off.[=0x0022=] The description of the blue light is [=0x0022=]Tranquilly on.[=0x0022=] The description of the red light is [=0x0022=]Angrily flashing.[=0x0022=][=0x000A=][=0x000A=]Understand [=0x0022=]examine [things][=0x0022=] as examining.[=0x000A=][=0x000A=]Test me with [=0x0022=]examine all[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Shawn's Bad Day&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11946_311" -->
<a id="c11946_311"></a><blockquote class="code"><p class="quoted">
The Treasury is a room. The vault is a lockable locked closed openable container in the Treasury. It is fixed in place. &quot;A massive vault fills up one wall.&quot; The description is &quot;The vault's system includes [a list of things which are part of the vault].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11947_311" -->
<a id="c11947_311"></a><blockquote class="code"><p class="quoted">
A little green light, a little blue light, a little red light, a thin black pane of glass, a laser beam, a retinal scanner, a thumbprint ID plate, a dial, and a large lever are part of the vault.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11948_311" -->
<a id="c11948_311"></a><blockquote class="code"><p class="quoted">
The security guard is a man in the Treasury. The description is &quot;His name is Shawn, and he doesn't look happy.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11949_311" -->
<a id="c11949_311"></a><blockquote class="code"><p class="quoted">
The description of the green light is &quot;Off.&quot; The description of the blue light is &quot;Tranquilly on.&quot; The description of the red light is &quot;Angrily flashing.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11950_311" -->
<a id="c11950_311"></a><blockquote class="code"><p class="quoted">
Understand &quot;examine [things]&quot; as examining.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11951_311" -->
<a id="c11951_311"></a><blockquote class="code"><p class="quoted">
Test me with &quot;examine all&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "327: Western Art History 305" "e279" -->
<a id="e279"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example279'); return false;"><b>327</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example279'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Western Art History 305</span></b></a><br />Allowing EXAMINE to see multiple objects with a single command.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc284.html#e279"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example279" style="display: none;">
<p>In a gallery, there are many individual things to look at, but you can also get a general impression by just examining them as a collection.</p>
<p>First, we'll make a kind for the paintings exhibited in the gallery, and then we'll also make a special object to represent all of them as a mass:</p>
<!-- START CODE "c11952_279" -->
<a id="c11952_279"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Western Art History 305[=0x0022=][=0x000A=][=0x000A=]A painting is a kind of thing. A painting is usually fixed in place. Understand [=0x0022=]painting[=0x0022=] as a painting. Understand [=0x0022=]paintings[=0x0022=] as the plural of painting.[=0x000A=][=0x000A=]The painting-collective is a thing. The printed name of the painting-collective is [=0x0022=]paintings[=0x0022=]. The description of the painting-collective is [=0x0022=]There[=0x0027=]s [a list of visible paintings].[=0x0022=][=0x000A=][=0x000A=][We could if we wanted tweak the description to be different in style in different rooms of the gallery, but this will do for now. Next we need to make it possible to type something like EXAMINE PAINTINGS, which normally wouldn[=0x0027=]t work because the Standard Rules don[=0x0027=]t tell Inform to recognise multiple objects with the EXAMINE command (unlike, say, DROP or TAKE). This is easy:][=0x000A=][=0x000A=]Understand [=0x0022=]examine [things][=0x0022=] as examining.[=0x000A=][=0x000A=][Now to make use of the special object. If the player types EXAMINE PAINTINGS, the multiple object list will become a list of the visible paintings. The following rule looks at this list: if it contains more than one painting, it replaces them with the painting-collective instead. Now there[=0x0027=]s only one examining action, so we get a reply like [=0x0022=]There[=0x0027=]s an abstract painting, a pointilist painting and a French academic painting.[=0x0022=] instead of a list of descriptions of each in turn.][=0x000A=][=0x000A=]A multiple action processing rule when the current action is examining (this is the examine kinds rule):[=0x000A=][=0x0009=]let L be the multiple object list;[=0x000A=][=0x0009=]let F be L;[=0x000A=][=0x0009=]let the painting count be 0;[=0x000A=][=0x0009=]repeat with item running through L:[=0x000A=][=0x0009=][=0x0009=]if the item is a painting:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]increment the painting count;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]remove the item from F;[=0x000A=][=0x0009=]if the painting count is greater than one:[=0x000A=][=0x0009=][=0x0009=]add the painting-collective to F;[=0x000A=][=0x0009=][=0x0009=]alter the multiple object list to F.[=0x000A=][=0x000A=][And now some art to try this out on:][=0x000A=][=0x000A=]Gallery is a room. [=0x0022=]Various paintings hang on the walls of this gallery, awaiting critical attention. A side chamber to the north contains smaller works.[=0x0022=][=0x000A=][=0x000A=]The abstract painting, the pointilist painting, and the French academic painting are paintings in the Gallery.[=0x000A=][=0x000A=]North of the Gallery is the Side Chamber. A handsome miniature is a painting in the Side Chamber. The description of the handsome miniature is [=0x0022=]The miniature depicts a uniformed soldier of the late 18th century, with braid on his shoulders and a curl in his beard.[=0x0022=][=0x000A=][=0x000A=]The player carries a small notebook. The description of the notebook is [=0x0022=]It contains the notes you[=0x0027=]ve taken so far towards a paper for Western Art History 305. So far you[=0x0027=]re still feeling a bit uninspired.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]x paintings / x all / n / x paintings / x all[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Western Art History 305&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11953_279" -->
<a id="c11953_279"></a><blockquote class="code"><p class="quoted">
A painting is a kind of thing. A painting is usually fixed in place. Understand &quot;painting&quot; as a painting. Understand &quot;paintings&quot; as the plural of painting.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11954_279" -->
<a id="c11954_279"></a><blockquote class="code"><p class="quoted">
The painting-collective is a thing. The printed name of the painting-collective is &quot;paintings&quot;. The description of the painting-collective is &quot;There's [a list of visible paintings].&quot;
</p></blockquote>
<!-- END CODE -->
<p>We could if we wanted tweak the description to be different in style in different rooms of the gallery, but this will do for now. Next we need to make it possible to type something like EXAMINE PAINTINGS, which normally wouldn't work because the Standard Rules don't tell Inform to recognise multiple objects with the EXAMINE command (unlike, say, DROP or TAKE). This is easy:</p>
<!-- START CODE "c11955_279" -->
<a id="c11955_279"></a><blockquote class="code"><p class="quoted">
Understand &quot;examine [things]&quot; as examining.
</p></blockquote>
<!-- END CODE -->
<p>Now to make use of the special object. If the player types EXAMINE PAINTINGS, the multiple object list will become a list of the visible paintings. The following rule looks at this list: if it contains more than one painting, it replaces them with the painting-collective instead. Now there's only one examining action, so we get a reply like &quot;There's an abstract painting, a pointilist painting and a French academic painting.&quot; instead of a list of descriptions of each in turn.</p>
<!-- START CODE "c11956_279" -->
<a id="c11956_279"></a><blockquote class="code"><p class="quoted">
A multiple action processing rule when the current action is examining (this is the examine kinds rule):
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;let F be L;
<br />&#160;&#160;&#160;&#160;let the painting count be 0;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the item is a painting:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the painting count;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;remove the item from F;
<br />&#160;&#160;&#160;&#160;if the painting count is greater than one:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the painting-collective to F;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alter the multiple object list to F.
</p></blockquote>
<!-- END CODE -->
<p>And now some art to try this out on:</p>
<!-- START CODE "c11957_279" -->
<a id="c11957_279"></a><blockquote class="code"><p class="quoted">
Gallery is a room. &quot;Various paintings hang on the walls of this gallery, awaiting critical attention. A side chamber to the north contains smaller works.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11958_279" -->
<a id="c11958_279"></a><blockquote class="code"><p class="quoted">
The abstract painting, the pointilist painting, and the French academic painting are paintings in the Gallery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11959_279" -->
<a id="c11959_279"></a><blockquote class="code"><p class="quoted">
North of the Gallery is the Side Chamber. A handsome miniature is a painting in the Side Chamber. The description of the handsome miniature is &quot;The miniature depicts a uniformed soldier of the late 18th century, with braid on his shoulders and a curl in his beard.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11960_279" -->
<a id="c11960_279"></a><blockquote class="code"><p class="quoted">
The player carries a small notebook. The description of the notebook is &quot;It contains the notes you've taken so far towards a paper for Western Art History 305. So far you're still feeling a bit uninspired.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11961_279" -->
<a id="c11961_279"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x paintings / x all / n / x paintings / x all&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "328: The Best Till Last" "e344" -->
<a id="e344"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example344'); return false;"><b>328</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example344'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Best Till Last</span></b></a><br />Reordering multiple objects for dramatic effect.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc284.html#e344"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example344" style="display: none;">
<p>If a single command asks to do many things, some dull and some exciting, we may want to save the good ones for the end.</p>
<!-- START CODE "c11962_344" -->
<a id="c11962_344"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]The Best Till Last[=0x0022=][=0x000A=][=0x000A=]The Funky Ignition Lounge is a room. [=0x0022=]This is where all evenings end.[=0x0022=] The stick of gelignite, the solid magnesium footstool, the vetiver candle, and the vodka bottle are here.[=0x000A=][=0x000A=]The burn description of the vetiver candle is [=0x0022=]It burns right down, expensively but gothically.[=0x0022=][=0x000A=][=0x000A=]The player carries an inexpensive firework. The description of the firework is [=0x0022=]It is a cardboard tube with red and green stripes along the outside, and a fuse sticking out of the end.[=0x0022=] The burn description of the firework is [=0x0022=]It ignites gloriously! You take a few hasty steps back in order to avoid burning yourself, and not a moment too soon. Red and green sparks fly out of the tube, and there[=0x0027=]s a whistling noise punctuated by several loud cracks.[=0x0022=][=0x000A=][=0x000A=]The player carries a lighter. The description of the lighter is [=0x0022=]You don[=0x0027=]t smoke, but you like to have access to flame now and then anyway.[=0x0022=][=0x000A=][=0x000A=]Burning it with is an action applying to one thing and one carried thing.[=0x000A=][=0x000A=]Understand [=0x0022=]burn [things] with [something preferably held][=0x0022=] as burning it with.[=0x000A=][=0x000A=]The block burning rule is not listed in any rulebook.[=0x000A=][=0x000A=]A thing has some text called the burn description.[=0x000A=][=0x000A=]Check burning something:[=0x000A=][=0x0009=]if the player carries the lighter:[=0x000A=][=0x0009=][=0x0009=]try burning the noun with the lighter;[=0x000A=][=0x0009=]else:[=0x000A=][=0x0009=][=0x0009=]try burning the noun with the noun.[=0x000A=][=0x000A=]Check burning something with something when the second noun is not the lighter:[=0x000A=][=0x0009=]say [=0x0022=]Your trusty lighter is the best flame source available to you.[=0x0022=] instead.[=0x000A=][=0x000A=]Check burning something with something:[=0x000A=][=0x0009=]if the burn description of the noun is [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Best not.[=0x0022=] instead.[=0x000A=][=0x000A=]Carry out burning something with something:[=0x000A=][=0x0009=]remove the noun from play.[=0x000A=][=0x000A=]Report burning something with something:[=0x000A=][=0x0009=]say [=0x0022=][burn description of the noun][line break][=0x0022=].[=0x000A=][=0x000A=]A multiple action processing rule when the action name part of the current action is the burning it with action (this is the orderly burn rule):[=0x000A=][=0x0009=]let L be the multiple object list;[=0x000A=][=0x0009=]let dull list be a list of objects;[=0x000A=][=0x0009=]let fun list be a list of objects;[=0x000A=][=0x0009=]repeat with item running through L:[=0x000A=][=0x0009=][=0x0009=]if the burn description of the item is [=0x0022=][=0x0022=]:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]add item to dull list;[=0x000A=][=0x0009=][=0x0009=]else:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]add item to fun list;[=0x000A=][=0x0009=]let F be the dull list;[=0x000A=][=0x0009=]add fun list to F;[=0x000A=][=0x0009=]alter the multiple object list to F.[=0x000A=][=0x000A=]Test me with [=0x0022=]burn all with lighter[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;The Best Till Last&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11963_344" -->
<a id="c11963_344"></a><blockquote class="code"><p class="quoted">
The Funky Ignition Lounge is a room. &quot;This is where all evenings end.&quot; The stick of gelignite, the solid magnesium footstool, the vetiver candle, and the vodka bottle are here.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11964_344" -->
<a id="c11964_344"></a><blockquote class="code"><p class="quoted">
The burn description of the vetiver candle is &quot;It burns right down, expensively but gothically.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11965_344" -->
<a id="c11965_344"></a><blockquote class="code"><p class="quoted">
The player carries an inexpensive firework. The description of the firework is &quot;It is a cardboard tube with red and green stripes along the outside, and a fuse sticking out of the end.&quot; The burn description of the firework is &quot;It ignites gloriously! You take a few hasty steps back in order to avoid burning yourself, and not a moment too soon. Red and green sparks fly out of the tube, and there's a whistling noise punctuated by several loud cracks.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11966_344" -->
<a id="c11966_344"></a><blockquote class="code"><p class="quoted">
The player carries a lighter. The description of the lighter is &quot;You don't smoke, but you like to have access to flame now and then anyway.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11967_344" -->
<a id="c11967_344"></a><blockquote class="code"><p class="quoted">
Burning it with is an action applying to one thing and one carried thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11968_344" -->
<a id="c11968_344"></a><blockquote class="code"><p class="quoted">
Understand &quot;burn [things] with [something preferably held]&quot; as burning it with.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11969_344" -->
<a id="c11969_344"></a><blockquote class="code"><p class="quoted">
The block burning rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11970_344" -->
<a id="c11970_344"></a><blockquote class="code"><p class="quoted">
A thing has some text called the burn description.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11971_344" -->
<a id="c11971_344"></a><blockquote class="code"><p class="quoted">
Check burning something:
<br />&#160;&#160;&#160;&#160;if the player carries the lighter:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try burning the noun with the lighter;
<br />&#160;&#160;&#160;&#160;else:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try burning the noun with the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11972_344" -->
<a id="c11972_344"></a><blockquote class="code"><p class="quoted">
Check burning something with something when the second noun is not the lighter:
<br />&#160;&#160;&#160;&#160;say &quot;Your trusty lighter is the best flame source available to you.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11973_344" -->
<a id="c11973_344"></a><blockquote class="code"><p class="quoted">
Check burning something with something:
<br />&#160;&#160;&#160;&#160;if the burn description of the noun is &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Best not.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11974_344" -->
<a id="c11974_344"></a><blockquote class="code"><p class="quoted">
Carry out burning something with something:
<br />&#160;&#160;&#160;&#160;remove the noun from play.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11975_344" -->
<a id="c11975_344"></a><blockquote class="code"><p class="quoted">
Report burning something with something:
<br />&#160;&#160;&#160;&#160;say &quot;[burn description of the noun][line break]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11976_344" -->
<a id="c11976_344"></a><blockquote class="code"><p class="quoted">
A multiple action processing rule when the action name part of the current action is the burning it with action (this is the orderly burn rule):
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;let dull list be a list of objects;
<br />&#160;&#160;&#160;&#160;let fun list be a list of objects;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the burn description of the item is &quot;&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add item to dull list;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add item to fun list;
<br />&#160;&#160;&#160;&#160;let F be the dull list;
<br />&#160;&#160;&#160;&#160;add fun list to F;
<br />&#160;&#160;&#160;&#160;alter the multiple object list to F.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11977_344" -->
<a id="c11977_344"></a><blockquote class="code"><p class="quoted">
Test me with &quot;burn all with lighter&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "411: Escape from the Seraglio" "e175" -->
<a id="e175"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example175'); return false;"><b>411</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example175'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Escape from the Seraglio</span></b></a><br />Replacing the usual response to TAKE ALL so that instead of output such as "grapes: Taken. orange: Taken.", Inform produces variable responses in place of "grapes:".</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc341.html#e175"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example175" style="display: none;">
<!-- START CODE "c11978_175" -->
<a id="c11978_175"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Escape from the Seraglio[=0x0022=][=0x000A=][=0x000A=]Section 1 - Special Announcement Rules[=0x000A=][=0x000A=]The number of takes this turn is a number that varies. Every turn: now the number of takes this turn is 0.[=0x000A=][=0x000A=]The friskily announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.[=0x000A=][=0x000A=]This is the friskily announce items from multiple object lists rule:[=0x000A=][=0x0009=]if taking:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]increment the number of takes this turn;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][if number of takes this turn is 1]First [otherwise if the number of takes this turn is 2]And then [otherwise if the number of takes this turn is 3]And I suppose also [otherwise if the number of takes this turn is 7]And on we wearily go with [otherwise if the number of takes this turn is 9]Oh, and not forgetting [otherwise]And [end if][the current item from the multiple object list]: [run paragraph on][=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing, say [=0x0022=][current item from the multiple object list]: [run paragraph on][=0x0022=].[=0x000A=][=0x000A=]Rule for deciding whether all includes the person asked: it does not.[=0x000A=]Rule for deciding whether all includes a person when taking: it does not.[=0x000A=][=0x000A=]Section 2 - The Scenario[=0x000A=][=0x000A=]The Palm Chamber is a room. Sarissa is a woman in the Palm Chamber.[=0x000A=][=0x000A=]The Palm Chamber contains a bottle of ink, a quill pen, a tangerine, a bunch of grapes, a length of silken rope, some perfume, a cake of incense, a fitted leather bodice, a sapphire anklet, an illustrated novel, a whip, and a heavy iron key.[=0x000A=][=0x000A=]A persuasion rule for asking Sarissa to try taking the key:[=0x000A=][=0x0009=]say [=0x0022=]Sarissa nervously demurs, knowing that it is forbidden.[=0x0022=];[=0x000A=][=0x0009=]persuasion fails.[=0x000A=][=0x000A=]A persuasion rule: persuasion succeeds.[=0x000A=][=0x000A=]Test me with [=0x0022=]take all / drop all / sarissa, take all[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Escape from the Seraglio&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11979_175" -->
<a id="c11979_175"></a><blockquote class="code"><p class="quoted">
Section 1 - Special Announcement Rules
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11980_175" -->
<a id="c11980_175"></a><blockquote class="code"><p class="quoted">
The number of takes this turn is a number that varies. Every turn: now the number of takes this turn is 0.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11981_175" -->
<a id="c11981_175"></a><blockquote class="code"><p class="quoted">
The friskily announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11982_175" -->
<a id="c11982_175"></a><blockquote class="code"><p class="quoted">
This is the friskily announce items from multiple object lists rule:
<br />&#160;&#160;&#160;&#160;if taking:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the number of takes this turn;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[if number of takes this turn is 1]First [otherwise if the number of takes this turn is 2]And then [otherwise if the number of takes this turn is 3]And I suppose also [otherwise if the number of takes this turn is 7]And on we wearily go with [otherwise if the number of takes this turn is 9]Oh, and not forgetting [otherwise]And [end if][the current item from the multiple object list]: [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing, say &quot;[current item from the multiple object list]: [run paragraph on]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11983_175" -->
<a id="c11983_175"></a><blockquote class="code"><p class="quoted">
Rule for deciding whether all includes the person asked: it does not.
<br />Rule for deciding whether all includes a person when taking: it does not.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11984_175" -->
<a id="c11984_175"></a><blockquote class="code"><p class="quoted">
Section 2 - The Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11985_175" -->
<a id="c11985_175"></a><blockquote class="code"><p class="quoted">
The Palm Chamber is a room. Sarissa is a woman in the Palm Chamber.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11986_175" -->
<a id="c11986_175"></a><blockquote class="code"><p class="quoted">
The Palm Chamber contains a bottle of ink, a quill pen, a tangerine, a bunch of grapes, a length of silken rope, some perfume, a cake of incense, a fitted leather bodice, a sapphire anklet, an illustrated novel, a whip, and a heavy iron key.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11987_175" -->
<a id="c11987_175"></a><blockquote class="code"><p class="quoted">
A persuasion rule for asking Sarissa to try taking the key:
<br />&#160;&#160;&#160;&#160;say &quot;Sarissa nervously demurs, knowing that it is forbidden.&quot;;
<br />&#160;&#160;&#160;&#160;persuasion fails.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11988_175" -->
<a id="c11988_175"></a><blockquote class="code"><p class="quoted">
A persuasion rule: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11989_175" -->
<a id="c11989_175"></a><blockquote class="code"><p class="quoted">
Test me with &quot;take all / drop all / sarissa, take all&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "428: Formicidae" "e30" -->
<a id="e30"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example30'); return false;"><b>428</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example30'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Formicidae</span></b></a><br />Manipulating the order in which items are handled after TAKE ALL.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc357.html#e30"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example30" style="display: none;">
<p>Suppose we have an item that produces an interesting result the first time the player lifts it -- a rock with dangerous ants revealed underneath. The effect of the surprise is a little weakened, though, if the player sees that response as the result of a TAKE ALL, when it might be printed like this:</p>
<!-- START CODE "c11990_30" -->
<a id="c11990_30"></a><blockquote class="code"><p class="quoted">
&gt;[3] get all
<br />tent peg: Taken.
<br />water flask: Taken.
<br />trading permit: Taken.
<br />innocent-looking rock: You reach for the rock and turn it over to reveal a thriving colony of flesh-eating ants. Needless to say, you drop the rock and jump back with a decidedly effeminate scream. They can probably hear you all the way back in the base camp.
<br />rusty nail: Taken.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11991_30" -->
<a id="c11991_30"></a><blockquote class="code"><p class="quoted">
[Your score has just gone down by two points.]
</p></blockquote>
<!-- END CODE -->
<p>The calm response to &quot;rusty nail&quot; looks odd now, and the score change is disconnected from the event that caused it.</p>
<p>To manage this, we might institute a system so that interesting objects are handled last in their list, like so:</p>
<!-- START CODE "c11992_30" -->
<a id="c11992_30"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Formicidae[=0x0022=][=0x000A=][=0x000A=]Use scoring.[=0x000A=][=0x000A=]Section 1 - Procedure[=0x000A=][=0x000A=]The magic rule is listed before the generate action rule in the turn sequence rules.[=0x000A=][=0x000A=]A thing has a number called dramatic potential.[=0x000A=][=0x000A=]This is the magic rule:[=0x000A=][=0x0009=]let L be the multiple object list;[=0x000A=][=0x0009=]if the number of entries in L is greater than 1:[=0x000A=][=0x0009=][=0x0009=]sort L in dramatic potential order;[=0x000A=][=0x0009=][=0x0009=]alter the multiple object list to L.[=0x000A=][=0x000A=]Section 2 - Scenario[=0x000A=][=0x000A=]The Foothills is a room. [=0x0022=]The land has become hilly; though the soil is still mostly coarse yellow sand, clumps of grass are able to grow in the shadier places. Deep wagon ruts running from the southwest towards the mountains in the northeast show where generations of caravans have already passed.[=0x0022=][=0x000A=][=0x000A=]The water flask, the tent peg, and the trading permit are things in Foothills.[=0x000A=][=0x000A=]The rock is a thing in Foothills. Before printing the name of the rock when the rock is not handled: say [=0x0022=]innocent-looking [=0x0022=]. The dramatic potential of the rock is 10.[=0x000A=][=0x000A=]The rusty nail is a thing in Foothills.[=0x000A=][=0x000A=]The ant colony is a fixed in place thing. [=0x0022=]A busy group of ants are crawling to and fro in the unaccustomed sun.[=0x0022=] Rule for deciding whether all includes the ant colony while taking: it does not.[=0x000A=][=0x000A=]Instead of taking the rock when the rock is handled:[=0x000A=][=0x0009=]say [=0x0022=]It might still have a stray ant or two on it.[=0x0022=][=0x000A=][=0x000A=]After taking the rock:[=0x000A=][=0x0009=]now the rock is handled;[=0x000A=][=0x0009=]move ant colony to the location;[=0x000A=][=0x0009=]move the rock to the location;[=0x000A=][=0x0009=]say [=0x0022=]You reach for the rock and turn it over to reveal a thriving colony of flesh-eating ants. Needless to say, you drop the rock and jump back with a decidedly effeminate scream. They can probably hear you all the way back in the base camp.[=0x0022=];[=0x000A=][=0x0009=]decrease score by 2.[=0x000A=][=0x000A=]Test me with [=0x0022=]get peg / drop peg / get all / get rock[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Formicidae&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11993_30" -->
<a id="c11993_30"></a><blockquote class="code"><p class="quoted">
Use scoring.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11994_30" -->
<a id="c11994_30"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11995_30" -->
<a id="c11995_30"></a><blockquote class="code"><p class="quoted">
The magic rule is listed before the generate action rule in the turn sequence rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11996_30" -->
<a id="c11996_30"></a><blockquote class="code"><p class="quoted">
A thing has a number called dramatic potential.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11997_30" -->
<a id="c11997_30"></a><blockquote class="code"><p class="quoted">
This is the magic rule:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;if the number of entries in L is greater than 1:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sort L in dramatic potential order;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alter the multiple object list to L.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11998_30" -->
<a id="c11998_30"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11999_30" -->
<a id="c11999_30"></a><blockquote class="code"><p class="quoted">
The Foothills is a room. &quot;The land has become hilly; though the soil is still mostly coarse yellow sand, clumps of grass are able to grow in the shadier places. Deep wagon ruts running from the southwest towards the mountains in the northeast show where generations of caravans have already passed.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12000_30" -->
<a id="c12000_30"></a><blockquote class="code"><p class="quoted">
The water flask, the tent peg, and the trading permit are things in Foothills.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12001_30" -->
<a id="c12001_30"></a><blockquote class="code"><p class="quoted">
The rock is a thing in Foothills. Before printing the name of the rock when the rock is not handled: say &quot;innocent-looking &quot;. The dramatic potential of the rock is 10.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12002_30" -->
<a id="c12002_30"></a><blockquote class="code"><p class="quoted">
The rusty nail is a thing in Foothills.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12003_30" -->
<a id="c12003_30"></a><blockquote class="code"><p class="quoted">
The ant colony is a fixed in place thing. &quot;A busy group of ants are crawling to and fro in the unaccustomed sun.&quot; Rule for deciding whether all includes the ant colony while taking: it does not.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12004_30" -->
<a id="c12004_30"></a><blockquote class="code"><p class="quoted">
Instead of taking the rock when the rock is handled:
<br />&#160;&#160;&#160;&#160;say &quot;It might still have a stray ant or two on it.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12005_30" -->
<a id="c12005_30"></a><blockquote class="code"><p class="quoted">
After taking the rock:
<br />&#160;&#160;&#160;&#160;now the rock is handled;
<br />&#160;&#160;&#160;&#160;move ant colony to the location;
<br />&#160;&#160;&#160;&#160;move the rock to the location;
<br />&#160;&#160;&#160;&#160;say &quot;You reach for the rock and turn it over to reveal a thriving colony of flesh-eating ants. Needless to say, you drop the rock and jump back with a decidedly effeminate scream. They can probably hear you all the way back in the base camp.&quot;;
<br />&#160;&#160;&#160;&#160;decrease score by 2.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12006_30" -->
<a id="c12006_30"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get peg / drop peg / get all / get rock&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Note that while one could also manipulate the object list to add or remove items at this stage, there's a simpler way to control what Inform considers &quot;ALL&quot; to mean in commands: see the activity &quot;Deciding whether all includes&quot; in the activities chapter.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "431: The Facts Were These" "e297" -->
<a id="e297"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example297'); return false;"><b>431</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example297'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Facts Were These</span></b></a><br />Creating a variant GIVE action that lets the player give multiple objects simultaneously with commands like GIVE ALL TO ATTENDANT or GIVE THREE DOLLARS TO ATTENDANT or GIVE PIE AND HAT TO ATTENDANT. The attendant accepts the gifts only if their total combined value matches some minimum amount.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc361.html#e297"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example297" style="display: none;">
<p>Occasionally it happens that we want to process an action on multiple items differently than we would if the player had just typed each of the individual actions separately. In this example, the reason is that we can only successfully GIVE items when their combined value passes a certain threshold amount; otherwise the recipient will reject them.</p>
<p>This works as an implementation of money, if we give value only to cash objects (though several other implementations of cash are available, most of which are simpler and more efficient). We could also imagine a mechanic like this being used for a bargaining or auction game as well, given a society that deals in objects rather than credits.</p>
<p>In order to consider all the items in the gift at once, we create an action that applies to multiple objects, but will in fact test the whole object collection during the first pass and print a definitive answer to whether the action succeeded. All subsequent times the game consults the rulebook will be stopped at the very beginning. No further processing will occur or output be printed.</p>
<!-- START CODE "c12007_297" -->
<a id="c12007_297"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]The Facts Were These[=0x0022=][=0x000A=][=0x000A=]Section 1 - Procedure[=0x000A=][=0x000A=][We start by creating the idea that everything in the game has a monetary value:][=0x000A=][=0x000A=]A price is a kind of value. $10 specifies a price. A thing has a price.[=0x000A=][=0x000A=]Understand [=0x0022=]give [things preferably held] to [someone][=0x0022=] as multiply-giving it to. Understand [=0x0022=]give [things] to [someone][=0x0022=] as multiply-giving it to.  Multiply-giving it to is an action applying to two things.[=0x000A=][=0x000A=][A subtlety here: we say [=0x0022=]things preferably held[=0x0022=] to prefer items that the player is holding (so if the player has two dollars in hand and a third lies on the ground, he will use just the two he has).][=0x000A=][=0x000A=][The second grammar line allows Inform to match things that aren[=0x0027=]t held if it can[=0x0027=]t make up the list from things that are. If all three dollars are on the ground, the player can pick them up before spending them.][=0x000A=][=0x000A=][We do not, however, make multiply-giving apply to a [=0x0022=]carried[=0x0022=] item, because that will generate implicit takes of those items in a way that will mess up our action reporting. Instead, we[=0x0027=]re going to build the implicit takes into the system in a different way, one that permits us to collate the reports more attractively and print a short, one-sentence list of anything that the player had to pick up.][=0x000A=][=0x000A=]A thing can be given or ungiven. A thing is usually ungiven.[=0x000A=][=0x000A=][This is for record-keeping purposes so that we can print an attractive list of what was given at the end of the turn.][=0x000A=][=0x000A=]First check multiply-giving it to:[=0x000A=][=0x0009=]if already gave at the office is true:[=0x000A=][=0x0009=][=0x0009=]stop the action.[=0x000A=][=0x000A=]Already gave at the office is a truth state that varies.[=0x000A=][=0x000A=][[=0x0022=]Already gave at the office[=0x0022=] is the perhaps-excessively-named flag that keeps track of whether we[=0x0027=]ve already done this action once.][=0x000A=][=0x000A=]Check multiply-giving something to the player:[=0x000A=][=0x0009=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You can hardly bribe yourself.[paragraph break][=0x0022=] instead;[=0x000A=][=0x000A=][The following rule is longish because it processes the entire list at once, generating implicit takes if necessary (but processing those implicit takes silently according to its own special rule, so that the output can be managed attractively). We are also, at the same time, calculating the total value of the player[=0x0027=]s offer.][=0x000A=][=0x000A=]Check multiply-giving it to:[=0x000A=][=0x0009=]let L be the multiple object list;[=0x000A=][=0x0009=]let bribe-price be $0;[=0x000A=][=0x0009=]repeat with item running through L:[=0x000A=][=0x0009=][=0x0009=]if the player does not carry the item:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]abide by the ungivability rules for the item;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]carry out the implicitly taking activity with the item;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]if the player does not carry the item:[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=]You can[=0x0027=]t include [the item] in your bribe, since you[=0x0027=]re not holding [them]![paragraph break][=0x0022=] instead;[=0x000A=][=0x0009=][=0x0009=]increase bribe-price by the price of item;[=0x000A=][=0x0009=]if the number of entries in the recently-collected list is greater than 0:[=0x000A=][=0x0009=][=0x0009=]repeat with item running through the recently-collected list:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]now item is marked for listing;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You pick up [the list of marked for listing things] and make your offer. [run paragraph on][=0x0022=];[=0x000A=][=0x0009=][=0x0009=]now everything is unmarked for listing;[=0x000A=][=0x0009=]if the bribe-price is less than the price of the second noun:[=0x000A=][=0x0009=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][The second noun] angrily rejects your piffling bribe.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=][The bit about making some items [=0x0022=]marked for listing[=0x0022=], above, rather than printing the list directly, is that using the [=0x0022=][the list of....][=0x0022=] syntax guarantees that Inform will respect grouping rules in writing its description. For instance, if the player has automatically taken all three dollars, the output will say [=0x0022=]the three dollars[=0x0022=] instead of [=0x0022=]the dollar, the dollar, and the dollar.[=0x0022=]][=0x000A=][=0x000A=]Carry out multiply-giving it to:[=0x000A=][=0x0009=]let L be the multiple object list;[=0x000A=][=0x0009=]repeat with item running through L:[=0x000A=][=0x0009=][=0x0009=]now the second noun carries the item;[=0x000A=][=0x0009=][=0x0009=]now the item is given;[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x000A=]Report multiply-giving it to:[=0x000A=][=0x0009=]say [=0x0022=][The second noun] rather shamefacedly tucks [the list of given things] away into a pocket.[paragraph break][=0x0022=].[=0x000A=][=0x000A=][Now we create our own variation of implicitly taking in order to customize the output for the multiply-giving action. The [=0x0022=]ungivability rules[=0x0022=] should disallow any object that the player absolutely cannot take, because we want [=0x0022=]carry out the implicitly taking activity[=0x0022=] to succeed every time -- and therefore not print out any less-attractive results from implicit takes that don[=0x0027=]t succeed. Otherwise, the player[=0x0027=]s GIVE TREE AND DOG TO ATTENDANT might produce the reply [=0x0022=]That[=0x0027=]s fixed in place[=0x0022=] -- without specifying which object is fixed in place.][=0x000A=][=0x000A=][Because of the way this works, we will want to be careful: if we have any [=0x0022=]instead of taking...[=0x0022=] rules for special objects in the game, we should be sure to mirror those with an ungivability rule to print something more suitable in the case that the player tries taking that object as part of the multiple giving action.][=0x000A=][=0x000A=]The ungivability rules are an object-based rulebook.[=0x000A=][=0x000A=]An ungivability rule for a person:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=]Slavery is illegal.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]An ungivability rule for something (called the item) which is enclosed by someone who is not the player:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=][The item] [aren[=0x0027=]t] yours to give.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]An ungivability rule for something which encloses the player:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=]You don[=0x0027=]t want to end up as part of the gift.[paragraph break][=0x0022=] instead;[=0x000A=][=0x000A=]An ungivability rule for something (called the item) which is part of something:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] attached to [a random thing which incorporates the item][paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]An ungivability rule for something (called the item) which is scenery:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] unremovable.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]An ungivability rule for something (called the item) which is fixed in place:[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] fixed in place.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]An ungivability rule for a direction (called the item):[=0x000A=][=0x0009=]now already gave at the office is true;[=0x000A=][=0x0009=]say [=0x0022=][The item] [are] not susceptible to giving.[paragraph break][=0x0022=] instead.[=0x000A=][=0x000A=]Rule for implicitly taking something (called target) while multiply-giving:[=0x000A=][=0x0009=]silently try taking the target;[=0x000A=][=0x0009=]if the player carries the target:[=0x000A=][=0x0009=][=0x0009=]add the target to the recently-collected list.[=0x000A=][=0x000A=]The recently-collected list is a list of objects that varies.[=0x000A=][=0x000A=][And since we don[=0x0027=]t want to list the individual objects separately:][=0x000A=][=0x000A=]The selectively announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.[=0x000A=][=0x000A=]This is the selectively announce items from multiple object lists rule:[=0x000A=][=0x0009=]if multiply-giving:[=0x000A=][=0x0009=][=0x0009=]do nothing;[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]if the current item from the multiple object list is not nothing:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][current item from the multiple object list]: [run paragraph on][=0x0022=].[=0x000A=][=0x000A=][And now, since this ought to work symmetrically if the player provides just one high-value item:][=0x000A=][=0x000A=]Check giving something to someone:[=0x000A=][=0x0009=]if the price of the noun is less than the price of the second noun:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][The second noun] angrily rejects your piffling bribe.[=0x0022=] instead.[=0x000A=][=0x000A=][As we[=0x0027=]ve seen elsewhere, the giving action by default returns a refusal, but is also written to start working if we remove the blockage. So we do that here, and revise the report rule to match the report rule we have for multiple giving.][=0x000A=][=0x000A=]The block giving rule is not listed in any rulebook.[=0x000A=][=0x000A=]The new report giving rule is listed instead of the standard report giving rule in the report giving it to rules.[=0x000A=][=0x000A=]This is the new report giving rule:[=0x000A=][=0x0009=]say [=0x0022=][The second noun] rather shamefacedly tucks [the noun] away into a pocket.[=0x0022=][=0x000A=][=0x000A=][After each instance of the multiply-giving action, we need to clear the variables we used to track its state. We could do this in [=0x0022=]Before reading a command[=0x0022=], but that[=0x0027=]s unsafe because the player might type GIVE PIE AND CAP TO ATTENDANT. GIVE DOLLARS TO ATTENDANT. all on a single line, and we would like to be able to clear the variables between one action and the next. The correct place to attach this behavior is immediately before the generate action rule, thus:][=0x000A=][=0x000A=]The before-generation rule is listed before the generate action rule in the turn sequence rules.[=0x000A=][=0x000A=]This is the before-generation rule:[=0x000A=][=0x0009=]now every thing is ungiven;[=0x000A=][=0x0009=]now already gave at the office is false;[=0x000A=][=0x0009=]truncate the recently-collected list to 0 entries.[=0x000A=][=0x000A=]Section 2 - Scenario[=0x000A=][=0x000A=]The Morgue Office is a room. [=0x0022=]This is not the Morgue itself; this is only its outer office. The familiar room full of silver drawers and cold air lies beyond.[=0x0022=][=0x000A=][=0x000A=]The Morgue Attendant is a man in the Morgue Office. [=0x0022=]The Attendant has seen you come through a number of times, and is becoming suspicious of your abiding interest in dead people.[=0x0022=] The description is [=0x0022=]The Morgue Attendant is fifty-four years, six months, five days, and three minutes old.[=0x0022=] The price of the Morgue Attendant is $3.[=0x000A=][=0x000A=]A dollar is a kind of thing. The player carries three dollars.  The price of a dollar is always $1.[=0x000A=][=0x000A=]The player carries a miniature rhubarb pie. The price of the miniature rhubarb pie is $5.[=0x000A=][=0x000A=]The player carries a knitted cap. The price of the knitted cap is $2.[=0x000A=][=0x000A=]Test me with [=0x0022=]test dollars / purloin three dollars / test multi-line / purloin three dollars / purloin pie / purloin cap / test specificity / purloin three dollars / test largesse / test mixed-gift[=0x0022=].[=0x000A=][=0x000A=]Test multi-line with [=0x0022=]give dollar and pie to attendant. give dollars and cap to attendant[=0x0022=].[=0x000A=][=0x000A=]Test dollars with [=0x0022=]drop all / give dollar to Morgue Attendant / give dollars to Morgue Attendant / get dollars / give dollars to morgue attendant / purloin three dollars / drop dollars / give dollars to Morgue Attendant[=0x0022=].[=0x000A=][=0x000A=]Test specificity with [=0x0022=]give three dollars to Morgue Attendant[=0x0022=].[=0x000A=][=0x000A=]Test largesse with [=0x0022=]give pie to Morgue Attendant[=0x0022=].[=0x000A=][=0x000A=]Test mixed-gift with [=0x0022=]give dollar and cap to Morgue Attendant / get cap / give dollar and cap to morgue attendant / give me and dollar to attendant[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;The Facts Were These&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12008_297" -->
<a id="c12008_297"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<p>We start by creating the idea that everything in the game has a monetary value:</p>
<!-- START CODE "c12009_297" -->
<a id="c12009_297"></a><blockquote class="code"><p class="quoted">
A price is a kind of value. $10 specifies a price. A thing has a price.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12010_297" -->
<a id="c12010_297"></a><blockquote class="code"><p class="quoted">
Understand &quot;give [things preferably held] to [someone]&quot; as multiply-giving it to. Understand &quot;give [things] to [someone]&quot; as multiply-giving it to.  Multiply-giving it to is an action applying to two things.
</p></blockquote>
<!-- END CODE -->
<p>A subtlety here: we say &quot;things preferably held&quot; to prefer items that the player is holding (so if the player has two dollars in hand and a third lies on the ground, he will use just the two he has).</p>
<p>The second grammar line allows Inform to match things that aren't held if it can't make up the list from things that are. If all three dollars are on the ground, the player can pick them up before spending them.</p>
<p>We do not, however, make multiply-giving apply to a &quot;carried&quot; item, because that will generate implicit takes of those items in a way that will mess up our action reporting. Instead, we're going to build the implicit takes into the system in a different way, one that permits us to collate the reports more attractively and print a short, one-sentence list of anything that the player had to pick up.</p>
<!-- START CODE "c12011_297" -->
<a id="c12011_297"></a><blockquote class="code"><p class="quoted">
A thing can be given or ungiven. A thing is usually ungiven.
</p></blockquote>
<!-- END CODE -->
<p>This is for record-keeping purposes so that we can print an attractive list of what was given at the end of the turn.</p>
<!-- START CODE "c12012_297" -->
<a id="c12012_297"></a><blockquote class="code"><p class="quoted">
First check multiply-giving it to:
<br />&#160;&#160;&#160;&#160;if already gave at the office is true:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12013_297" -->
<a id="c12013_297"></a><blockquote class="code"><p class="quoted">
Already gave at the office is a truth state that varies.
</p></blockquote>
<!-- END CODE -->
<p>&quot;Already gave at the office&quot; is the perhaps-excessively-named flag that keeps track of whether we've already done this action once.</p>
<!-- START CODE "c12014_297" -->
<a id="c12014_297"></a><blockquote class="code"><p class="quoted">
Check multiply-giving something to the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can hardly bribe yourself.[paragraph break]&quot; instead;
</p></blockquote>
<!-- END CODE -->
<p>The following rule is longish because it processes the entire list at once, generating implicit takes if necessary (but processing those implicit takes silently according to its own special rule, so that the output can be managed attractively). We are also, at the same time, calculating the total value of the player's offer.</p>
<!-- START CODE "c12015_297" -->
<a id="c12015_297"></a><blockquote class="code"><p class="quoted">
Check multiply-giving it to:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;let bribe-price be $0;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the player does not carry the item:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;abide by the ungivability rules for the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the implicitly taking activity with the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the player does not carry the item:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can't include [the item] in your bribe, since you're not holding [them]![paragraph break]&quot; instead;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increase bribe-price by the price of item;
<br />&#160;&#160;&#160;&#160;if the number of entries in the recently-collected list is greater than 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with item running through the recently-collected list:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now item is marked for listing;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You pick up [the list of marked for listing things] and make your offer. [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now everything is unmarked for listing;
<br />&#160;&#160;&#160;&#160;if the bribe-price is less than the price of the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The second noun] angrily rejects your piffling bribe.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>The bit about making some items &quot;marked for listing&quot;, above, rather than printing the list directly, is that using the &quot;[the list of....]&quot; syntax guarantees that Inform will respect grouping rules in writing its description. For instance, if the player has automatically taken all three dollars, the output will say &quot;the three dollars&quot; instead of &quot;the dollar, the dollar, and the dollar.&quot;</p>
<!-- START CODE "c12016_297" -->
<a id="c12016_297"></a><blockquote class="code"><p class="quoted">
Carry out multiply-giving it to:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the second noun carries the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the item is given;
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12017_297" -->
<a id="c12017_297"></a><blockquote class="code"><p class="quoted">
Report multiply-giving it to:
<br />&#160;&#160;&#160;&#160;say &quot;[The second noun] rather shamefacedly tucks [the list of given things] away into a pocket.[paragraph break]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Now we create our own variation of implicitly taking in order to customize the output for the multiply-giving action. The &quot;ungivability rules&quot; should disallow any object that the player absolutely cannot take, because we want &quot;carry out the implicitly taking activity&quot; to succeed every time -- and therefore not print out any less-attractive results from implicit takes that don't succeed. Otherwise, the player's GIVE TREE AND DOG TO ATTENDANT might produce the reply &quot;That's fixed in place&quot; -- without specifying which object is fixed in place.</p>
<p>Because of the way this works, we will want to be careful: if we have any &quot;instead of taking...&quot; rules for special objects in the game, we should be sure to mirror those with an ungivability rule to print something more suitable in the case that the player tries taking that object as part of the multiple giving action.</p>
<!-- START CODE "c12018_297" -->
<a id="c12018_297"></a><blockquote class="code"><p class="quoted">
The ungivability rules are an object-based rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12019_297" -->
<a id="c12019_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for a person:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;Slavery is illegal.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12020_297" -->
<a id="c12020_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is enclosed by someone who is not the player:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [aren't] yours to give.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12021_297" -->
<a id="c12021_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something which encloses the player:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;You don't want to end up as part of the gift.[paragraph break]&quot; instead;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12022_297" -->
<a id="c12022_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is part of something:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] attached to [a random thing which incorporates the item][paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12023_297" -->
<a id="c12023_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is scenery:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] unremovable.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12024_297" -->
<a id="c12024_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is fixed in place:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] fixed in place.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12025_297" -->
<a id="c12025_297"></a><blockquote class="code"><p class="quoted">
An ungivability rule for a direction (called the item):
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] not susceptible to giving.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12026_297" -->
<a id="c12026_297"></a><blockquote class="code"><p class="quoted">
Rule for implicitly taking something (called target) while multiply-giving:
<br />&#160;&#160;&#160;&#160;silently try taking the target;
<br />&#160;&#160;&#160;&#160;if the player carries the target:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the target to the recently-collected list.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12027_297" -->
<a id="c12027_297"></a><blockquote class="code"><p class="quoted">
The recently-collected list is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>And since we don't want to list the individual objects separately:</p>
<!-- START CODE "c12028_297" -->
<a id="c12028_297"></a><blockquote class="code"><p class="quoted">
The selectively announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12029_297" -->
<a id="c12029_297"></a><blockquote class="code"><p class="quoted">
This is the selectively announce items from multiple object lists rule:
<br />&#160;&#160;&#160;&#160;if multiply-giving:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;do nothing;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[current item from the multiple object list]: [run paragraph on]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>And now, since this ought to work symmetrically if the player provides just one high-value item:</p>
<!-- START CODE "c12030_297" -->
<a id="c12030_297"></a><blockquote class="code"><p class="quoted">
Check giving something to someone:
<br />&#160;&#160;&#160;&#160;if the price of the noun is less than the price of the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The second noun] angrily rejects your piffling bribe.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>As we've seen elsewhere, the giving action by default returns a refusal, but is also written to start working if we remove the blockage. So we do that here, and revise the report rule to match the report rule we have for multiple giving.</p>
<!-- START CODE "c12031_297" -->
<a id="c12031_297"></a><blockquote class="code"><p class="quoted">
The block giving rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12032_297" -->
<a id="c12032_297"></a><blockquote class="code"><p class="quoted">
The new report giving rule is listed instead of the standard report giving rule in the report giving it to rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12033_297" -->
<a id="c12033_297"></a><blockquote class="code"><p class="quoted">
This is the new report giving rule:
<br />&#160;&#160;&#160;&#160;say &quot;[The second noun] rather shamefacedly tucks [the noun] away into a pocket.&quot;
</p></blockquote>
<!-- END CODE -->
<p>After each instance of the multiply-giving action, we need to clear the variables we used to track its state. We could do this in &quot;Before reading a command&quot;, but that's unsafe because the player might type GIVE PIE AND CAP TO ATTENDANT. GIVE DOLLARS TO ATTENDANT. all on a single line, and we would like to be able to clear the variables between one action and the next. The correct place to attach this behavior is immediately before the generate action rule, thus:</p>
<!-- START CODE "c12034_297" -->
<a id="c12034_297"></a><blockquote class="code"><p class="quoted">
The before-generation rule is listed before the generate action rule in the turn sequence rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12035_297" -->
<a id="c12035_297"></a><blockquote class="code"><p class="quoted">
This is the before-generation rule:
<br />&#160;&#160;&#160;&#160;now every thing is ungiven;
<br />&#160;&#160;&#160;&#160;now already gave at the office is false;
<br />&#160;&#160;&#160;&#160;truncate the recently-collected list to 0 entries.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12036_297" -->
<a id="c12036_297"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12037_297" -->
<a id="c12037_297"></a><blockquote class="code"><p class="quoted">
The Morgue Office is a room. &quot;This is not the Morgue itself; this is only its outer office. The familiar room full of silver drawers and cold air lies beyond.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12038_297" -->
<a id="c12038_297"></a><blockquote class="code"><p class="quoted">
The Morgue Attendant is a man in the Morgue Office. &quot;The Attendant has seen you come through a number of times, and is becoming suspicious of your abiding interest in dead people.&quot; The description is &quot;The Morgue Attendant is fifty-four years, six months, five days, and three minutes old.&quot; The price of the Morgue Attendant is $3.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12039_297" -->
<a id="c12039_297"></a><blockquote class="code"><p class="quoted">
A dollar is a kind of thing. The player carries three dollars.  The price of a dollar is always $1.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12040_297" -->
<a id="c12040_297"></a><blockquote class="code"><p class="quoted">
The player carries a miniature rhubarb pie. The price of the miniature rhubarb pie is $5.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12041_297" -->
<a id="c12041_297"></a><blockquote class="code"><p class="quoted">
The player carries a knitted cap. The price of the knitted cap is $2.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12042_297" -->
<a id="c12042_297"></a><blockquote class="code"><p class="quoted">
Test me with &quot;test dollars / purloin three dollars / test multi-line / purloin three dollars / purloin pie / purloin cap / test specificity / purloin three dollars / test largesse / test mixed-gift&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12043_297" -->
<a id="c12043_297"></a><blockquote class="code"><p class="quoted">
Test multi-line with &quot;give dollar and pie to attendant. give dollars and cap to attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12044_297" -->
<a id="c12044_297"></a><blockquote class="code"><p class="quoted">
Test dollars with &quot;drop all / give dollar to Morgue Attendant / give dollars to Morgue Attendant / get dollars / give dollars to morgue attendant / purloin three dollars / drop dollars / give dollars to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12045_297" -->
<a id="c12045_297"></a><blockquote class="code"><p class="quoted">
Test specificity with &quot;give three dollars to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12046_297" -->
<a id="c12046_297"></a><blockquote class="code"><p class="quoted">
Test largesse with &quot;give pie to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12047_297" -->
<a id="c12047_297"></a><blockquote class="code"><p class="quoted">
Test mixed-gift with &quot;give dollar and cap to Morgue Attendant / get cap / give dollar and cap to morgue attendant / give me and dollar to attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<p>PURLOIN, used in the tests here, is a special debugging command that allows the player to acquire objects that wouldn't otherwise be possible to take. It is only active in non-release versions of the story. For more about debugging commands, see the chapter on Testing and Debugging.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="Rdoc42.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="Rdoc44.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
