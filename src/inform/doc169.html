<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>11.11. Repeat running through</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Repeat running through" -->
<!-- SEARCH SECTION "11.11" -->
<!-- SEARCH SORT "000-011-011-000" -->
<!-- START IGNORE 168 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc168.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 11: Phrases</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc170.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง11.11. Repeat running through</p>
<p>Inform is not used very much for numerical work, so the kind of repeat loop described in the previous section is not much used. Inform's natural domain is really the world of things and rooms, so the following kind of repeat is much more useful.</p>
<!-- START PHRASE "defn130" -->
<div class="definition"><a id="defn130"></a><p class="defnprototype"><b>repeat with </b>(a name not so far used)<b> running through </b>(description of values)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_runthrough -->

<p>This phrase causes the block of phrases following it to be repeated once for each value matching the description, storing that value in the named variable. (The variable exists only temporarily, within the repetition.) Example:</p>
<!-- START CODE "c2959" -->
<a id="c2959"></a><blockquote class="code"><p class="quoted">
repeat with item running through open containers:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>If there are no containers, or they are all closed, the phrases will not be followed at all. Inform will issue a Problem message if the range of the loop may be infinite: for example, it won't allow:</p>
<!-- START CODE "c2960" -->
<a id="c2960"></a><blockquote class="code"><p class="quoted">
repeat with X running through odd numbers:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>On the other hand it will allow:</p>
<!-- START CODE "c2961" -->
<a id="c2961"></a><blockquote class="code"><p class="quoted">
repeat with T running through times:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>which repeats 1440 times, starting with T at midnight and finishing at 11:59 PM. See the Kinds index for which kinds of value can be repeated through.</p>

<!-- end definition -->
</div>

<p>As with counting the &quot;number of ...&quot; objects satisfying some property, we can run through a wide variety of possibilities - any description whose range is possible for Inform to search. For example:</p>
<!-- START CODE "c2962" -->
<a id="c2962"></a><blockquote class="code"><p class="quoted">
repeat with dinner guest running through the people in the Dining Room:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2963" -->
<a id="c2963"></a><blockquote class="code"><p class="quoted">
repeat with possession running through things carried:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2964" -->
<a id="c2964"></a><blockquote class="code"><p class="quoted">
repeat with event running through non-recurring scenes which are happening:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>The following lists the whereabouts of all men in lighted rooms:</p>
<!-- START CODE "c2965" -->
<a id="c2965"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('repeat with suspect running through the men who are in a lighted room:[=0x000A=][=0x0009=]say [=0x0022=][The suspect] is in [the location of the suspect].[=0x0022=];[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> repeat with suspect running through the men who are in a lighted room:
<br />&#160;&#160;&#160;&#160;say &quot;[The suspect] is in [the location of the suspect].&quot;;
</p></blockquote>
<!-- END CODE -->
<p>One small note of caution: if what the &quot;repeat&quot; loop does is to change the things being repeated through, changing in particular whether items not yet reached will qualify to be repeated through, the results can be unexpected. Rather than writing &quot;repeat with X running through D&quot;, it may be safer to try &quot;while there is D (called X)&quot;, though note that this will only finish if X is always changed so that it no longer qualifies.</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "176: Strictly Ballroom" "e253" -->
<a id="e253"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example253'); return false;"><b>176</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example253'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Strictly Ballroom</span></b></a><br />People who select partners for dance lessons each turn.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc62.html#e253"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example253" style="display: none;">
<p>Many simple repetitions can effectively be done with a &quot;now...&quot; instruction: it is quicker to say</p>
<!-- START CODE "c2966_253" -->
<a id="c2966_253"></a><blockquote class="code"><p class="quoted">
now every person is angry
</p></blockquote>
<!-- END CODE -->
<p>than</p>
<!-- START CODE "c2967_253" -->
<a id="c2967_253"></a><blockquote class="code"><p class="quoted">
repeat with offended party running through people:
<br />&#160;&#160;&#160;&#160;now the offended party is angry.
</p></blockquote>
<!-- END CODE -->
<p>Repeat comes in handy when we have something a bit more complicated to do with each item:</p>
<!-- START CODE "c2968_253" -->
<a id="c2968_253"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Strictly Ballroom[=0x0022=][=0x000A=][=0x000A=]A person can be alert or occupied. A person is usually alert.[=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]now the player is occupied.[=0x000A=][=0x000A=]Dance is a kind of value. The dances are waltzes, polkas, cha-chas, charlestons, fox-trots, tangos, lambadas, and two-steps.[=0x000A=][=0x000A=]The current round is a dance that varies.[=0x000A=][=0x000A=]Manner is a kind of value. The manners are swiftly, primly, energetically, suavely, seductively, elegantly, and badly.[=0x000A=][=0x000A=]Every turn: now the current round is a random dance.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]repeat with dancer running through people who are not the player:[=0x000A=][=0x0009=][=0x0009=]if dancer is alert:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]now dancer is occupied;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]let partner be a random alert person who is not the dancer;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]if partner is a person:[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]now partner is occupied;[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][The dancer] [the current round][if a random chance of 1 in 5 succeeds] [a random manner][end if] with [partner]. [=0x0022=];[=0x000A=][=0x0009=][=0x0009=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=][paragraph break][The dancer] is forced to be a wallflower. Poor [dancer]. [=0x0022=];[=0x000A=][=0x0009=]say paragraph break.[=0x000A=][=0x000A=][Notice we did not say [=0x0022=]repeat with dancer running through alert people who are not the player...[=0x0022=]. This is because Inform would draw up a list of alert people at the beginning of the repeat, and not take into account which people became occupied partway through the repetition. If we want to make sure that each person dances only with one other person, we have to continue checking alertness each time we run through the repetition.][=0x000A=][=0x000A=][After all the partners are assigned, we can set up for the next turn by making everyone alert again, and for this we do not need [=0x0022=]repeat[=0x0022=]:][=0x000A=][=0x000A=]Every turn: now every person is alert; now the player is occupied.[=0x000A=][=0x000A=]Before doing something to someone: now the noun is occupied.[=0x000A=][=0x000A=]Before doing something when the second noun is a person: now the second noun is occupied.[=0x000A=][=0x000A=]Instead of doing something to someone: say [=0x0022=]You successfully distract [the noun].[=0x0022=][=0x000A=][=0x000A=]The Pacific Ballroom is a room. [=0x0022=]A rather utilitarian space at the moment, since this is a class and not a party.[=0x0022=] Timmy, Tommy, Joey, George, Mary, Martha, Yvette, McQueen, Linus, and Patricia are people in the Pacific Ballroom.[=0x000A=][=0x000A=]Test me with [=0x0022=]z / ask linus about blanket / z / z[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Strictly Ballroom&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2969_253" -->
<a id="c2969_253"></a><blockquote class="code"><p class="quoted">
A person can be alert or occupied. A person is usually alert.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2970_253" -->
<a id="c2970_253"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;now the player is occupied.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2971_253" -->
<a id="c2971_253"></a><blockquote class="code"><p class="quoted">
Dance is a kind of value. The dances are waltzes, polkas, cha-chas, charlestons, fox-trots, tangos, lambadas, and two-steps.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2972_253" -->
<a id="c2972_253"></a><blockquote class="code"><p class="quoted">
The current round is a dance that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2973_253" -->
<a id="c2973_253"></a><blockquote class="code"><p class="quoted">
Manner is a kind of value. The manners are swiftly, primly, energetically, suavely, seductively, elegantly, and badly.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2974_253" -->
<a id="c2974_253"></a><blockquote class="code"><p class="quoted">
Every turn: now the current round is a random dance.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2975_253" -->
<a id="c2975_253"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;repeat with dancer running through people who are not the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if dancer is alert:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now dancer is occupied;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let partner be a random alert person who is not the dancer;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if partner is a person:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now partner is occupied;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The dancer] [the current round][if a random chance of 1 in 5 succeeds] [a random manner][end if] with [partner]. &quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[paragraph break][The dancer] is forced to be a wallflower. Poor [dancer]. &quot;;
<br />&#160;&#160;&#160;&#160;say paragraph break.
</p></blockquote>
<!-- END CODE -->
<p>Notice we did not say &quot;repeat with dancer running through alert people who are not the player...&quot;. This is because Inform would draw up a list of alert people at the beginning of the repeat, and not take into account which people became occupied partway through the repetition. If we want to make sure that each person dances only with one other person, we have to continue checking alertness each time we run through the repetition.</p>
<p>After all the partners are assigned, we can set up for the next turn by making everyone alert again, and for this we do not need &quot;repeat&quot;:</p>
<!-- START CODE "c2976_253" -->
<a id="c2976_253"></a><blockquote class="code"><p class="quoted">
Every turn: now every person is alert; now the player is occupied.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2977_253" -->
<a id="c2977_253"></a><blockquote class="code"><p class="quoted">
Before doing something to someone: now the noun is occupied.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2978_253" -->
<a id="c2978_253"></a><blockquote class="code"><p class="quoted">
Before doing something when the second noun is a person: now the second noun is occupied.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2979_253" -->
<a id="c2979_253"></a><blockquote class="code"><p class="quoted">
Instead of doing something to someone: say &quot;You successfully distract [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2980_253" -->
<a id="c2980_253"></a><blockquote class="code"><p class="quoted">
The Pacific Ballroom is a room. &quot;A rather utilitarian space at the moment, since this is a class and not a party.&quot; Timmy, Tommy, Joey, George, Mary, Martha, Yvette, McQueen, Linus, and Patricia are people in the Pacific Ballroom.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2981_253" -->
<a id="c2981_253"></a><blockquote class="code"><p class="quoted">
Test me with &quot;z / ask linus about blanket / z / z&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc168.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc170.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
