<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>22.5. Map, filter and reduce</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Map, filter and reduce" -->
<!-- SEARCH SECTION "22.5" -->
<!-- SEARCH SORT "000-022-005-000" -->
<!-- START IGNORE 366 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc366.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 22: Advanced Phrases</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc368.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง22.5. Map, filter and reduce</p>
<p>When a mass of computations has to be done, the traditional approach is to work through them in a &quot;repeat&quot; loop. One modern alternative, growing in popularity, is to form a list of inputs; then apply the same computation to each input in turn to form a list of results (this is called &quot;mapping&quot;); throw out any bad or unwanted results (&quot;filtering&quot;); and then combine the surviving results into a single composite answer (&quot;reducing&quot;, though some programming languages call this &quot;folding&quot; or &quot;accumulation&quot;; it's a much-reinvented idea).</p>
<p>Inform provides all three of these fundamental list-processing operations. There is no special term for a &quot;map&quot;, because Inform treats it as another case of &quot;applied to&quot;.</p>
<!-- START PHRASE "defn362" -->
<div class="definition"><a id="defn362"></a><p class="defnprototype"><b></b>(phrase value -&gt; value)<b> applied to </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_appliedlist -->

<p>This phrase takes the list, applies the phrase to each entry in the list, and forms a new list of the result. Example:</p>
<!-- START CODE "c8700" -->
<a id="c8700"></a><blockquote class="code"><p class="quoted">
To decide what number is double (N - a number) (this is doubling):
<br />&#160;&#160;&#160;&#160;decide on N plus N.
</p></blockquote>
<!-- END CODE -->
<p>Then &quot;doubling applied to 2&quot; produces 4, by the simpler definition of &quot;applied to&quot;, but also:</p>
<!-- START CODE "c8701" -->
<a id="c8701"></a><blockquote class="code"><p class="quoted">
doubling applied to {2, 3, 4}
</p></blockquote>
<!-- END CODE -->
<p>produces the list {4, 6, 8}.</p>

<!-- end definition -->
</div>

<p>More divertingly, suppose we define:</p>
<!-- START CODE "c8702" -->
<a id="c8702"></a><blockquote class="code"><p class="quoted">
To decide what text is the longhand form of (N - a number)
<br />&#160;&#160;&#160;&#160;(this is spelling out):
<br />&#160;&#160;&#160;&#160;decide on &quot;[N in words]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8703" -->
<a id="c8703"></a><blockquote class="code"><p class="quoted">
To decide what text is the consonant form of (T - text)
<br />&#160;&#160;&#160;&#160;(this is txtng):
<br />&#160;&#160;&#160;&#160;replace the regular expression &quot;&lt;aeiou&gt;&quot; in T with &quot;&quot;;
<br />&#160;&#160;&#160;&#160;decide on T.
</p></blockquote>
<!-- END CODE -->
<p>Then we can write a chain of three maps in succession:</p>
<!-- START CODE "c8704" -->
<a id="c8704"></a><blockquote class="code"><p class="quoted">
txtng applied to spelling out applied to doubling applied to {3, 8, 4, 19, 7}
</p></blockquote>
<!-- END CODE -->
<p>to produce the value {&quot;sx&quot;, &quot;sxtn&quot;, &quot;ght&quot;, &quot;thrty-ght&quot;, &quot;frtn&quot;}.</p>
<p>Next, filtering. Here we make use of descriptions, in order to say what values will be allowed through the filter. So:</p>
<!-- START PHRASE "defn363" -->
<div class="definition"><a id="defn363"></a><p class="defnprototype"><b>filter to </b>(description of values)<b> of </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_filter -->

<p>This phrase produces a new list which is a thinner version of the one given, so that it contains only those values which match the description given. Example:</p>
<!-- START CODE "c8705" -->
<a id="c8705"></a><blockquote class="code"><p class="quoted">
filter to even numbers of {3, 8, 4, 19, 7}
</p></blockquote>
<!-- END CODE -->
<p>produces {8, 4}, with the values 3, 19, and 7 failing to make it through. A sufficiently fine filter may well thin out a list to a single entry, or even no entries at all, but the result is always a list.</p>

<!-- end definition -->
</div>

<p>To get the full effect of filtering, we probably need to define an adjective or two. For example:</p>
<!-- START CODE "c8706" -->
<a id="c8706"></a><blockquote class="code"><p class="quoted">
Definition: a text (called T) is lengthy if the number of characters in it is greater than 6.
</p></blockquote>
<!-- END CODE -->
<p>We can then write:</p>
<!-- START CODE "c8707" -->
<a id="c8707"></a><blockquote class="code"><p class="quoted">
filter to lengthy texts of spelling out applied to {15, 2, 20, 29, -4}
</p></blockquote>
<!-- END CODE -->
<p>which produces {&quot;fifteen&quot;, &quot;twenty-nine&quot;, &quot;minus four&quot;}.</p>
<p>Lastly, reduction. In order to combine a whole list of values, we need a phrase to combine any two. Here are some samples:</p>
<!-- START CODE "c8708" -->
<a id="c8708"></a><blockquote class="code"><p class="quoted">
To decide what number is the larger of (N - number) and (M - number)
<br />&#160;&#160;&#160;&#160;(this is maximizing):
<br />&#160;&#160;&#160;&#160;if N &gt; M, decide on N;
<br />&#160;&#160;&#160;&#160;decide on M.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8709" -->
<a id="c8709"></a><blockquote class="code"><p class="quoted">
To decide what text is the concatenation of (X - text) and (Y - text)
<br />&#160;&#160;&#160;&#160;(this is concatenation):
<br />&#160;&#160;&#160;&#160;decide on &quot;[X][Y]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>And here are some sample reductions:</p>
<!-- START CODE "c8710" -->
<a id="c8710"></a><blockquote class="code"><p class="quoted">
let X be the maximization reduction of {3, 8, 4, 19, 7};
<br />let Y be the concatenation reduction of txtng applied to spelling out
<br />&#160;&#160;&#160;&#160;applied to doubling applied to {3, 8, 4, 19, 7};
</p></blockquote>
<!-- END CODE -->
<p>sets X to 19, the highest of the values, and Y to the text &quot;sxsxtnghtthrty-ghtfrtn&quot;. In each case a list has been reduced to a single value which somehow combines the contents.</p>
<!-- START PHRASE "defn364" -->
<div class="definition"><a id="defn364"></a><p class="defnprototype"><b></b>(phrase (value, value) -&gt; value)<b> reduction of </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_reduction -->

<p>This phrase works through the list and accumulates the values in it, using the phrase supplied. Example: if we have</p>
<!-- START CODE "c8711" -->
<a id="c8711"></a><blockquote class="code"><p class="quoted">
To decide what number is the sum of (N - number) and (M - number)
<br />&#160;&#160;&#160;&#160;(this is summing):
<br />&#160;&#160;&#160;&#160;decide on N + M.
</p></blockquote>
<!-- END CODE -->
<p>then the summing reduction of {3, 8, 4, 19, 7} is the number 41, obtained by</p>
<!-- START CODE "c8712" -->
<a id="c8712"></a><blockquote class="code"><p class="quoted">
(((3 + 8) + 4) + 19) + 7
</p></blockquote>
<!-- END CODE -->
<p>so that the summing phrase has been used four times.</p>

<!-- end definition -->
</div>

<p>Is map/filter/reduce always a good idea? Devotees point out that almost any computation can be thought of in this way, and in systems where the work has to be distributed around multiple processors it can be a very powerful tool. (There are programming languages without loops where it's essentially the only tool.) At its best, it reads very elegantly: one assembles all of the tools needed - definitions of doubling, lengthy, spelling out, concatenation and so on - and then each actual task is expressed in a single line at the end.</p>
<p>On the other hand, there are also times when this is a needlessly complicated disguise for what could more easily be done with a &quot;repeat&quot; loop, and also more efficiently since assembling and dismantling lists in memory does take some overhead time. So these list operations are not a panacea, but it's good to have them available.</p>
<hr />
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc366.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc368.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
