<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>19.9. Basis of a rulebook</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Basis of a rulebook" -->
<!-- SEARCH SECTION "19.9" -->
<!-- SEARCH SORT "000-019-009-000" -->
<!-- START IGNORE 334 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc334.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 19: Rulebooks</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc336.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง19.9. Basis of a rulebook</p>
<p>Every rulebook works on a value supplied to it, though it doesn't always look that way. The kind of the value is called its &quot;basis&quot;; for example, if a rulebook works on a number, it's called a &quot;number based rulebook&quot;. Most of the rulebooks seen up to now have been action based rulebooks:</p>
<!-- START CODE "c7854" -->
<a id="c7854"></a><blockquote class="code"><p class="quoted">
Instead of eating the cake: ...
</p></blockquote>
<!-- END CODE -->
<p>&quot;Instead&quot; is an action based rulebook, and the action it works on is the one currently being processed. Besides before, after and instead, other action based rulebooks include the check, carry out, and report rules; general rulebooks such as every turn rules, the visibility rules, the turn sequence rules; and rules specially for dealing with the actions of other characters, such as the persuasion and unsuccessful attempt rules. But we have also seen object based rulebooks:</p>
<!-- START CODE "c7855" -->
<a id="c7855"></a><blockquote class="code"><p class="quoted">
Rule for reaching inside the flask: ...
</p></blockquote>
<!-- END CODE -->
<p>&quot;Reaching inside&quot; is an object based rulebook, and here we're giving it a rule which applies if the object is the flask. Inform would reject something like:</p>
<!-- START CODE "c7856" -->
<a id="c7856"></a><blockquote class="code"><p class="quoted">
Rule for reaching inside 100: ...
</p></blockquote>
<!-- END CODE -->
<p>because 100 has the wrong kind to fit - it's a number, not an object. There are many object based rulebooks, because most activities built-in to Inform act on objects. For example, the &quot;printing the name of&quot; activity has three rulebooks attached to it: before printing the name of, for printing the name of, after printing the name of. All of these are object based rulebooks.</p>
<p>Finally, we've also seen scene based rulebooks (which is how rules like &quot;when a recurring scene ends&quot; worked, in the Scenes chapter).</p>
<p>If a rulebook is declared like so:</p>
<!-- START CODE "c7857" -->
<a id="c7857"></a><blockquote class="code"><p class="quoted">
Marvellous reasoning is a rulebook.
</p></blockquote>
<!-- END CODE -->
<p>then it is an action based rulebook. If we want something different, we must write something like this:</p>
<!-- START CODE "c7858" -->
<a id="c7858"></a><blockquote class="code"><p class="quoted">
Grading is a number based rulebook.
<br />Grading 5: say &quot;It's five. What can I say?&quot; instead.
<br />Grading an odd number (called N): say &quot;There's something odd about [N].&quot; instead.
<br />Grading a number (called N): say &quot;Just [N].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7859" -->
<a id="c7859"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />repeat with N running from 1 to 10:
<br />&#160;&#160;&#160;&#160;say &quot;Grading [N]: &quot;;
<br />&#160;&#160;&#160;&#160;follow the grading rulebook for N.
</p></blockquote>
<!-- END CODE -->
<p>which produces:</p>
<!-- START CODE "c7860" -->
<a id="c7860"></a><blockquote class="code"><p class="quoted">
Grading 1: There's something odd about 1.
<br />Grading 2: Just 2.
<br />Grading 3: There's something odd about 3.
<br />Grading 4: Just 4.
<br />Grading 5: It's five. What can I say?
<br />Grading 6: Just 6.
<br />Grading 7: There's something odd about 7.
<br />Grading 8: Just 8.
<br />Grading 9: There's something odd about 9.
<br />Grading 10: Just 10.
</p></blockquote>
<!-- END CODE -->
<p>Here we needed a variation on &quot;follow&quot; which supplies the value to apply to:</p>
<!-- START PHRASE "defn274" -->
<div class="definition"><a id="defn274"></a><p class="defnprototype"><b>follow </b>(values based rule producing values)<b> for </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_followfor -->

<p>This phrase causes the rule to be obeyed immediately (rather than simply at predetermined times such as when a particular action is being tried, or at the end of every turn, and such), and applies it to the value given, which must be of a matching kind. Example:</p>
<!-- START CODE "c7861" -->
<a id="c7861"></a><blockquote class="code"><p class="quoted">
follow the reaching inside rulebook for the electrified cage;
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>And here is an example based on objects:</p>
<!-- START CODE "c7862" -->
<a id="c7862"></a><blockquote class="code"><p class="quoted">
The flotation rules are an object based rulebook.
<br />A flotation rule for the cork: rule succeeds.
<br />A flotation rule for an inflated thing: rule succeeds.
<br />A flotation rule: rule fails.
</p></blockquote>
<!-- END CODE -->
<p>And we might use the flotation rules in a circumstance like this:</p>
<!-- START CODE "c7863" -->
<a id="c7863"></a><blockquote class="code"><p class="quoted">
After inserting something into the well:
<br />&#160;&#160;&#160;&#160;follow the flotation rules for the noun;
<br />&#160;&#160;&#160;&#160;if the rule succeeded:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The noun] bobs on the surface.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the noun is nowhere;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The noun] sinks out of sight.&quot;
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "403: Flotation" "e343" -->
<a id="e343"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example343'); return false;"><b>403</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example343'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Flotation</span></b></a><br />Objects that can sink or float in a well, depending on their own properties and the state of the surrounding environment.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc81.html#e343"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example343" style="display: none;">
<p>Here we want a rulebook to determine whether objects float or sink, so we create an object-based rulebook for the purpose. The more specific rules here, pertaining to corks and to inflated things, will be consulted first; then, as a default, the general flotation rule.</p>
<p>We also want a switch that can turn flotation off at will. The rule about the big switch will be observed before the others because the when... clause makes it more specific than the other rules in the flotation rulebook.</p>
<p>If we wanted, we could also put these rules into a rulebook in an explicit order, overriding Inform's automatic sorting by specificity.</p>
<!-- START CODE "c7864_343" -->
<a id="c7864_343"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Flotation[=0x0022=][=0x000A=][=0x000A=]The Pumping House is a room.[=0x000A=][=0x000A=]A well is a fixed in place container in the Pumping House.[=0x000A=][=0x000A=]Instead of examining the well:[=0x000A=][=0x0009=]say [=0x0022=][if something is in the well]On the surface of the water you can see [a list of things in the well][otherwise]There is nothing on the surface of the water, nor can you see into the depths[end if].[=0x0022=][=0x000A=][=0x000A=]The well bottom is a container.[=0x000A=][=0x000A=]The cork, the rubber ring and a lead ingot are in the Pumping House.[=0x000A=][=0x000A=]A big switch is a fixed in place device in the Pumping House. [=0x0022=]A big switch labelled [=0x0027=]MAKE EVERYTHING SINK[=0x0027=] is mounted on one wall[if switched on]. It crackles with electricity[otherwise]. It is currently switched off and silent[end if].[=0x0022=][=0x000A=][=0x000A=]A thing can be inflated or uninflated. A thing is usually uninflated. Before printing the name of an inflated thing: say [=0x0022=]inflated [=0x0022=].[=0x000A=][=0x000A=]The rubber ring is inflated.[=0x000A=][=0x000A=]The flotation rules are an object-based rulebook.[=0x000A=][=0x000A=]A flotation rule for the cork: rule succeeds.[=0x000A=]A flotation rule for an inflated thing: rule succeeds.[=0x000A=]A flotation rule when the big switch is switched on: rule fails.[=0x000A=][=0x000A=]After inserting something into the well:[=0x000A=][=0x0009=]follow the flotation rules for the noun;[=0x000A=][=0x0009=]if the rule succeeded:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][The noun] bobs on the surface.[=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]move the noun to the well bottom;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][The noun] sinks out of sight.[=0x0022=][=0x000A=][=0x000A=]A thing can be sinking, rising, or static. A thing is usually static.[=0x000A=][=0x000A=]Definition: a thing is wet:[=0x000A=][=0x0009=]if it is in the well, yes;[=0x000A=][=0x0009=]if it is in the well bottom, yes;[=0x000A=][=0x0009=]no.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]now every thing is static;[=0x000A=][=0x0009=]repeat with item running through wet things:[=0x000A=][=0x0009=][=0x0009=]follow the flotation rules for the item;[=0x000A=][=0x0009=][=0x0009=]if the rule failed and the item is in the well, now the item is sinking;[=0x000A=][=0x0009=][=0x0009=]if the rule succeeded and the item is in the well bottom, now the item is rising;[=0x000A=][=0x0009=]now every rising thing is in the well;[=0x000A=][=0x0009=]now every sinking thing is in the well bottom;[=0x000A=][=0x0009=]if something is rising, say [=0x0022=][The list of rising things] rise[if the number of rising things is 1]s[end if] to the surface of the well.[=0x0022=];[=0x000A=][=0x0009=]if something is sinking, say [=0x0022=][The list of sinking things] sink[if the number of sinking things is 1]s[end if] out of sight.[=0x0022=][=0x000A=][=0x000A=][And finally a few description rules to make things look prettier:][=0x000A=][=0x000A=]Rule for writing a paragraph about the well when the well contains something:[=0x000A=][=0x0009=]say [=0x0022=]The chief feature of the room is a concrete-sided well in which there float[if the number of things in the well is 1]s[end if] [a list of things in the well].[=0x0022=][=0x000A=][=0x000A=]Rule for writing a paragraph about the well:[=0x000A=][=0x0009=]say [=0x0022=]The chief feature of the room is a concrete-sided well full of water.[=0x0022=][=0x000A=][=0x000A=][As we recall from the chapter on activities, [=0x0022=]writing a paragraph about...[=0x0022=] is an activity; activities are themselves structured as sets of object-based rulebooks. The activity [=0x0022=]writing a paragraph about[=0x0022=] uses three object-based rulebooks (before writing..., for writing..., after writing...). We could have made a flotation activity as well, but in general it is overkill to make an activity to make success/failure decisions. For that purpose an object-based rulebook is sufficient.][=0x000A=][=0x000A=]Test me with [=0x0022=]get all / put cork in well / put ring in well / put ingot in well / x well / get cork / get ring / switch switch on / put cork in well / put ring in well / x well / switch switch off / switch switch on[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Flotation&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7865_343" -->
<a id="c7865_343"></a><blockquote class="code"><p class="quoted">
The Pumping House is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7866_343" -->
<a id="c7866_343"></a><blockquote class="code"><p class="quoted">
A well is a fixed in place container in the Pumping House.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7867_343" -->
<a id="c7867_343"></a><blockquote class="code"><p class="quoted">
Instead of examining the well:
<br />&#160;&#160;&#160;&#160;say &quot;[if something is in the well]On the surface of the water you can see [a list of things in the well][otherwise]There is nothing on the surface of the water, nor can you see into the depths[end if].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7868_343" -->
<a id="c7868_343"></a><blockquote class="code"><p class="quoted">
The well bottom is a container.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7869_343" -->
<a id="c7869_343"></a><blockquote class="code"><p class="quoted">
The cork, the rubber ring and a lead ingot are in the Pumping House.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7870_343" -->
<a id="c7870_343"></a><blockquote class="code"><p class="quoted">
A big switch is a fixed in place device in the Pumping House. &quot;A big switch labelled 'MAKE EVERYTHING SINK' is mounted on one wall[if switched on]. It crackles with electricity[otherwise]. It is currently switched off and silent[end if].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7871_343" -->
<a id="c7871_343"></a><blockquote class="code"><p class="quoted">
A thing can be inflated or uninflated. A thing is usually uninflated. Before printing the name of an inflated thing: say &quot;inflated &quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7872_343" -->
<a id="c7872_343"></a><blockquote class="code"><p class="quoted">
The rubber ring is inflated.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7873_343" -->
<a id="c7873_343"></a><blockquote class="code"><p class="quoted">
The flotation rules are an object-based rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7874_343" -->
<a id="c7874_343"></a><blockquote class="code"><p class="quoted">
A flotation rule for the cork: rule succeeds.
<br />A flotation rule for an inflated thing: rule succeeds.
<br />A flotation rule when the big switch is switched on: rule fails.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7875_343" -->
<a id="c7875_343"></a><blockquote class="code"><p class="quoted">
After inserting something into the well:
<br />&#160;&#160;&#160;&#160;follow the flotation rules for the noun;
<br />&#160;&#160;&#160;&#160;if the rule succeeded:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The noun] bobs on the surface.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the noun to the well bottom;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The noun] sinks out of sight.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7876_343" -->
<a id="c7876_343"></a><blockquote class="code"><p class="quoted">
A thing can be sinking, rising, or static. A thing is usually static.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7877_343" -->
<a id="c7877_343"></a><blockquote class="code"><p class="quoted">
Definition: a thing is wet:
<br />&#160;&#160;&#160;&#160;if it is in the well, yes;
<br />&#160;&#160;&#160;&#160;if it is in the well bottom, yes;
<br />&#160;&#160;&#160;&#160;no.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7878_343" -->
<a id="c7878_343"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;now every thing is static;
<br />&#160;&#160;&#160;&#160;repeat with item running through wet things:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;follow the flotation rules for the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the rule failed and the item is in the well, now the item is sinking;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the rule succeeded and the item is in the well bottom, now the item is rising;
<br />&#160;&#160;&#160;&#160;now every rising thing is in the well;
<br />&#160;&#160;&#160;&#160;now every sinking thing is in the well bottom;
<br />&#160;&#160;&#160;&#160;if something is rising, say &quot;[The list of rising things] rise[if the number of rising things is 1]s[end if] to the surface of the well.&quot;;
<br />&#160;&#160;&#160;&#160;if something is sinking, say &quot;[The list of sinking things] sink[if the number of sinking things is 1]s[end if] out of sight.&quot;
</p></blockquote>
<!-- END CODE -->
<p>And finally a few description rules to make things look prettier:</p>
<!-- START CODE "c7879_343" -->
<a id="c7879_343"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about the well when the well contains something:
<br />&#160;&#160;&#160;&#160;say &quot;The chief feature of the room is a concrete-sided well in which there float[if the number of things in the well is 1]s[end if] [a list of things in the well].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c7880_343" -->
<a id="c7880_343"></a><blockquote class="code"><p class="quoted">
Rule for writing a paragraph about the well:
<br />&#160;&#160;&#160;&#160;say &quot;The chief feature of the room is a concrete-sided well full of water.&quot;
</p></blockquote>
<!-- END CODE -->
<p>As we recall from the chapter on activities, &quot;writing a paragraph about...&quot; is an activity; activities are themselves structured as sets of object-based rulebooks. The activity &quot;writing a paragraph about&quot; uses three object-based rulebooks (before writing..., for writing..., after writing...). We could have made a flotation activity as well, but in general it is overkill to make an activity to make success/failure decisions. For that purpose an object-based rulebook is sufficient.</p>
<!-- START CODE "c7881_343" -->
<a id="c7881_343"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get all / put cork in well / put ring in well / put ingot in well / x well / get cork / get ring / switch switch on / put cork in well / put ring in well / x well / switch switch off / switch switch on&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc334.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc336.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
