<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Variations: arrays, logs, queues, stacks, sets, sieves and rings" -->
<!-- SEARCH SECTION "21.11" -->
<!-- SEARCH SORT "000-021-011-000" -->
<!-- START IGNORE 361 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc361.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 21: Lists</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc363.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</p>
<p>Lists are highly adaptable, and many other collection-like constructions can be made using them. This section introduces no new material, but simply suggests some of the variations which are possible.</p>
<p>1. The traditional computing term <span class="boldface">array</span> means a list of values accessed by their entry numbers, often used in mathematical computations. The difference between an array and a list is mostly one of attitude, but usually arrays are fixed in length whereas lists can expand or contract.</p>
<p>2. A <span class="boldface">log</span> is a list which records the most recently arrived values, but does not allow itself to grow indefinitely. In the following, which remembers the seven most recently taken items, new values arrive at the end while old ones eventually disappear from the front:</p>
<!-- START CODE "c8574" -->
<a id="c8574"></a><blockquote class="code"><p class="quoted">
The most-recently-taken list is a list of objects that varies.
<br />Carry out taking something (called the item):
<br />&#160;&#160;&#160;&#160;truncate the most-recently-taken list to the last 6 entries;
<br />&#160;&#160;&#160;&#160;add the item to the most-recently-taken list.
<br />After taking:
<br />&#160;&#160;&#160;&#160;say &quot;Taken. (So, your recent acquisitions: [most-recently-taken list].)&quot;
</p></blockquote>
<!-- END CODE -->
<p>Note that the most-recently-taken list begins play as the empty list, grows as the first few items are taken, but then stabilises at length 7 thereafter. If we need to remember recent history, but only <span class="italic">recent</span> history, then a log is better than a list which can grow indefinitely, because there is no risk of speed reduction or memory exhaustion in a very long story.</p>
<p>3. A <span class="boldface">queue</span> is a list of values which are waiting for attention. New values join at the back, while those being dealt with are removed from the front (whereupon the whole queue moves up one). An empty queue means that nobody is waiting for attention: but there is, in principle, no upper limit to the size of a queue, as anyone who has tried to make a couchette reservation at Roma Termini will know.</p>
<p>Queues typically form when two independent processes are at work, but going at different or variable speeds. An empty queue looks just like any other list:</p>
<!-- START CODE "c8575" -->
<a id="c8575"></a><blockquote class="code"><p class="quoted">
The queue is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>(Invariably people, in what follows, but we'll make it a &quot;list of objects&quot; to allow for other possibilities too.) Once we identify a &quot;new customer&quot;, we can join him to the queue thus:</p>
<!-- START CODE "c8576" -->
<a id="c8576"></a><blockquote class="code"><p class="quoted">
add the new customer to the queue;
</p></blockquote>
<!-- END CODE -->
<p>The process of serving the customers needs to make sure there is actually somebody waiting in the queue before it does anything:</p>
<!-- START CODE "c8577" -->
<a id="c8577"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the queue is not 0:
<br />&#160;&#160;&#160;&#160;let the next customer be entry 1 of the queue;
<br />&#160;&#160;&#160;&#160;say &quot;[The next customer] is served and leaves.&quot;;
<br />&#160;&#160;&#160;&#160;remove entry 1 from the queue.
</p></blockquote>
<!-- END CODE -->
<p>Of course queues can also be constructed which empty from other positions, rather than the front: or we could make what computer scientists sometimes call a <span class="boldface">deque</span>, a &quot;double-ended queue&quot; where new values arrive at both ends.</p>
<p>4. A <span class="boldface">stack</span> is like a queue except that values arrive at, and are removed from, the same end. Stacks are slightly faster if the active end is the back rather than the front, though this will only be noticeable if they grow quite large.</p>
<p>To put a value V onto a stack S (which is known as &quot;pushing&quot;) is simple:</p>
<!-- START CODE "c8578" -->
<a id="c8578"></a><blockquote class="code"><p class="quoted">
add V to S;
</p></blockquote>
<!-- END CODE -->
<p>And to remove a value from the top of the stack (which is known as &quot;pulling&quot;):</p>
<!-- START CODE "c8579" -->
<a id="c8579"></a><blockquote class="code"><p class="quoted">
let N be the number of entries in S;
<br />let V be entry N of S;
<br />remove entry N from S;
</p></blockquote>
<!-- END CODE -->
<p>Note that the middle line, accessing entry N, will fail if N = 0, that is, if the stack is empty: Inform's list routines will produce a run-time problem message.</p>
<p>Stacks are useful if some long-term process is constantly being interrupted by newer and more urgent demands, but they can also be used in planning. If a character has a long-term goal, which needs various short-term goals to be achieved along the way, then a stack can represent the goals currently being pursued. The top of the stack represents what the character is trying to achieve now. If the character realises that it needs to achieve something else first, we put that new goal onto the top of the stack, and it becomes the new current goal. When the character completes a task, it can be removed, and we can go back to trying to finish whatever is now on top. When the stack is empty, the character has achieved the original goal.</p>
<p>5. Notoriously, <span class="boldface">set</span> has 464 distinct meanings in the Oxford English Dictionary, making it the single most ambiguous word in the language. Here we mean not the home of a badger or the Egyptian god of the desert, but the mathematical sense: a collection of values (sometimes called &quot;elements&quot;) without duplicates, and which is normally written in brace notation and in some natural order for the reader's convenience.</p>
<p>The trick here is to maintain the principle that, at all times, our list is sorted in order and contains no duplicates. To provide an example, we start with two sets of numbers:</p>
<!-- START CODE "c8580" -->
<a id="c8580"></a><blockquote class="code"><p class="quoted">
let S be {2, 4, 8, 16, 32, 64};
<br />let T be {2, 4, 6, 10};
</p></blockquote>
<!-- END CODE -->
<p>Here we add an element to T:</p>
<!-- START CODE "c8581" -->
<a id="c8581"></a><blockquote class="code"><p class="quoted">
add 8 to T, if absent; sort T;
</p></blockquote>
<!-- END CODE -->
<p>The &quot;if absent&quot; clause ensures that no duplicate can occur, and by sorting T afterwards, we maintain the principle that a set must remain in order - so T is now {2, 4, 6, 8, 10}, not {2, 4, 6, 10, 8}. (Inform's sorting algorithm is fast on nearly-sorted lists, so frequent sorting is not as inefficient as it might look.)</p>
<p>We next take the union of T and S, that is, the set containing everything which is in either or both:</p>
<!-- START CODE "c8582" -->
<a id="c8582"></a><blockquote class="code"><p class="quoted">
let U be S; add T to U, if absent; sort U;
</p></blockquote>
<!-- END CODE -->
<p>This makes U = {2, 4, 6, 8, 10, 16, 32, 64}, and once again no duplicates occur and we preserve the sorting. The intersection of T and S, the set of elements in both of them, is a little trickier:</p>
<!-- START CODE "c8583" -->
<a id="c8583"></a><blockquote class="code"><p class="quoted">
let I be T;
<br />repeat with the element running through T:
<br />&#160;&#160;&#160;&#160;if the element is not listed in S, remove the element from I.
</p></blockquote>
<!-- END CODE -->
<p>(Faster methods could be devised which exploit the sortedness of T and S, but are not worth it for shortish lists.) This produces I = {2, 4, 8}. Lastly, we can form the set difference, consisting of those elements which are in S but not in T:</p>
<!-- START CODE "c8584" -->
<a id="c8584"></a><blockquote class="code"><p class="quoted">
let D be S; remove T from D, if present;
</p></blockquote>
<!-- END CODE -->
<p>Here, as with intersection, since all we do is to strike out unwanted elements, the surviving ones remain in order and there is no need to sort when we are finished. This produces D = {16, 32, 64}.</p>
<p>6. A <span class="boldface">sieve</span> is used to make a complicated choice where there are many constraints, by ruling out impossible cases to see what is left. The term derives from the kitchen utensil (for sieving fine grains of flour), but via the name of the &quot;sieve of Eratosthenes&quot;, an ancient Greek method for determining the prime numbers.</p>
<p>Using a sieve is much like using a set, and the difference is mainly one of outlook - we are interested in what does not belong, rather than what does.</p>
<p>7. A <span class="boldface">ring</span> is not so much a row of values, more a circle, with the last and first entries thought of as adjacent. One position is usually thought of as special, and is the place where new items are added: this may as well be entry 1. For instance, to add &quot;new item&quot; to the ring:</p>
<!-- START CODE "c8585" -->
<a id="c8585"></a><blockquote class="code"><p class="quoted">
add the item at entry 1 in the ring;
</p></blockquote>
<!-- END CODE -->
<p>To set &quot;item&quot; to the frontmost value and extract it from the ring:</p>
<!-- START CODE "c8586" -->
<a id="c8586"></a><blockquote class="code"><p class="quoted">
let the item be entry 1 of the ring;
<br />remove entry 1 from the ring;
</p></blockquote>
<!-- END CODE -->
<p>And we can rotate the ring in either direction, making a different entry the new entry 1 and therefore the new frontmost value:</p>
<!-- START CODE "c8587" -->
<a id="c8587"></a><blockquote class="code"><p class="quoted">
rotate the ring;
<br />rotate the ring backwards;
</p></blockquote>
<!-- END CODE -->
<p>A last note to conclude the chapter on lists. Lists, like almost all other values in Inform, can be passed to phrases as parameters. However, note that they are genuine values, not what some programming languages call &quot;references&quot; or &quot;pointers&quot;. So the following:</p>
<!-- START CODE "c8588" -->
<a id="c8588"></a><blockquote class="code"><p class="quoted">
To mess with (L - a list of numbers):
<br />&#160;&#160;&#160;&#160;add 7 to L, if absent.
</p></blockquote>
<!-- END CODE -->
<p>does nothing, in practice. If given a list, it adds 7 to the list, but then throws it away again, so the longer list is never seen; it's exactly like</p>
<!-- START CODE "c8589" -->
<a id="c8589"></a><blockquote class="code"><p class="quoted">
To mess with (N - a number):
<br />&#160;&#160;&#160;&#160;now N is 3.
</p></blockquote>
<!-- END CODE -->
<p>which can never affect anything other than its own temporary value &quot;N&quot;, which expires almost immediately in any case.</p>
<p>If we want a phrase which changes a list in a useful way and gives it back to us, we need a phrase which both takes in and gives back:</p>
<!-- START CODE "c8590" -->
<a id="c8590"></a><blockquote class="code"><p class="quoted">
To decide which list of numbers is the extended (L - a list of numbers):
<br />&#160;&#160;&#160;&#160;add 7 to L, if absent;
<br />&#160;&#160;&#160;&#160;decide on L.
</p></blockquote>
<!-- END CODE -->
<p>And then, for example -</p>
<!-- START CODE "c8591" -->
<a id="c8591"></a><blockquote class="code"><p class="quoted">
the extended { 2, 4, 6 };
</p></blockquote>
<!-- END CODE -->
<p>produces:</p>
<!-- START CODE "c8592" -->
<a id="c8592"></a><blockquote class="code"><p class="quoted">
{ 2, 4, 6, 7 }
</p></blockquote>
<!-- END CODE -->
<p>(This may seem surprising since Inform's built-in phrases to adjust lists, like &quot;add ... to ...&quot;, don't work this way. But those are written using Inform 6 code; see the phrase definitions in the Standard Rules for more.)</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "432: I Didn't Come All The Way From Great Portland Street" "e54" -->
<a id="e54"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example54'); return false;"><b>432</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example54'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">I Didn't Come All The Way From Great Portland Street</span></b></a><br />In this fiendishly difficult puzzle, which may perhaps owe some inspiration to a certain BBC Radio panel game (1967-), a list is used as a set of actions to help enforce the rule that the player must keep going for ten turns without hesitation, repetition, or deviating from the subject on the card.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc42.html#e54"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example54" style="display: none;">
<p>There is very little to this, in fact. The tricky rule to enforce is Repetition: the player is forbidden to repeat any previously tried action. We keep track of this by keeping a set of past actions, which for want of a better term is called the &quot;tally&quot;. All we need to do is:</p>
<!-- START CODE "c8593_54" -->
<a id="c8593_54"></a><blockquote class="code"><p class="quoted">
if the current action is listed in the tally, challenge for &quot;Repetition of [the current action]!&quot;;
<br />otherwise add the current action to the tally.
</p></blockquote>
<!-- END CODE -->
<p>Note that the tally can never contain duplicates, and that when, at the end of the round, we print it out, we sort it first - this makes a more natural-looking sentence. (Sorting a list of actions uses the natural order for actions: compare the sequence on the Actions page of the Index.) The full text, then, is:</p>
<!-- START CODE "c8594_54" -->
<a id="c8594_54"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]I Didn[=0x0027=]t Come All The Way From Great Portland Street[=0x0022=][=0x000A=][=0x000A=]The Paris Theatre is a room. An instrument is a kind of thing. The violin, the tuba, the xylophone and the triangle are instruments. The violin is inside the case. The tuba, the xylophone, the radish, the case, the bust of Nicholas Parsons, the purple felt hat and the triangle are in the Paris Theatre.[=0x000A=][=0x000A=]The Round is a scene. The Round begins when play begins. The Round ends when the turn count is 10.[=0x000A=][=0x000A=]The tally is a list of stored actions that varies.[=0x000A=][=0x000A=]When the Round begins:[=0x000A=][=0x0009=]say [=0x0022=][=0x0027=]And the subject on the card is... musical instruments. Will you carry out for us something to do with that, please, for ten turns starting - now![=0x0027=][=0x0022=][=0x000A=][=0x000A=]When the Round ends:[=0x000A=][=0x0009=]sort the tally;[=0x000A=][=0x0009=]say [=0x0022=]Phweeep![paragraph break][=0x0027=]So, when the whistle goes ten turns are up, you get a point for acting when the whistle blows, and in that round you entertained us by [the tally], and you also get a bonus point for keeping going until the whistle went.[=0x0027=][=0x0022=];[=0x000A=][=0x0009=]end the story finally.[=0x000A=][=0x000A=]To challenge for (infraction - text):[=0x000A=][=0x0009=]say [=0x0022=]Bzzzzt! [=0x0027=]And [one of]Clement Freud[or]Derek Nimmo[or]Kenneth Williams[or]Peter Jones[at random] has challenged.[=0x0027=][paragraph break][=0x0027=][infraction][=0x0027=][paragraph break][=0x0027=]Well, as it[=0x0027=]s your first time playing the game, and the audience was enjoying your contribution so much, I will disallow the challenge, you have [10 minus the turn count] turn[s] left on musical instruments, starting... now![=0x0022=][=0x000A=][=0x000A=]Before doing something:[=0x000A=][=0x0009=]if the current action is listed in the tally, challenge for [=0x0022=]Repetition of [the current action]![=0x0022=] instead;[=0x000A=][=0x0009=]otherwise add the current action to the tally;[=0x000A=][=0x0009=]if waiting, challenge for [=0x0022=]Hesitation![=0x0022=] instead;[=0x000A=][=0x0009=]if not looking and not waiting and the noun is not an instrument and the second noun is not an instrument, challenge for [=0x0022=]Deviation![=0x0022=] instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]look / wait / examine bust / take tuba / get triangle / hit xylophone / get tuba / examine tuba / get violin[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;I Didn't Come All The Way From Great Portland Street&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8595_54" -->
<a id="c8595_54"></a><blockquote class="code"><p class="quoted">
The Paris Theatre is a room. An instrument is a kind of thing. The violin, the tuba, the xylophone and the triangle are instruments. The violin is inside the case. The tuba, the xylophone, the radish, the case, the bust of Nicholas Parsons, the purple felt hat and the triangle are in the Paris Theatre.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8596_54" -->
<a id="c8596_54"></a><blockquote class="code"><p class="quoted">
The Round is a scene. The Round begins when play begins. The Round ends when the turn count is 10.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8597_54" -->
<a id="c8597_54"></a><blockquote class="code"><p class="quoted">
The tally is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8598_54" -->
<a id="c8598_54"></a><blockquote class="code"><p class="quoted">
When the Round begins:
<br />&#160;&#160;&#160;&#160;say &quot;'And the subject on the card is... musical instruments. Will you carry out for us something to do with that, please, for ten turns starting - now!'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8599_54" -->
<a id="c8599_54"></a><blockquote class="code"><p class="quoted">
When the Round ends:
<br />&#160;&#160;&#160;&#160;sort the tally;
<br />&#160;&#160;&#160;&#160;say &quot;Phweeep![paragraph break]'So, when the whistle goes ten turns are up, you get a point for acting when the whistle blows, and in that round you entertained us by [the tally], and you also get a bonus point for keeping going until the whistle went.'&quot;;
<br />&#160;&#160;&#160;&#160;end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8600_54" -->
<a id="c8600_54"></a><blockquote class="code"><p class="quoted">
To challenge for (infraction - text):
<br />&#160;&#160;&#160;&#160;say &quot;Bzzzzt! 'And [one of]Clement Freud[or]Derek Nimmo[or]Kenneth Williams[or]Peter Jones[at random] has challenged.'[paragraph break]'[infraction]'[paragraph break]'Well, as it's your first time playing the game, and the audience was enjoying your contribution so much, I will disallow the challenge, you have [10 minus the turn count] turn[s] left on musical instruments, starting... now!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8601_54" -->
<a id="c8601_54"></a><blockquote class="code"><p class="quoted">
Before doing something:
<br />&#160;&#160;&#160;&#160;if the current action is listed in the tally, challenge for &quot;Repetition of [the current action]!&quot; instead;
<br />&#160;&#160;&#160;&#160;otherwise add the current action to the tally;
<br />&#160;&#160;&#160;&#160;if waiting, challenge for &quot;Hesitation!&quot; instead;
<br />&#160;&#160;&#160;&#160;if not looking and not waiting and the noun is not an instrument and the second noun is not an instrument, challenge for &quot;Deviation!&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8602_54" -->
<a id="c8602_54"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / wait / examine bust / take tuba / get triangle / hit xylophone / get tuba / examine tuba / get violin&quot;.
</p></blockquote>
<!-- END CODE -->
<p>(The Paris Theatre in Lower Regent Street, London, was for many years the home of BBC radio panel games.)</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "433: Lugubrious Pete's Delicatessen" "e83" -->
<a id="e83"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example83'); return false;"><b>433</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example83'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Lugubrious Pete's Delicatessen</span></b></a><br />In this evocation of supermarket deli counter life, a list is used as a queue to keep track of who is waiting to be served.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc62.html#e83"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example83" style="display: none;">
<p>First, to set the scene:</p>
<!-- START CODE "c8603_83" -->
<a id="c8603_83"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Lugubrious Pete[=0x0027=]s Delicatessen[=0x0022=][=0x000A=][=0x000A=]The Supermarket is west of the Delicatessen Counter. Lugubrious Pete is in the Delicatessen. [=0x0022=]Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.[=0x0022=] Alice, Beth, Gemma, Delia, and Eliza are women in the Supermarket.[=0x000A=][=0x000A=]The deli queue is a list of objects that varies.[=0x000A=][=0x000A=][Two processes compete here: one that fills the queue, the other which will empty it. The first process is the one which brings shoppers in to the counter, joining the back of the queue, which is where [=0x0022=]add ... to ...[=0x0022=] puts new entries by default:][=0x000A=][=0x000A=]Every turn when a woman is in the Supermarket and a random chance of 2 in 3 succeeds (this is the customer arriving rule):[=0x000A=][=0x0009=]let the customer be a random woman in the Supermarket;[=0x000A=][=0x0009=]now the customer is in the Delicatessen;[=0x000A=][=0x0009=]if the player is in the Supermarket, say [=0x0022=][The customer] walks into the Delicatessen.[=0x0022=];[=0x000A=][=0x0009=]if the player is in the Delicatessen, say [=0x0022=][The customer] comes in from the Supermarket, and [if the number of entries in the deli queue is 0]can[=0x0027=]t believe her luck. The counter is free![otherwise]resignedly queues behind [the deli queue].[=0x0022=];[=0x000A=][=0x0009=]add the customer to the deli queue.[=0x000A=][=0x000A=][The competing process is the one which serves shoppers and thus gets rid of them again: unfortunately, it is slower. But Pete is fair if inefficient, and serves the customers in strict order of arrival. Each served customer is removed from the front of the list, and the others therefore all move up a place.][=0x000A=][=0x000A=]Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):[=0x000A=][=0x0009=]let the customer be entry 1 of the deli queue;[=0x000A=][=0x0009=]if the player is in the Delicatessen, say [=0x0022=]Pete gives a droopy expression as he serves [customer], who nevertheless brightens and leaves.[=0x0022=];[=0x000A=][=0x0009=]if the player is in the Supermarket, say [=0x0022=][customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.[=0x0022=];[=0x000A=][=0x0009=]now the customer is in the Supermarket;[=0x000A=][=0x0009=]remove entry 1 from the deli queue.[=0x000A=][=0x000A=]Instead of waiting in the Delicatessen when the number of entries in the deli queue is not 0, say [=0x0022=]Time passes, for [deli queue] quite as much as for yourself.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]wait / wait / wait / east / wait / wait / wait / wait / wait[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Lugubrious Pete's Delicatessen&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8604_83" -->
<a id="c8604_83"></a><blockquote class="code"><p class="quoted">
The Supermarket is west of the Delicatessen Counter. Lugubrious Pete is in the Delicatessen. &quot;Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.&quot; Alice, Beth, Gemma, Delia, and Eliza are women in the Supermarket.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8605_83" -->
<a id="c8605_83"></a><blockquote class="code"><p class="quoted">
The deli queue is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>Two processes compete here: one that fills the queue, the other which will empty it. The first process is the one which brings shoppers in to the counter, joining the back of the queue, which is where &quot;add ... to ...&quot; puts new entries by default:</p>
<!-- START CODE "c8606_83" -->
<a id="c8606_83"></a><blockquote class="code"><p class="quoted">
Every turn when a woman is in the Supermarket and a random chance of 2 in 3 succeeds (this is the customer arriving rule):
<br />&#160;&#160;&#160;&#160;let the customer be a random woman in the Supermarket;
<br />&#160;&#160;&#160;&#160;now the customer is in the Delicatessen;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[The customer] walks into the Delicatessen.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;[The customer] comes in from the Supermarket, and [if the number of entries in the deli queue is 0]can't believe her luck. The counter is free![otherwise]resignedly queues behind [the deli queue].&quot;;
<br />&#160;&#160;&#160;&#160;add the customer to the deli queue.
</p></blockquote>
<!-- END CODE -->
<p>The competing process is the one which serves shoppers and thus gets rid of them again: unfortunately, it is slower. But Pete is fair if inefficient, and serves the customers in strict order of arrival. Each served customer is removed from the front of the list, and the others therefore all move up a place.</p>
<!-- START CODE "c8607_83" -->
<a id="c8607_83"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):
<br />&#160;&#160;&#160;&#160;let the customer be entry 1 of the deli queue;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;Pete gives a droopy expression as he serves [customer], who nevertheless brightens and leaves.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;
<br />&#160;&#160;&#160;&#160;now the customer is in the Supermarket;
<br />&#160;&#160;&#160;&#160;remove entry 1 from the deli queue.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8608_83" -->
<a id="c8608_83"></a><blockquote class="code"><p class="quoted">
Instead of waiting in the Delicatessen when the number of entries in the deli queue is not 0, say &quot;Time passes, for [deli queue] quite as much as for yourself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8609_83" -->
<a id="c8609_83"></a><blockquote class="code"><p class="quoted">
Test me with &quot;wait / wait / wait / east / wait / wait / wait / wait / wait&quot;.
</p></blockquote>
<!-- END CODE -->
<p>That completes the example, but here is a variation to show that queues need not empty from the front. The Deli already looks a pretty sexist establishment, with the customers all being women, but it is about to get a whole lot worse:</p>
<!-- START CODE "c8610_83" -->
<a id="c8610_83"></a><blockquote class="code"><p class="quoted">
Modesty is a kind of value. The modesties are positively prim, buttoned up, modest, flirty, revealing and downright immodest. Every woman has a modesty. Alice is positively prim. Beth is downright immodest. Gemma is modest. Delia is flirty. Eliza is revealing.
</p></blockquote>
<!-- END CODE -->
<p>We could then rewrite the service rule like so:</p>
<!-- START CODE "c8611_83" -->
<a id="c8611_83"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):
<br />&#160;&#160;&#160;&#160;let Pete's preference be the deli queue;
<br />&#160;&#160;&#160;&#160;sort Pete's preference in reverse modesty order;
<br />&#160;&#160;&#160;&#160;let the customer be entry 1 of Pete's preference;
<br />&#160;&#160;&#160;&#160;let the first in line be entry 1 of the deli queue;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;[if the customer is the first in line]Pete gives a droopy expression as he serves [the customer], who nevertheless brightens and leaves.[otherwise]Outrageously, Pete scans the queue, notices [the customer] in her [modesty of the customer] clothes, and serves her next, while [the first in line] glares at him.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[The customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;
<br />&#160;&#160;&#160;&#160;now the customer is in the Supermarket;
<br />&#160;&#160;&#160;&#160;remove the customer from the deli queue.
</p></blockquote>
<!-- END CODE -->
<p>It is now heartbreakingly difficult for Alice to obtain her sliced chorizo sausage.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "434: Your Mother Doesn't Work Here" "e149" -->
<a id="e149"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example149'); return false;"><b>434</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example149'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Your Mother Doesn't Work Here</span></b></a><br />Your hard-working mother uses a list as a stack: urgent tasks are added to the end of the list, interrupting longer-term plans.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc58.html#e149"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example149" style="display: none;">
<p>Suppose the player's mother is supposed to be cleaning the living room, but she can be interrupted by the need to pick up things the player has dropped. New tasks are added to the end of her &quot;current plan&quot; list; every turn, she attempts to do whatever is the last entry on that list.</p>
<!-- START CODE "c8612_149" -->
<a id="c8612_149"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Your Mother Doesn[=0x0027=]t Work Here[=0x0022=][=0x000A=][=0x000A=]A person has a list of stored actions called the current plan.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]repeat with culprit running through people who are not the player:[=0x000A=][=0x0009=][=0x0009=]if the number of entries in current plan of the culprit is greater than 0:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]let N be the number of entries in the current plan of the culprit;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]try entry N of the current plan of the culprit;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]remove entry N from the current plan of the culprit.[=0x000A=][=0x000A=]The Living Room is a room. It contains a somewhat muddy Persian rug. Your mother is a woman in the Living Room.[=0x000A=][=0x000A=]West of the Living Room is the Kitchen.[=0x000A=][=0x000A=]Instead of your mother rubbing the rug:[=0x000A=][=0x0009=]say [=0x0022=]Your mother scrubs the stained areas of the rug, muttering to herself.[=0x0022=][=0x000A=][=0x000A=]Instead of taking something:[=0x000A=][=0x0009=]say [=0x0022=]Nah, Mom[=0x0027=]ll get that.[=0x0022=][=0x000A=][=0x000A=]Report your mother taking something:[=0x000A=][=0x0009=]say [=0x0022=]Your mother picks up [the noun][one of], sighing deeply[or], jaw tight[or], with assorted comments on your manners[or]; to judge from her comments, she is also indulging in a pleasant fantasy about Swiss boarding schools[stopping].[=0x0022=] instead.[=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]add mother going west to the current plan of mother;[=0x000A=][=0x0009=]add mother rubbing the rug to the current plan of mother.[=0x000A=][=0x000A=]Every turn:[=0x000A=][=0x0009=]if mother is not in the Living Room, end the story finally.[=0x000A=][=0x000A=]Carry out dropping something:[=0x000A=][=0x0009=]add mother taking the noun to the current plan of mother.[=0x000A=][=0x000A=]The player carries some dirty socks, some dirty shoes, a dirty hat, a pair of dirty trousers, and a backpack.[=0x000A=][=0x000A=]Test me with [=0x0022=]drop socks / z / drop shoes / drop hat / drop all / z / z[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a>  &quot;Your Mother Doesn't Work Here&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8613_149" -->
<a id="c8613_149"></a><blockquote class="code"><p class="quoted">
A person has a list of stored actions called the current plan.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8614_149" -->
<a id="c8614_149"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;repeat with culprit running through people who are not the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the number of entries in current plan of the culprit is greater than 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let N be the number of entries in the current plan of the culprit;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try entry N of the current plan of the culprit;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;remove entry N from the current plan of the culprit.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8615_149" -->
<a id="c8615_149"></a><blockquote class="code"><p class="quoted">
The Living Room is a room. It contains a somewhat muddy Persian rug. Your mother is a woman in the Living Room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8616_149" -->
<a id="c8616_149"></a><blockquote class="code"><p class="quoted">
West of the Living Room is the Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8617_149" -->
<a id="c8617_149"></a><blockquote class="code"><p class="quoted">
Instead of your mother rubbing the rug:
<br />&#160;&#160;&#160;&#160;say &quot;Your mother scrubs the stained areas of the rug, muttering to herself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8618_149" -->
<a id="c8618_149"></a><blockquote class="code"><p class="quoted">
Instead of taking something:
<br />&#160;&#160;&#160;&#160;say &quot;Nah, Mom'll get that.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8619_149" -->
<a id="c8619_149"></a><blockquote class="code"><p class="quoted">
Report your mother taking something:
<br />&#160;&#160;&#160;&#160;say &quot;Your mother picks up [the noun][one of], sighing deeply[or], jaw tight[or], with assorted comments on your manners[or]; to judge from her comments, she is also indulging in a pleasant fantasy about Swiss boarding schools[stopping].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8620_149" -->
<a id="c8620_149"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;add mother going west to the current plan of mother;
<br />&#160;&#160;&#160;&#160;add mother rubbing the rug to the current plan of mother.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8621_149" -->
<a id="c8621_149"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;if mother is not in the Living Room, end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8622_149" -->
<a id="c8622_149"></a><blockquote class="code"><p class="quoted">
Carry out dropping something:
<br />&#160;&#160;&#160;&#160;add mother taking the noun to the current plan of mother.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8623_149" -->
<a id="c8623_149"></a><blockquote class="code"><p class="quoted">
The player carries some dirty socks, some dirty shoes, a dirty hat, a pair of dirty trousers, and a backpack.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8624_149" -->
<a id="c8624_149"></a><blockquote class="code"><p class="quoted">
Test me with &quot;drop socks / z / drop shoes / drop hat / drop all / z / z&quot;.
</p></blockquote>
<!-- END CODE -->
<p>As goal-seeking goes, this is fairly rudimentary; &quot;Boston Cream&quot; provides an alternative (and slightly more sophisticated approach), but for really complex goal-seeking characters, it is probably best to turn to the character extensions designed for Inform.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "435: Eyes, Fingers, Toes" "e235" -->
<a id="e235"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example235'); return false;"><b>435</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example235'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Eyes, Fingers, Toes</span></b></a><br />A safe with a multi-number combination, meant to be dialed over multiple turns, is implemented using a log of the last three numbers dialed. The log can then be compared to the safe's correct combination.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc69.html#e235"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example235" style="display: none;">
<p>It is not difficult to implement a safe which can be set to a single number to open; but a more common scenario in the real world is for the safe to open on a sequence of numbers when they have been dialed in the right order.</p>
<p>For IF, this means that we have to keep running track of the last N digits the player has dialed, dropping the first digit and adding a new one to the end each time the player re-dials the safe. This is a perfect occasion for lists:</p>
<!-- START CODE "c8625_235" -->
<a id="c8625_235"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Eyes, Fingers, Toes[=0x0022=][=0x000A=][=0x000A=]The Addams Wine Cellar is a room. It contains a closed lockable locked container called a safe.[=0x000A=][=0x000A=]The safe has a list of numbers called the current combination.[=0x000A=][=0x000A=]The safe has a list of numbers called the true combination. The true combination of the safe is {2, 10, 11}.[=0x000A=][=0x000A=]Understand [=0x0022=]set [something] to [a number][=0x0022=] as setting it numerically to. Setting it numerically to is an action applying to one thing and one number.[=0x000A=][=0x000A=]Instead of examining the safe:[=0x000A=][=0x0009=]if the number of entries in the current combination of the safe is 0,[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You haven[=0x0027=]t dialed the safe to any combination yet.[=0x0022=];[=0x000A=][=0x0009=]otherwise say [=0x0022=]You have dialed the safe to [the current combination of the safe].[=0x0022=].[=0x000A=][=0x000A=]Check setting something numerically to (this is the block setting numerically rule):[=0x000A=][=0x0009=]say [=0x0022=][The noun] cannot be set.[=0x0022=][=0x000A=][=0x000A=]Instead of setting the safe numerically to the number understood:[=0x000A=][=0x0009=]truncate the current combination of the safe to the last 2 entries;[=0x000A=][=0x0009=]add the number understood to the current combination of the safe;[=0x000A=][=0x0009=]if the safe is locked and the current combination of the safe is the true combination of the safe:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You dial [the number understood], and [the safe] gives a joyous CLICK.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]now the safe is unlocked;[=0x000A=][=0x0009=]otherwise if safe is unlocked and the safe is closed and the current combination of the safe is not the true combination of the safe:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You spin the dial, and [the safe] snicks locked.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]now the safe is locked;[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]You dial [the number understood] on the safe.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]x safe / set safe to 10 / x safe / set safe to 29 / x safe / set safe to 2 / x safe / set safe to 10 / x safe / set safe to 11 / open safe / set safe to 14 / close safe / set safe to 15 / open safe[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Eyes, Fingers, Toes&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8626_235" -->
<a id="c8626_235"></a><blockquote class="code"><p class="quoted">
The Addams Wine Cellar is a room. It contains a closed lockable locked container called a safe.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8627_235" -->
<a id="c8627_235"></a><blockquote class="code"><p class="quoted">
The safe has a list of numbers called the current combination.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8628_235" -->
<a id="c8628_235"></a><blockquote class="code"><p class="quoted">
The safe has a list of numbers called the true combination. The true combination of the safe is {2, 10, 11}.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8629_235" -->
<a id="c8629_235"></a><blockquote class="code"><p class="quoted">
Understand &quot;set [something] to [a number]&quot; as setting it numerically to. Setting it numerically to is an action applying to one thing and one number.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8630_235" -->
<a id="c8630_235"></a><blockquote class="code"><p class="quoted">
Instead of examining the safe:
<br />&#160;&#160;&#160;&#160;if the number of entries in the current combination of the safe is 0,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You haven't dialed the safe to any combination yet.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;You have dialed the safe to [the current combination of the safe].&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8631_235" -->
<a id="c8631_235"></a><blockquote class="code"><p class="quoted">
Check setting something numerically to (this is the block setting numerically rule):
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] cannot be set.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8632_235" -->
<a id="c8632_235"></a><blockquote class="code"><p class="quoted">
Instead of setting the safe numerically to the number understood:
<br />&#160;&#160;&#160;&#160;truncate the current combination of the safe to the last 2 entries;
<br />&#160;&#160;&#160;&#160;add the number understood to the current combination of the safe;
<br />&#160;&#160;&#160;&#160;if the safe is locked and the current combination of the safe is the true combination of the safe:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You dial [the number understood], and [the safe] gives a joyous CLICK.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the safe is unlocked;
<br />&#160;&#160;&#160;&#160;otherwise if safe is unlocked and the safe is closed and the current combination of the safe is not the true combination of the safe:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You spin the dial, and [the safe] snicks locked.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the safe is locked;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You dial [the number understood] on the safe.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8633_235" -->
<a id="c8633_235"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x safe / set safe to 10 / x safe / set safe to 29 / x safe / set safe to 2 / x safe / set safe to 10 / x safe / set safe to 11 / open safe / set safe to 14 / close safe / set safe to 15 / open safe&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "436: Circle of Misery" "e358" -->
<a id="e358"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example358'); return false;"><b>436</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example358'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Circle of Misery</span></b></a><br />Retrieving items from an airport luggage carousel is such fun, how can we resist simulating it, using a list as a ring buffer?</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc66.html#e358"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example358" style="display: none;">
<p>The only point we need to be careful about is that the carousel is simulated twice over, in the following text: once in the built-in way that objects are inside other objects, so that the luggage items are objects contained in the carousel object; but then again by the &quot;circle of misery&quot; list, a ring buffer keeping track of what order things are in. We need to be careful that these two records do not fall out of synchrony: anything put into the carousel must be added to the list, anything taken out must be removed. (In fact we forbid things to be added, for simplicity's sake.)</p>
<!-- START CODE "c8634_358" -->
<a id="c8634_358"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Circle Of Misery[=0x0022=][=0x000A=][=0x000A=]Luggage item is a kind of thing. The blue golf bag, the leopardskin suitcase, the green rucksack and the Lufthansa shoulder-bag are luggage items.[=0x000A=][=0x000A=]Heathrow Baggage Claim is a room. The carousel is a container in Heathrow. [=0x0022=]The luggage carousel, a scaly rubbered ring, does for the roundabout what Heathrow Airport does for the dream of flight: that is, turns the purest magic into the essence of boredom, only with extra stress. [if the number of entries in the circle of misery is 0]For once it stands idle. Perhaps it[=0x0027=]s broken.[otherwise]The baggage approaching you now: [the circle of misery with indefinite articles].[=0x0022=][=0x000A=][=0x000A=]The circle of misery is a list of objects that varies.[=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]now all the luggage items are in the carousel;[=0x000A=][=0x0009=]add the list of luggage items to the circle of misery.[=0x000A=][=0x000A=][The list [=0x0022=]circle of misery[=0x0022=] is our ring, in which entry 1 is considered to be the position of whichever bag is currently frontmost. And here it goes, round and round:][=0x000A=][=0x000A=]Every turn when the number of entries in the circle of misery is not 0:[=0x000A=][=0x0009=]rotate the circle of misery;[=0x000A=][=0x0009=]let the bag be entry 1 of the circle of misery;[=0x000A=][=0x0009=]say [=0x0022=]The carousel trundles on, bringing [a bag] to within reach.[=0x0022=][=0x000A=][=0x000A=]After taking a luggage item (called the bag):[=0x000A=][=0x0009=]remove the bag from the circle of misery, if present;[=0x000A=][=0x0009=]say [=0x0022=]Taken.[=0x0022=][=0x000A=][=0x000A=]Before doing something with a luggage item (called the bag) which is in the carousel:[=0x000A=][=0x0009=]if the bag is not entry 1 of the circle of misery, say [=0x0022=][The bag] is maddeningly out of range. You[=0x0027=]ll have to wait for it to come round.[=0x0022=] instead.[=0x000A=][=0x000A=]Instead of inserting something into the carousel, say [=0x0022=]In recent years, the authorities have tended to frown upon depositing bags in random places at airports.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]get suitcase / get suitcase / get suitcase / get suitcase / look / get golf bag / look / get golf bag[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Circle Of Misery&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8635_358" -->
<a id="c8635_358"></a><blockquote class="code"><p class="quoted">
Luggage item is a kind of thing. The blue golf bag, the leopardskin suitcase, the green rucksack and the Lufthansa shoulder-bag are luggage items.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8636_358" -->
<a id="c8636_358"></a><blockquote class="code"><p class="quoted">
Heathrow Baggage Claim is a room. The carousel is a container in Heathrow. &quot;The luggage carousel, a scaly rubbered ring, does for the roundabout what Heathrow Airport does for the dream of flight: that is, turns the purest magic into the essence of boredom, only with extra stress. [if the number of entries in the circle of misery is 0]For once it stands idle. Perhaps it's broken.[otherwise]The baggage approaching you now: [the circle of misery with indefinite articles].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8637_358" -->
<a id="c8637_358"></a><blockquote class="code"><p class="quoted">
The circle of misery is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8638_358" -->
<a id="c8638_358"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;now all the luggage items are in the carousel;
<br />&#160;&#160;&#160;&#160;add the list of luggage items to the circle of misery.
</p></blockquote>
<!-- END CODE -->
<p>The list &quot;circle of misery&quot; is our ring, in which entry 1 is considered to be the position of whichever bag is currently frontmost. And here it goes, round and round:</p>
<!-- START CODE "c8639_358" -->
<a id="c8639_358"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the circle of misery is not 0:
<br />&#160;&#160;&#160;&#160;rotate the circle of misery;
<br />&#160;&#160;&#160;&#160;let the bag be entry 1 of the circle of misery;
<br />&#160;&#160;&#160;&#160;say &quot;The carousel trundles on, bringing [a bag] to within reach.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8640_358" -->
<a id="c8640_358"></a><blockquote class="code"><p class="quoted">
After taking a luggage item (called the bag):
<br />&#160;&#160;&#160;&#160;remove the bag from the circle of misery, if present;
<br />&#160;&#160;&#160;&#160;say &quot;Taken.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8641_358" -->
<a id="c8641_358"></a><blockquote class="code"><p class="quoted">
Before doing something with a luggage item (called the bag) which is in the carousel:
<br />&#160;&#160;&#160;&#160;if the bag is not entry 1 of the circle of misery, say &quot;[The bag] is maddeningly out of range. You'll have to wait for it to come round.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8642_358" -->
<a id="c8642_358"></a><blockquote class="code"><p class="quoted">
Instead of inserting something into the carousel, say &quot;In recent years, the authorities have tended to frown upon depositing bags in random places at airports.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8643_358" -->
<a id="c8643_358"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get suitcase / get suitcase / get suitcase / get suitcase / look / get golf bag / look / get golf bag&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "437: The Fibonacci Sequence" "e383" -->
<a id="e383"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example383'); return false;"><b>437</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example383'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Fibonacci Sequence</span></b></a><br />The modest Leonardo Fibonacci of Pisa will be only too happy to construct his sequence on request, using an array.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc90.html#e383"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example383" style="display: none;">
<p>Fibonacci (a posthumous nickname) spread Arabic mathematical learning across Europe in the 13th century, and it's curious that his name lives on only for a single sequence.</p>
<!-- START CODE "c8644_383" -->
<a id="c8644_383"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]The Fibonacci Sequence[=0x0022=][=0x000A=][=0x000A=]Pisa is a room. Leonardo Fibonacci is a man in Pisa. [=0x0022=]The modest Italian mathematician, Leonardo Fibonacci (1170-1250), beams at you.[=0x0022=][=0x000A=][=0x000A=]Sequencing is an action applying to one number. Understand [=0x0022=]sequence [number][=0x0022=] as sequencing.[=0x000A=][=0x000A=]Instead of sequencing, say [=0x0022=]You make a feeble attempt, sketching in the sand, but it goes nowhere. Leonardo is sympathetic. [=0x0027=]Often goes wrong for me, too, actually. I didn[=0x0027=]t even invent the thing - the ancient Indians knew about it first.[=0x0027=][=0x0022=][=0x000A=][=0x000A=]Persuasion rule for asking Leonardo to try sequencing: persuasion succeeds.[=0x000A=][=0x000A=]Report Leonardo sequencing:[=0x000A=][=0x0009=]let N be the number understood;[=0x000A=][=0x0009=]say [=0x0022=]Leonardo scratches his head and makes self-deprecating remarks, before coming up with [the first N terms of the Fibonacci sequence].[=0x0022=][=0x000A=][=0x000A=][ An array need not be fixed in length, as the following example shows:][=0x000A=][=0x000A=]To decide what list of numbers is the first (F - a number) terms of the Fibonacci sequence:[=0x000A=][=0x0009=]let the Fibonacci sequence be {1, 1};[=0x000A=][=0x0009=]let N be 3;[=0x000A=][=0x0009=]while N [=0x003C=] F:[=0x000A=][=0x0009=][=0x0009=]let the last term be entry (N - 1) of the Fibonacci sequence;[=0x000A=][=0x0009=][=0x0009=]let the penultimate term be entry (N - 2) of the Fibonacci sequence;[=0x000A=][=0x0009=][=0x0009=]let the next term be the last term plus the penultimate term;[=0x000A=][=0x0009=][=0x0009=]add the next term to the Fibonacci sequence;[=0x000A=][=0x0009=][=0x0009=]increment N;[=0x000A=][=0x0009=]decide on the Fibonacci sequence.[=0x000A=][=0x000A=]Test me with [=0x0022=]sequence 20 / leonardo, sequence 20[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;The Fibonacci Sequence&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8645_383" -->
<a id="c8645_383"></a><blockquote class="code"><p class="quoted">
Pisa is a room. Leonardo Fibonacci is a man in Pisa. &quot;The modest Italian mathematician, Leonardo Fibonacci (1170-1250), beams at you.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8646_383" -->
<a id="c8646_383"></a><blockquote class="code"><p class="quoted">
Sequencing is an action applying to one number. Understand &quot;sequence [number]&quot; as sequencing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8647_383" -->
<a id="c8647_383"></a><blockquote class="code"><p class="quoted">
Instead of sequencing, say &quot;You make a feeble attempt, sketching in the sand, but it goes nowhere. Leonardo is sympathetic. 'Often goes wrong for me, too, actually. I didn't even invent the thing - the ancient Indians knew about it first.'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8648_383" -->
<a id="c8648_383"></a><blockquote class="code"><p class="quoted">
Persuasion rule for asking Leonardo to try sequencing: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8649_383" -->
<a id="c8649_383"></a><blockquote class="code"><p class="quoted">
Report Leonardo sequencing:
<br />&#160;&#160;&#160;&#160;let N be the number understood;
<br />&#160;&#160;&#160;&#160;say &quot;Leonardo scratches his head and makes self-deprecating remarks, before coming up with [the first N terms of the Fibonacci sequence].&quot;
</p></blockquote>
<!-- END CODE -->
<p> An array need not be fixed in length, as the following example shows:</p>
<!-- START CODE "c8650_383" -->
<a id="c8650_383"></a><blockquote class="code"><p class="quoted">
To decide what list of numbers is the first (F - a number) terms of the Fibonacci sequence:
<br />&#160;&#160;&#160;&#160;let the Fibonacci sequence be {1, 1};
<br />&#160;&#160;&#160;&#160;let N be 3;
<br />&#160;&#160;&#160;&#160;while N &lt; F:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the last term be entry (N - 1) of the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the penultimate term be entry (N - 2) of the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the next term be the last term plus the penultimate term;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the next term to the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment N;
<br />&#160;&#160;&#160;&#160;decide on the Fibonacci sequence.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8651_383" -->
<a id="c8651_383"></a><blockquote class="code"><p class="quoted">
Test me with &quot;sequence 20 / leonardo, sequence 20&quot;.
</p></blockquote>
<!-- END CODE -->
<p>The result of &quot;the first 20 terms of the Fibonacci sequence&quot; is &quot;1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584 and 4181&quot;. This is a sequence which has a knack of turning up in odd places - it was found in the 1970s to be related to the rings of florets in a sunflower, for instance - and here it is in a book about interactive fiction.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "438: Sieve of Eratosthenes" "e422" -->
<a id="e422"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example422'); return false;"><b>438</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example422'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Sieve of Eratosthenes</span></b></a><br />The haughty Eratosthenes of Cyrene will nevertheless consent to sieve prime numbers on request.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc90.html#e422"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example422" style="display: none;">
<p>In the words of Wikipedia: &quot;Eratosthenes of Cyrene (Greek Eฯฮฑฯฮฟฯฮธฮญฮฝฮทฯ; 276 BC-194 BC) was a Greek mathematician, poet, athlete, geographer and astronomer.&quot; In the words of Tom Lehrer: &quot;It's people like that who make you realise how little you've achieved in life.&quot;</p>
<p>A prime number is a number greater than 1 which is not a multiple of anything, so we can find the primes by starting with all the numbers and sieving out all the multiples of 2, then all the multiples of 3, and so on. Here we make our sieve of the unacceptable numbers (the &quot;composite&quot; or non-prime ones) first, then form a list of all the numbers, then sieve out the composites: what are left must be the primes.</p>
<!-- START CODE "c8652_422" -->
<a id="c8652_422"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Sieve of Eratosthenes[=0x0022=][=0x000A=][=0x000A=]Alexandria is a room. Eratosthenes is a man in Alexandria. [=0x0022=]The haughty Greek mathematician, Eratosthenes, glowers at you.[=0x0022=][=0x000A=][=0x000A=]Sieving is an action applying to one number. Understand [=0x0022=]sieve [number][=0x0022=] as sieving.[=0x000A=][=0x000A=]Instead of sieving, say [=0x0022=]You make a feeble attempt, sketching in the sand, but it goes nowhere. Eratosthenes smirks. [=0x0027=]I expect your friends call you gamma, then?[=0x0027=][=0x0022=][=0x000A=][=0x000A=]Persuasion rule for asking Eratosthenes to try sieving: persuasion succeeds.[=0x000A=][=0x000A=]Report Eratosthenes sieving:[=0x000A=][=0x0009=]let N be the number understood;[=0x000A=][=0x0009=]let the composites be a list of numbers;[=0x000A=][=0x0009=]let I be 2;[=0x000A=][=0x0009=]while I times I is at most N:[=0x000A=][=0x0009=][=0x0009=]if I is not listed in the composites:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]let J be I times 2;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]while J is at most N:[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]add J to the composites, if absent;[=0x000A=][=0x0009=][=0x0009=][=0x0009=][=0x0009=]increase J by I;[=0x000A=][=0x0009=][=0x0009=]increment I;[=0x000A=][=0x0009=]sort the composites;[=0x000A=][=0x0009=]let the primes be a list of numbers;[=0x000A=][=0x0009=]repeat with P running from 2 to N:[=0x000A=][=0x0009=][=0x0009=]add P to the primes;[=0x000A=][=0x0009=]remove the composites from the primes;[=0x000A=][=0x0009=]say [=0x0022=]Eratosthenes sketches lines in the sand with the air of much practice. [=0x0027=]The primes up to [N] are [the primes]. The composites are [the composites].[=0x0027=][=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]sieve 10 / eratosthenes, sieve 100[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Sieve of Eratosthenes&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8653_422" -->
<a id="c8653_422"></a><blockquote class="code"><p class="quoted">
Alexandria is a room. Eratosthenes is a man in Alexandria. &quot;The haughty Greek mathematician, Eratosthenes, glowers at you.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8654_422" -->
<a id="c8654_422"></a><blockquote class="code"><p class="quoted">
Sieving is an action applying to one number. Understand &quot;sieve [number]&quot; as sieving.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8655_422" -->
<a id="c8655_422"></a><blockquote class="code"><p class="quoted">
Instead of sieving, say &quot;You make a feeble attempt, sketching in the sand, but it goes nowhere. Eratosthenes smirks. 'I expect your friends call you gamma, then?'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8656_422" -->
<a id="c8656_422"></a><blockquote class="code"><p class="quoted">
Persuasion rule for asking Eratosthenes to try sieving: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8657_422" -->
<a id="c8657_422"></a><blockquote class="code"><p class="quoted">
Report Eratosthenes sieving:
<br />&#160;&#160;&#160;&#160;let N be the number understood;
<br />&#160;&#160;&#160;&#160;let the composites be a list of numbers;
<br />&#160;&#160;&#160;&#160;let I be 2;
<br />&#160;&#160;&#160;&#160;while I times I is at most N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if I is not listed in the composites:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let J be I times 2;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while J is at most N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add J to the composites, if absent;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increase J by I;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment I;
<br />&#160;&#160;&#160;&#160;sort the composites;
<br />&#160;&#160;&#160;&#160;let the primes be a list of numbers;
<br />&#160;&#160;&#160;&#160;repeat with P running from 2 to N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add P to the primes;
<br />&#160;&#160;&#160;&#160;remove the composites from the primes;
<br />&#160;&#160;&#160;&#160;say &quot;Eratosthenes sketches lines in the sand with the air of much practice. 'The primes up to [N] are [the primes]. The composites are [the composites].'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8658_422" -->
<a id="c8658_422"></a><blockquote class="code"><p class="quoted">
Test me with &quot;sieve 10 / eratosthenes, sieve 100&quot;.
</p></blockquote>
<!-- END CODE -->
<p>While this could all be done more efficiently with an array, that's only because what we are sieving are numbers: sieving is a technique which can be used for non-numerical decisions, too.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc361.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc363.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
