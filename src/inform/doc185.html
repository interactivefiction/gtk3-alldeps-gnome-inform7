<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>12.9. Check, carry out, report</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Check, carry out, report" -->
<!-- SEARCH SECTION "12.9" -->
<!-- SEARCH SORT "000-012-009-000" -->
<!-- START IGNORE 184 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc184.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 12: Advanced Actions</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc186.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง12.9. Check, carry out, report</p>
<p>The normal behaviour of an action is specified by its three associated rulebooks - check, carry out and report. In the case of our &quot;photographing&quot; example, these rulebooks will be:</p>
<!-- START CODE "c3291" -->
<a id="c3291"></a><blockquote class="code"><p class="quoted">
<span class="boldface">Check photographing</span>. Here, for instance, we need to verify that the player has the camera. If any of our checks fail, we should say why and stop the action. If they succeed, we say nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3292" -->
<a id="c3292"></a><blockquote class="code"><p class="quoted">
<span class="boldface">Carry out photographing</span>. At this stage no further checking is needed (or allowed): the action now definitively takes place. At this point we might, for instance, deduct one from the number of exposures left on the film in the camera, or award the player points for capturing something interesting for posterity. But we should say nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3293" -->
<a id="c3293"></a><blockquote class="code"><p class="quoted">
<span class="boldface">Report photographing</span>. At this stage no further activity is needed (or allowed): whatever effect the action had, it has happened and is now over. All we can do is to say what has taken place.
</p></blockquote>
<!-- END CODE -->
<p>So far we have not really gone into the business of what rulebooks are, and we don't do so here either - suffice to say that we can now create whatever rules we need:</p>
<!-- START CODE "c3294" -->
<a id="c3294"></a><blockquote class="code"><p class="quoted">
A check photographing rule:
<br />&#160;&#160;&#160;&#160;if the camera is not carried:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can hardly photograph without a camera, now can you?&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>In fact, writing &quot;a check photographing rule&quot; is over-formal. We can more simply label our rules like so:</p>
<!-- START CODE "c3295" -->
<a id="c3295"></a><blockquote class="code"><p class="quoted">
Check photographing:
<br />&#160;&#160;&#160;&#160;if we have photographed the noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You've already snapped [the noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3296" -->
<a id="c3296"></a><blockquote class="code"><p class="quoted">
Report photographing: say &quot;Click!&quot;
</p></blockquote>
<!-- END CODE -->
<p>For the sake of brevity, photography has no interesting consequence (no points to be won, no film to use up), so there are no carry out rules here. Note the way we used the word &quot;instead&quot; once again to stop actions in their tracks.</p>
<p>We can continue to add rules at any point, and a classic thing that happens when testing a new work is that the designer realises there is a case which has not been thought of:</p>
<!-- START CODE "c3297" -->
<a id="c3297"></a><blockquote class="code"><p class="quoted">
Check photographing:
<br />&#160;&#160;&#160;&#160;if the noun is the camera:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;That would require some sort of contraption with mirrors.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "194: The Dark Ages Revisited" "e131" -->
<a id="e131"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example131'); return false;"><b>194</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example131'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Dark Ages Revisited</span></b></a><br />An electric light kind of device which becomes lit when switched on and dark when switched off.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc14.html#e131"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example131" style="display: none;">
<p>This will be explored more in subsequent examples, but one of the things we can do with carry out rules is extend the function of existing commands so that they do more, or have special effects in specific situations. For instance, suppose we want to have a class of electric light:</p>
<!-- START CODE "c3298_131" -->
<a id="c3298_131"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]The Dark Ages Revisited[=0x0022=][=0x000A=][=0x000A=]An electric light is a kind of device. Carry out switching on an electric light: now the noun is lit. Carry out switching off an electric light: now the noun is unlit.[=0x000A=][=0x000A=][This will not affect the behavior of any other devices when switched; it will also not change the way in which switching lights on and off is reported. The player will still see [=0x0022=]You switch the sodium lamp on.[=0x0022=] or the like. In this case that is probably what we want. If we wanted a special way of describing turning on electric lights as opposed to all other devices, we could also add an after rule for the electric light class. Adding this rule to the carry out train does guarantee, though, that in no case will we manage to make the lamp lit without actually making it switched on (or vice versa).][=0x000A=][=0x000A=]The Stooped Corridor is a room. [=0x0022=]A low, square-cut corridor, running north to south, stooping you over.[=0x0022=][=0x000A=][=0x000A=]The sodium lamp is an electric light in the Stooped Corridor. [=0x0022=][if switched on]The sodium lamp squats on the ground, burning away.[otherwise]The sodium lamp squats heavily on the ground.[end if][=0x0022=]. The description is [=0x0022=]It is a heavy-duty archaeologist[=0x0027=]s lamp, [if switched off]currently off.[otherwise]blazing with brilliant yellow light.[end if][=0x0022=][=0x000A=][=0x000A=]Instead of burning the sodium lamp, try switching on the lamp.[=0x000A=][=0x000A=][So far so easy. Since we[=0x0027=]ve built the description of its light or darkness into the lamp[=0x0027=]s description, though, we may want to get rid of the [=0x0022=]...is switched on[=0x0022=] line that automatically follows when we look at something. For this we do need to borrow from a later chapter:][=0x000A=][=0x000A=]The examine devices rule is not listed in the carry out examining rules.[=0x000A=][=0x000A=]Test me with [=0x0022=]x lamp / switch lamp on / look / x lamp[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;The Dark Ages Revisited&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3299_131" -->
<a id="c3299_131"></a><blockquote class="code"><p class="quoted">
An electric light is a kind of device. Carry out switching on an electric light: now the noun is lit. Carry out switching off an electric light: now the noun is unlit.
</p></blockquote>
<!-- END CODE -->
<p>This will not affect the behavior of any other devices when switched; it will also not change the way in which switching lights on and off is reported. The player will still see &quot;You switch the sodium lamp on.&quot; or the like. In this case that is probably what we want. If we wanted a special way of describing turning on electric lights as opposed to all other devices, we could also add an after rule for the electric light class. Adding this rule to the carry out train does guarantee, though, that in no case will we manage to make the lamp lit without actually making it switched on (or vice versa).</p>
<!-- START CODE "c3300_131" -->
<a id="c3300_131"></a><blockquote class="code"><p class="quoted">
The Stooped Corridor is a room. &quot;A low, square-cut corridor, running north to south, stooping you over.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3301_131" -->
<a id="c3301_131"></a><blockquote class="code"><p class="quoted">
The sodium lamp is an electric light in the Stooped Corridor. &quot;[if switched on]The sodium lamp squats on the ground, burning away.[otherwise]The sodium lamp squats heavily on the ground.[end if]&quot;. The description is &quot;It is a heavy-duty archaeologist's lamp, [if switched off]currently off.[otherwise]blazing with brilliant yellow light.[end if]&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3302_131" -->
<a id="c3302_131"></a><blockquote class="code"><p class="quoted">
Instead of burning the sodium lamp, try switching on the lamp.
</p></blockquote>
<!-- END CODE -->
<p>So far so easy. Since we've built the description of its light or darkness into the lamp's description, though, we may want to get rid of the &quot;...is switched on&quot; line that automatically follows when we look at something. For this we do need to borrow from a later chapter:</p>
<!-- START CODE "c3303_131" -->
<a id="c3303_131"></a><blockquote class="code"><p class="quoted">
The examine devices rule is not listed in the carry out examining rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3304_131" -->
<a id="c3304_131"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x lamp / switch lamp on / look / x lamp&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "195: Paddington" "e228" -->
<a id="e228"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example228'); return false;"><b>195</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example228'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Paddington</span></b></a><br />A CUT [something] WITH [something] command which acts differently on different types of objects.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc83.html#e228"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example228" style="display: none;">
<p>Suppose we intend a game in which the player needs to cut things open on a regular basis. We'll want to check whether he has the proper tools handy, and deal graciously with commands such as CUT [something] when no tool is specified. So:</p>
<!-- START CODE "c3305_228" -->
<a id="c3305_228"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Paddington[=0x0022=][=0x000A=][=0x000A=]A blade is a kind of thing.[=0x000A=][=0x000A=]Understand [=0x0022=]cut [something] with [something][=0x0022=] as cutting it with.[=0x000A=][=0x000A=]Instead of cutting something:[=0x000A=][=0x0009=]if a blade (called the edge) is held by the player,[=0x000A=][=0x0009=][=0x0009=]try cutting the noun with the edge;[=0x000A=][=0x0009=]otherwise say [=0x0022=]Your fingernails are not sharp enough.[=0x0022=][=0x000A=][=0x000A=]Cutting it with is an action applying to two things.[=0x000A=][=0x000A=]Check cutting it with:[=0x000A=][=0x0009=]if the noun is a person, say [=0x0022=]That would hurt.[=0x0022=] instead;[=0x000A=][=0x0009=]if the second noun is not a blade, say [=0x0022=][The second noun] has not got enough of a blade.[=0x0022=] instead.[=0x000A=][=0x000A=]Carry out cutting it with:[=0x000A=][=0x0009=]increment the count of rips of the noun.[=0x000A=][=0x000A=]Report cutting it with:[=0x000A=][=0x0009=]say [=0x0022=]You slash [the noun] with [the second noun].[=0x0022=][=0x000A=][=0x000A=][We[=0x0027=]ll need a way to account for all these cuts and rips.][=0x000A=][=0x000A=]Definition: a thing is ripped if the count of rips of it [=0x003E=] 0.  A thing has a number called the count of rips. After examining something ripped, say [=0x0022=]You see [the count of rips of the noun in words] rip[s] in [the noun][if something is in the noun], revealing [a list of things in the noun][end if].[=0x0022=][=0x000A=][=0x000A=][Moreover, because open containers normally list their contents when examined but we[=0x0027=]d prefer Paddington[=0x0027=]s to be mentioned in the ripping paragraph:][=0x000A=][=0x000A=]The examine containers rule does nothing when examining the teddy bear.[=0x000A=][=0x000A=][So far, so good. But suppose that we[=0x0027=]d like cutting also to make containers be permanently open and impossible to close again. We could write an [=0x0022=]instead[=0x0022=] rule, but that would mean that only our instead instructions would take effect, overriding the normal cutting it with rules entirely. Better would be to add a second carry out rule:][=0x000A=][=0x000A=]Carry out cutting a container with something:[=0x000A=][=0x0009=]now the noun is open;[=0x000A=][=0x0009=]now the noun is unopenable.[=0x000A=][=0x000A=][Now our rule will occur whenever a container is cut, but play will still go on to the reporting stage. And indeed we can add more of these, of varying degrees of specificity:][=0x000A=][=0x000A=]Carry out cutting something which is part of something with something:[=0x000A=][=0x0009=]move the noun to the player.[=0x000A=][=0x000A=]Carry out cutting the quilt with something:[=0x000A=][=0x0009=]now the description of the quilt is [=0x0022=]Horribly tattered.[=0x0022=][=0x000A=][=0x000A=][For that matter, we might want to add a report rule as well, to occur after the [=0x0022=]You slash...[=0x0022=] rule, so that every time the player cuts something open which has contents, the contents will be listed.][=0x000A=][=0x000A=]Report cutting it with:[=0x000A=][=0x0009=]if the noun is open and the noun contains something,[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Visible within [is-are a list of things in the noun].[=0x0022=][=0x000A=][=0x000A=][This time we do not add the condition to the rule (i.e., Report cutting an open noun...) If we did, this report rule would be more specific than the general report rule, and would occur first.][=0x000A=][=0x000A=]The Safehouse is a room.[=0x000A=][=0x000A=]The teddy bear is a closed thing in the Safehouse. The description is [=0x0022=]Fluffy[if the head is part of the bear], with an outsized head[otherwise], but headless[end if].[=0x0022=] The head is a closed part of the teddy bear. In the bear is a large wad of stuffing. In the head are a small wad of stuffing and a packet of smuggled diamonds.[=0x000A=][=0x000A=]The quilt is in the Safehouse. The description is [=0x0022=]An old but comforting quilt.[=0x0022=][=0x000A=][=0x000A=]The player carries a blade called a switchblade.[=0x000A=][=0x000A=][Here is a final nicety to get rid of the [=0x0022=]which is closed[=0x0022=] statement on our closed unopenable teddy bear, using an [=0x0022=]activity[=0x0022=] rule:][=0x000A=][=0x000A=]After printing the name of a closed unopenable container:[=0x000A=][=0x0009=]omit contents in listing.[=0x000A=][=0x000A=]Test me with [=0x0022=]cut quilt with bear / cut quilt with switchblade / examine quilt / cut bear with switchblade / again / examine bear / cut head with switchblade / get diamonds / mourn loss of innocence[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Paddington&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3306_228" -->
<a id="c3306_228"></a><blockquote class="code"><p class="quoted">
A blade is a kind of thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3307_228" -->
<a id="c3307_228"></a><blockquote class="code"><p class="quoted">
Understand &quot;cut [something] with [something]&quot; as cutting it with.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3308_228" -->
<a id="c3308_228"></a><blockquote class="code"><p class="quoted">
Instead of cutting something:
<br />&#160;&#160;&#160;&#160;if a blade (called the edge) is held by the player,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try cutting the noun with the edge;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;Your fingernails are not sharp enough.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3309_228" -->
<a id="c3309_228"></a><blockquote class="code"><p class="quoted">
Cutting it with is an action applying to two things.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3310_228" -->
<a id="c3310_228"></a><blockquote class="code"><p class="quoted">
Check cutting it with:
<br />&#160;&#160;&#160;&#160;if the noun is a person, say &quot;That would hurt.&quot; instead;
<br />&#160;&#160;&#160;&#160;if the second noun is not a blade, say &quot;[The second noun] has not got enough of a blade.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3311_228" -->
<a id="c3311_228"></a><blockquote class="code"><p class="quoted">
Carry out cutting it with:
<br />&#160;&#160;&#160;&#160;increment the count of rips of the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3312_228" -->
<a id="c3312_228"></a><blockquote class="code"><p class="quoted">
Report cutting it with:
<br />&#160;&#160;&#160;&#160;say &quot;You slash [the noun] with [the second noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>We'll need a way to account for all these cuts and rips.</p>
<!-- START CODE "c3313_228" -->
<a id="c3313_228"></a><blockquote class="code"><p class="quoted">
Definition: a thing is ripped if the count of rips of it &gt; 0.  A thing has a number called the count of rips. After examining something ripped, say &quot;You see [the count of rips of the noun in words] rip[s] in [the noun][if something is in the noun], revealing [a list of things in the noun][end if].&quot;
</p></blockquote>
<!-- END CODE -->
<p>Moreover, because open containers normally list their contents when examined but we'd prefer Paddington's to be mentioned in the ripping paragraph:</p>
<!-- START CODE "c3314_228" -->
<a id="c3314_228"></a><blockquote class="code"><p class="quoted">
The examine containers rule does nothing when examining the teddy bear.
</p></blockquote>
<!-- END CODE -->
<p>So far, so good. But suppose that we'd like cutting also to make containers be permanently open and impossible to close again. We could write an &quot;instead&quot; rule, but that would mean that only our instead instructions would take effect, overriding the normal cutting it with rules entirely. Better would be to add a second carry out rule:</p>
<!-- START CODE "c3315_228" -->
<a id="c3315_228"></a><blockquote class="code"><p class="quoted">
Carry out cutting a container with something:
<br />&#160;&#160;&#160;&#160;now the noun is open;
<br />&#160;&#160;&#160;&#160;now the noun is unopenable.
</p></blockquote>
<!-- END CODE -->
<p>Now our rule will occur whenever a container is cut, but play will still go on to the reporting stage. And indeed we can add more of these, of varying degrees of specificity:</p>
<!-- START CODE "c3316_228" -->
<a id="c3316_228"></a><blockquote class="code"><p class="quoted">
Carry out cutting something which is part of something with something:
<br />&#160;&#160;&#160;&#160;move the noun to the player.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3317_228" -->
<a id="c3317_228"></a><blockquote class="code"><p class="quoted">
Carry out cutting the quilt with something:
<br />&#160;&#160;&#160;&#160;now the description of the quilt is &quot;Horribly tattered.&quot;
</p></blockquote>
<!-- END CODE -->
<p>For that matter, we might want to add a report rule as well, to occur after the &quot;You slash...&quot; rule, so that every time the player cuts something open which has contents, the contents will be listed.</p>
<!-- START CODE "c3318_228" -->
<a id="c3318_228"></a><blockquote class="code"><p class="quoted">
Report cutting it with:
<br />&#160;&#160;&#160;&#160;if the noun is open and the noun contains something,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Visible within [is-are a list of things in the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>This time we do not add the condition to the rule (i.e., Report cutting an open noun...) If we did, this report rule would be more specific than the general report rule, and would occur first.</p>
<!-- START CODE "c3319_228" -->
<a id="c3319_228"></a><blockquote class="code"><p class="quoted">
The Safehouse is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3320_228" -->
<a id="c3320_228"></a><blockquote class="code"><p class="quoted">
The teddy bear is a closed thing in the Safehouse. The description is &quot;Fluffy[if the head is part of the bear], with an outsized head[otherwise], but headless[end if].&quot; The head is a closed part of the teddy bear. In the bear is a large wad of stuffing. In the head are a small wad of stuffing and a packet of smuggled diamonds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3321_228" -->
<a id="c3321_228"></a><blockquote class="code"><p class="quoted">
The quilt is in the Safehouse. The description is &quot;An old but comforting quilt.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3322_228" -->
<a id="c3322_228"></a><blockquote class="code"><p class="quoted">
The player carries a blade called a switchblade.
</p></blockquote>
<!-- END CODE -->
<p>Here is a final nicety to get rid of the &quot;which is closed&quot; statement on our closed unopenable teddy bear, using an &quot;activity&quot; rule:</p>
<!-- START CODE "c3323_228" -->
<a id="c3323_228"></a><blockquote class="code"><p class="quoted">
After printing the name of a closed unopenable container:
<br />&#160;&#160;&#160;&#160;omit contents in listing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3324_228" -->
<a id="c3324_228"></a><blockquote class="code"><p class="quoted">
Test me with &quot;cut quilt with bear / cut quilt with switchblade / examine quilt / cut bear with switchblade / again / examine bear / cut head with switchblade / get diamonds / mourn loss of innocence&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "196: Noisemaking" "e152" -->
<a id="e152"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example152'); return false;"><b>196</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example152'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Noisemaking</span></b></a><br />Creating a stage after the report stage of an action, during which other characters may observe and react.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc49.html#e152"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example152" style="display: none;">
<p>Suppose the current sequence of action handling is not quite enough for us: we'd also like to have a stage after reporting, where other characters can react to the player character's behavior after it has already happened and been reported on screen. Having such a stage is unlike using &quot;after&quot;, because after occurs before reports and prevents them from being printed. So, for instance, we could allow the player to do any of a range of different actions that make loud noises, and have a nervous bird that reacts to all of them by flying away afterward.</p>
<p>To do this, we can add a new rule into the specific action-processing rules. (For a list of these, see the Rules index.) Moving rules around and adding new ones requires syntax that we will learn in the chapter on Rulebooks, but the present example is fairly straightforward:</p>
<!-- START CODE "c3325_152" -->
<a id="c3325_152"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Noisemaking[=0x0022=][=0x000A=][=0x000A=]Section 1 - Procedure[=0x000A=][=0x000A=]The other-player response rule is listed after the report stage rule in the specific action-processing rules.[=0x000A=][=0x000A=]This is the other-player response rule:[=0x000A=][=0x0009=]follow the observation rules.[=0x000A=][=0x000A=]The observation rules is a rulebook.[=0x000A=][=0x000A=]Section 2 - Scenario[=0x000A=][=0x000A=]Country Lane is a room. West of Country Lane is Outside the Farmhouse. East of Country Lane is Village Center. North of Country Lane is Open Field.[=0x000A=][=0x000A=]The player carries a drum.[=0x000A=][=0x000A=]The black crow is an animal in Country Lane.[=0x000A=][=0x000A=]Singing is an action applying to nothing. Understand [=0x0022=]sing[=0x0022=] as singing.[=0x000A=][=0x000A=]Report singing:[=0x000A=][=0x0009=]say [=0x0022=]You hum a little ditty.[=0x0022=][=0x000A=][=0x000A=]Singing is a loud action.[=0x000A=][=0x000A=]Attacking the drum is a loud action.[=0x000A=][=0x000A=]The block attacking rule is not listed in any rulebook.[=0x000A=][=0x000A=]Report attacking something:[=0x000A=][=0x0009=]say [=0x0022=]THWACK![=0x0022=][=0x000A=][=0x000A=]An observation rule for loud action in the presence of the black crow:[=0x000A=][=0x0009=]let N be a random adjacent room;[=0x000A=][=0x0009=]if N is a room, move the black crow to N;[=0x000A=][=0x0009=]say [=0x0022=]The crow, startled, flies off to [N].[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]sing / g / n / hit drum[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Noisemaking&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3326_152" -->
<a id="c3326_152"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3327_152" -->
<a id="c3327_152"></a><blockquote class="code"><p class="quoted">
The other-player response rule is listed after the report stage rule in the specific action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3328_152" -->
<a id="c3328_152"></a><blockquote class="code"><p class="quoted">
This is the other-player response rule:
<br />&#160;&#160;&#160;&#160;follow the observation rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3329_152" -->
<a id="c3329_152"></a><blockquote class="code"><p class="quoted">
The observation rules is a rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3330_152" -->
<a id="c3330_152"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3331_152" -->
<a id="c3331_152"></a><blockquote class="code"><p class="quoted">
Country Lane is a room. West of Country Lane is Outside the Farmhouse. East of Country Lane is Village Center. North of Country Lane is Open Field.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3332_152" -->
<a id="c3332_152"></a><blockquote class="code"><p class="quoted">
The player carries a drum.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3333_152" -->
<a id="c3333_152"></a><blockquote class="code"><p class="quoted">
The black crow is an animal in Country Lane.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3334_152" -->
<a id="c3334_152"></a><blockquote class="code"><p class="quoted">
Singing is an action applying to nothing. Understand &quot;sing&quot; as singing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3335_152" -->
<a id="c3335_152"></a><blockquote class="code"><p class="quoted">
Report singing:
<br />&#160;&#160;&#160;&#160;say &quot;You hum a little ditty.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3336_152" -->
<a id="c3336_152"></a><blockquote class="code"><p class="quoted">
Singing is a loud action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3337_152" -->
<a id="c3337_152"></a><blockquote class="code"><p class="quoted">
Attacking the drum is a loud action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3338_152" -->
<a id="c3338_152"></a><blockquote class="code"><p class="quoted">
The block attacking rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3339_152" -->
<a id="c3339_152"></a><blockquote class="code"><p class="quoted">
Report attacking something:
<br />&#160;&#160;&#160;&#160;say &quot;THWACK!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3340_152" -->
<a id="c3340_152"></a><blockquote class="code"><p class="quoted">
An observation rule for loud action in the presence of the black crow:
<br />&#160;&#160;&#160;&#160;let N be a random adjacent room;
<br />&#160;&#160;&#160;&#160;if N is a room, move the black crow to N;
<br />&#160;&#160;&#160;&#160;say &quot;The crow, startled, flies off to [N].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3341_152" -->
<a id="c3341_152"></a><blockquote class="code"><p class="quoted">
Test me with &quot;sing / g / n / hit drum&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "197: Delicious, Delicious Rocks" "e269" -->
<a id="e269"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example269'); return false;"><b>197</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example269'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Delicious, Delicious Rocks</span></b></a><br />Adding a "sanity-check" stage to decide whether an action makes any sense, which occurs before any before rules, implicit taking, or check rules.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc68.html#e269"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example269" style="display: none;">
<p>In some cases, we may want to add new stages to action processing. One possibility is a stage where we check the sanity of what the player is trying to do before executing any of the other commands; so that we avoid, for instance</p>
<!-- START CODE "c3342_269" -->
<a id="c3342_269"></a><blockquote class="code"><p class="quoted">
&gt;EAT ROCK
<br />(first taking the rock)
<br />That's plainly inedible.
</p></blockquote>
<!-- END CODE -->
<p>Here is how we might insert such a stage in our action processing, using rulebook manipulation.</p>
<!-- START CODE "c3343_269" -->
<a id="c3343_269"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Delicious, Delicious Rocks[=0x0022=][=0x000A=][=0x000A=]Section 1 - Procedure[=0x000A=][=0x000A=]The sanity-check rules are a rulebook.[=0x000A=][=0x000A=]This is the sanity-check stage rule:[=0x000A=][=0x0009=]abide by the sanity-check rules.[=0x000A=][=0x000A=]The sanity-check stage rule is listed after the before stage rule  in the action-processing rules.[=0x000A=][=0x000A=]Section 2 - Scenario[=0x000A=][=0x000A=]Candyland is a room. The lollipop tree is an edible thing in Candyland. The genuine rock is a thing in Candyland.[=0x000A=][=0x000A=]Sanity-check eating an inedible thing:[=0x000A=][=0x0009=]say [=0x0022=]Your digestion is so delicate -- you[=0x0027=]re sure [the noun] wouldn[=0x0027=]t agree with you.[=0x0022=] instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]eat lollipop / eat rock[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a>  &quot;Delicious, Delicious Rocks&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3344_269" -->
<a id="c3344_269"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3345_269" -->
<a id="c3345_269"></a><blockquote class="code"><p class="quoted">
The sanity-check rules are a rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3346_269" -->
<a id="c3346_269"></a><blockquote class="code"><p class="quoted">
This is the sanity-check stage rule:
<br />&#160;&#160;&#160;&#160;abide by the sanity-check rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3347_269" -->
<a id="c3347_269"></a><blockquote class="code"><p class="quoted">
The sanity-check stage rule is listed after the before stage rule  in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3348_269" -->
<a id="c3348_269"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3349_269" -->
<a id="c3349_269"></a><blockquote class="code"><p class="quoted">
Candyland is a room. The lollipop tree is an edible thing in Candyland. The genuine rock is a thing in Candyland.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3350_269" -->
<a id="c3350_269"></a><blockquote class="code"><p class="quoted">
Sanity-check eating an inedible thing:
<br />&#160;&#160;&#160;&#160;say &quot;Your digestion is so delicate -- you're sure [the noun] wouldn't agree with you.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c3351_269" -->
<a id="c3351_269"></a><blockquote class="code"><p class="quoted">
Test me with &quot;eat lollipop / eat rock&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Notice that now Inform does not try taking the rock before rejecting the player's attempt to eat it.</p>
<p>It is of course possible to get the same effect with</p>
<!-- START CODE "c3352_269" -->
<a id="c3352_269"></a><blockquote class="code"><p class="quoted">
Before eating an inedible thing:
<br />&#160;&#160;&#160;&#160;say &quot;Your digestion is so delicate -- you're sure [the noun] wouldn't agree with you.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>...and in a small game with few rules, there's not much reason to add an extra stage. The ability to modify the stages of action processing becomes useful when we have a fairly large game with sophisticated modeling and want to be sure that some kinds of message (such as the sanity-check) are always handled before other things that we might be doing at the before stage (such as generating implicit actions like opening doors before going through them).</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc184.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc186.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
