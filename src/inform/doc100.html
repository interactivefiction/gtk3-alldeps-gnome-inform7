<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>7.3. Before rules</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Before rules" -->
<!-- SEARCH SECTION "7.3" -->
<!-- SEARCH SORT "000-007-003-000" -->
<!-- START IGNORE 99 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc99.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 7: Basic Actions</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc101.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง7.3. Before rules</p>
<p>Despite what was said in the previous section, instead rules do not quite bypass all of the usual rules. Inform knows that certain actions require light: for instance,</p>
<!-- START CODE "c1309" -->
<a id="c1309"></a><blockquote class="code"><p class="quoted">
examining the napkin; looking; looking under the dining table
</p></blockquote>
<!-- END CODE -->
<p>and if it is dark then none of these actions will be allowed, and any instead rules about them will not even be reached. Similarly, Inform knows that most actions require physical access to their objects: so &quot;taking the napkin&quot; would be blocked if the napkin were, say, inside a closed glass bottle, whereas &quot;examining the napkin&quot; would not. So an instead rule can only take effect if the action has already passed these basic reasonability tests.</p>
<p>&quot;Before&quot; rules genuinely precede checking of any kind. They also differ from instead rules in that they do not automatically stop the action in its tracks. Rather, they are provided as an opportunity to ensure that something else is done first. For example:</p>
<!-- START CODE "c1310" -->
<a id="c1310"></a><blockquote class="code"><p class="quoted">
Before taking the napkin, say &quot;(first unfolding its delicate origami swan)&quot;.
</p></blockquote>
<!-- END CODE -->
<p>whence</p>
<!-- START CODE "c1311" -->
<a id="c1311"></a><blockquote class="code"><p class="quoted">
&gt;GET NAPKIN
<br />(first unfolding its delicate origami swan)
<br />Taken.
</p></blockquote>
<!-- END CODE -->
<p>We have seen that instead rules automatically stop actions, whereas before rules automatically allow them to continue. We sometimes want to change this. The magic word &quot;instead&quot; can therefore be tacked on to any instruction in a before rule, and will have the effect of immediately stopping the action at that instruction. Thus the following two rules are (almost) equivalent:</p>
<!-- START CODE "c1312" -->
<a id="c1312"></a><blockquote class="code"><p class="quoted">
Before taking the key, instead say &quot;It seems to be soldered to the keyhole.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1313" -->
<a id="c1313"></a><blockquote class="code"><p class="quoted">
Instead of taking the key, say &quot;It seems to be soldered to the keyhole.&quot;
</p></blockquote>
<!-- END CODE -->
<p>It is also possible to be explicit about stopping the action:</p>
<!-- START PHRASE "defn67" -->
<div class="definition"><a id="defn67"></a><p class="defnprototype"><b>stop the action</b></p>
<!-- END PHRASE -->
<!-- definition of ph_stopaction -->

<p>This phrase stops the current rule, stops the rulebook being worked through, and finally stops the action being processed. Example:</p>
<!-- START CODE "c1314" -->
<a id="c1314"></a><blockquote class="code"><p class="quoted">
Before taking the key:
<br />&#160;&#160;&#160;&#160;say &quot;It seems to be soldered to the keyhole.&quot;;
<br />&#160;&#160;&#160;&#160;stop the action.
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>Finally, we can prevent Inform from stopping the action when it otherwise might:</p>
<!-- START PHRASE "defn68" -->
<div class="definition"><a id="defn68"></a><p class="defnprototype"><b>continue the action</b></p>
<!-- END PHRASE -->
<!-- definition of ph_continueaction -->

<p>This phrase ends the current rule, but in a way which keeps its rulebook going, so that the action being processed will carry on rather than being stopped. Example:</p>
<!-- START CODE "c1315" -->
<a id="c1315"></a><blockquote class="code"><p class="quoted">
Instead of taking the napkin:
<br />&#160;&#160;&#160;&#160;say &quot;(first unfolding its delicate origami swan)[command clarification break]&quot;;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<p>An &quot;instead&quot; rule ordinarily stops the action when it finishes, so the &quot;continue the action&quot; is needed to make things carry on. (This rule would have been better written as a &quot;before&quot; rule, in fact, but it shows the idea.)</p>

<!-- end definition -->
</div>

<p>As a general principle, it is good style to use instead rules whenever blocking actions, and before rules only when it is genuinely necessary to do something first but then to continue: in fact, it is good style to use &quot;stop the action&quot; or &quot;continue the action&quot; as little as possible.</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "86: Democratic Process" "e418" -->
<a id="e418"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example418'); return false;"><b>86</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example418'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Democratic Process</span></b></a><br />Make PUT and INSERT commands automatically take objects if the player is not holding them.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc36.html#e418"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example418" style="display: none;">
<p>&quot;Stop&quot; and &quot;Continue&quot; are most useful when we need to write rules that will have to stop the action some of the time but at other times let it pass; so for instance:</p>
<!-- START CODE "c1316_418" -->
<a id="c1316_418"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Democratic Process[=0x0022=][=0x000A=][=0x000A=]Before inserting something which is not carried by the player into something:[=0x000A=][=0x0009=]if the noun is in the second noun, say [=0x0022=]Already done.[=0x0022=] instead;[=0x000A=][=0x0009=]say [=0x0022=](first taking [the noun])[line break][=0x0022=];[=0x000A=][=0x0009=]silently try taking the noun;[=0x000A=][=0x0009=]if the player is not holding the noun, stop the action.[=0x000A=][=0x000A=]Before putting something which is not carried by the player on something:[=0x000A=][=0x0009=]if the noun is on the second noun, say [=0x0022=]Already done.[=0x0022=] instead;[=0x000A=][=0x0009=]say [=0x0022=](first taking [the noun])[line break][=0x0022=];[=0x000A=][=0x0009=]silently try taking the noun;[=0x000A=][=0x0009=]if the player is not holding the noun, stop the action.[=0x000A=][=0x000A=]The Assembly Room is a room. [=0x0022=]On most days, this room is used for elementary school assemblies; at the moment, it serves as a voting place.[=0x0022=] The ballot is on the desk. The desk is in the Assembly Room.[=0x000A=][=0x000A=]The machine is a container in the Assembly Room. [=0x0022=]On the ballot machine is a sign which reads [=0x0027=]PUT BALLOTS IN ME :)[=0x0027=].[=0x0022=] Understand [=0x0022=]ballot machine[=0x0022=] as the machine.[=0x000A=][=0x000A=]Test me with [=0x0022=]put ballot in machine[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Democratic Process&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1317_418" -->
<a id="c1317_418"></a><blockquote class="code"><p class="quoted">
Before inserting something which is not carried by the player into something:
<br />&#160;&#160;&#160;&#160;if the noun is in the second noun, say &quot;Already done.&quot; instead;
<br />&#160;&#160;&#160;&#160;say &quot;(first taking [the noun])[line break]&quot;;
<br />&#160;&#160;&#160;&#160;silently try taking the noun;
<br />&#160;&#160;&#160;&#160;if the player is not holding the noun, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1318_418" -->
<a id="c1318_418"></a><blockquote class="code"><p class="quoted">
Before putting something which is not carried by the player on something:
<br />&#160;&#160;&#160;&#160;if the noun is on the second noun, say &quot;Already done.&quot; instead;
<br />&#160;&#160;&#160;&#160;say &quot;(first taking [the noun])[line break]&quot;;
<br />&#160;&#160;&#160;&#160;silently try taking the noun;
<br />&#160;&#160;&#160;&#160;if the player is not holding the noun, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1319_418" -->
<a id="c1319_418"></a><blockquote class="code"><p class="quoted">
The Assembly Room is a room. &quot;On most days, this room is used for elementary school assemblies; at the moment, it serves as a voting place.&quot; The ballot is on the desk. The desk is in the Assembly Room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1320_418" -->
<a id="c1320_418"></a><blockquote class="code"><p class="quoted">
The machine is a container in the Assembly Room. &quot;On the ballot machine is a sign which reads 'PUT BALLOTS IN ME :)'.&quot; Understand &quot;ballot machine&quot; as the machine.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1321_418" -->
<a id="c1321_418"></a><blockquote class="code"><p class="quoted">
Test me with &quot;put ballot in machine&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "87: Sand" "e177" -->
<a id="e177"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example177'); return false;"><b>87</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example177'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Sand</span></b></a><br />Extend PUT and INSERT handling to cases where multiple objects are intended at once.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc36.html#e177"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example177" style="display: none;">
<p>The above example does not quite work when we want the player to be allowed to take multiple objects at once before putting them somewhere: we also need to add a couple of &quot;understand&quot; rules borrowed from many chapters later. While the reasons may not be immediately clear, we include the demonstration here for the sake of thoroughness:</p>
<!-- START CODE "c1322_177" -->
<a id="c1322_177"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Sand[=0x0022=][=0x000A=][=0x000A=]Before inserting something which is not carried by the player into something:[=0x000A=][=0x0009=]if the noun is in the second noun, say [=0x0022=]Already done.[=0x0022=] instead;[=0x000A=][=0x0009=]say [=0x0022=](first taking [the noun]) [=0x0022=];[=0x000A=][=0x0009=]silently try taking the noun;[=0x000A=][=0x0009=]if the player is not holding the noun, stop the action.[=0x000A=][=0x000A=]Before putting something which is not carried by the player on something:[=0x000A=][=0x0009=]if the noun is on the second noun, say [=0x0022=]Already done.[=0x0022=] instead;[=0x000A=][=0x0009=]say [=0x0022=](first taking [the noun])[line break][=0x0022=];[=0x000A=][=0x0009=]silently try taking the noun;[=0x000A=][=0x0009=]if the player is not holding the noun, stop the action.[=0x000A=][=0x000A=]Understand [=0x0022=]put [things] in [something][=0x0022=] as inserting it into. Understand [=0x0022=]put [things] on [something][=0x0022=] as putting it on.[=0x000A=][=0x000A=]The Closet is a room.[=0x000A=][=0x000A=]A lentil is a kind of thing. A black-eyed pea is a kind of thing. The closet contains 3 lentils. The Closet contains 14 black-eyed peas. The round tin is a container in the closet. The round tin contains 17 lentils. The square tin is a container in the Closet. The square tin contains 20 black-eyed peas.[=0x000A=][=0x000A=]Sorting is a scene. Sorting begins when play begins. Sorting ends when all the lentils are in the round tin and all the black-eyed peas are in the square tin. When Sorting ends, end the story finally.[=0x000A=][=0x000A=]When play begins: say [=0x0022=]Thanks to your cruel stepmother, you[=0x0027=]re not going anywhere until the lentils and peas are sorted.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]put peas in square tin / put lentils in round tin[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Sand&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1323_177" -->
<a id="c1323_177"></a><blockquote class="code"><p class="quoted">
Before inserting something which is not carried by the player into something:
<br />&#160;&#160;&#160;&#160;if the noun is in the second noun, say &quot;Already done.&quot; instead;
<br />&#160;&#160;&#160;&#160;say &quot;(first taking [the noun]) &quot;;
<br />&#160;&#160;&#160;&#160;silently try taking the noun;
<br />&#160;&#160;&#160;&#160;if the player is not holding the noun, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1324_177" -->
<a id="c1324_177"></a><blockquote class="code"><p class="quoted">
Before putting something which is not carried by the player on something:
<br />&#160;&#160;&#160;&#160;if the noun is on the second noun, say &quot;Already done.&quot; instead;
<br />&#160;&#160;&#160;&#160;say &quot;(first taking [the noun])[line break]&quot;;
<br />&#160;&#160;&#160;&#160;silently try taking the noun;
<br />&#160;&#160;&#160;&#160;if the player is not holding the noun, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1325_177" -->
<a id="c1325_177"></a><blockquote class="code"><p class="quoted">
Understand &quot;put [things] in [something]&quot; as inserting it into. Understand &quot;put [things] on [something]&quot; as putting it on.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1326_177" -->
<a id="c1326_177"></a><blockquote class="code"><p class="quoted">
The Closet is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1327_177" -->
<a id="c1327_177"></a><blockquote class="code"><p class="quoted">
A lentil is a kind of thing. A black-eyed pea is a kind of thing. The closet contains 3 lentils. The Closet contains 14 black-eyed peas. The round tin is a container in the closet. The round tin contains 17 lentils. The square tin is a container in the Closet. The square tin contains 20 black-eyed peas.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1328_177" -->
<a id="c1328_177"></a><blockquote class="code"><p class="quoted">
Sorting is a scene. Sorting begins when play begins. Sorting ends when all the lentils are in the round tin and all the black-eyed peas are in the square tin. When Sorting ends, end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1329_177" -->
<a id="c1329_177"></a><blockquote class="code"><p class="quoted">
When play begins: say &quot;Thanks to your cruel stepmother, you're not going anywhere until the lentils and peas are sorted.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c1330_177" -->
<a id="c1330_177"></a><blockquote class="code"><p class="quoted">
Test me with &quot;put peas in square tin / put lentils in round tin&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc99.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc101.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
