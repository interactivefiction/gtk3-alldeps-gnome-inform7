<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>15.17. Totals</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Totals" -->
<!-- SEARCH SECTION "15.17" -->
<!-- SEARCH SORT "000-015-017-000" -->
<!-- START IGNORE 241 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc241.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 15: Numbers and Equations</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc243.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง15.17. Totals</p>
<p>This chapter began by mentioning arithmetic, and then went on a long diversion to create scientific units, everyday weights and measures, and other notational conveniences. Putting all of that together, it's time now to calculate something with all of these numerical quantities.</p>
<p>Suppose we invent the idea of weight, and give everything a weight of its own. Most items will have a nominal weight of 1kg, but people will be heavier. Going on actuarial tables, we might say:</p>
<!-- START CODE "c4760" -->
<a id="c4760"></a><blockquote class="code"><p class="quoted">
A weight is a kind of value. 10kg specifies a weight. Everything has a weight. A thing usually has weight 1kg. A man usually has weight 80kg. A woman usually has weight 67kg.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4761" -->
<a id="c4761"></a><blockquote class="code"><p class="quoted">
Definition: A thing is light if its weight is 3kg or less.
<br />Definition: A thing is heavy if its weight is 10kg or more.
</p></blockquote>
<!-- END CODE -->
<p>and this provides us with &quot;lighter&quot;, &quot;lightest&quot;, &quot;heavier&quot; and &quot;heaviest&quot; as before. Now we could say &quot;if Peter is heavier than Paul&quot;, or even &quot;if Peter is heavier than 75kg&quot;, and so forth. We need one more tool:</p>
<!-- START PHRASE "defn218" -->
<div class="definition"><a id="defn218"></a><p class="defnprototype"><b>total </b>(arithmetic values valued property)<b> of </b>(description of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_total -->

<p>This phrase produces the total of some property held by all of the values matching the description. A problem message is produced if the values in question can't have that property (&quot;the total carrying capacity of scenes&quot;), or if it holds a kind of value which can't meaningfully be added up (&quot;the total description of open doors&quot;). Example:</p>
<!-- START CODE "c4762" -->
<a id="c4762"></a><blockquote class="code"><p class="quoted">
total carrying capacity of people in the Deep Pool
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>That gives us everything we need for a working balance platform:</p>
<!-- START CODE "c4763" -->
<a id="c4763"></a><blockquote class="code"><p class="quoted">
The balance platform is a supporter in the Weighbridge. &quot;The balance platform is currently weighing [the list of things on the platform]. The scale alongside reads: [total weight of things on the platform].&quot;
</p></blockquote>
<!-- END CODE -->
<p>Note that this only works because we said that &quot;everything has a weight&quot;: otherwise it would make no sense to add up the weights of things.</p>
<p>This enables us to get the average weight of a group of things, too:</p>
<!-- START CODE "c4764" -->
<a id="c4764"></a><blockquote class="code"><p class="quoted">
the total weight of things on the platform divided by the number of things on the platform
</p></blockquote>
<!-- END CODE -->
<p>But we should be careful that this does not accidentally divide by zero, which it will if the platform has nothing on it! As well as the average, we could find the maximum and minimum weights:</p>
<!-- START CODE "c4765" -->
<a id="c4765"></a><blockquote class="code"><p class="quoted">
the weight of the heaviest thing on the platform
<br />the weight of the lightest thing on the platform
</p></blockquote>
<!-- END CODE -->
<p>We should remember that &quot;the heaviest thing on the platform&quot; may be ambiguous, because there may be several equally heavy things there. That means</p>
<!-- START CODE "c4766" -->
<a id="c4766"></a><blockquote class="code"><p class="quoted">
if the lead pig is the heaviest thing on the platform
</p></blockquote>
<!-- END CODE -->
<p>will only reliably work if there is no possibility of a tie. A safer bet is:</p>
<!-- START CODE "c4767" -->
<a id="c4767"></a><blockquote class="code"><p class="quoted">
if the lead pig is the weight of the heaviest thing on the platform
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "262: Nickel and Dimed" "e108" -->
<a id="e108"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example108'); return false;"><b>262</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example108'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Nickel and Dimed</span></b></a><br />A more intricate system of money, this time keeping track of the individual denominations of coins and bills, specifying what gets spent at each transaction, and calculating appropriate change.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc71.html#e108"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example108" style="display: none;">
<p>Typically games which keep track of the player's wealth need only do so as an abstract number, but occasionally it becomes useful to represent money as physical coins and bills. Here is an example that does exactly that:</p>
<!-- START CODE "c4768_108" -->
<a id="c4768_108"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Nickel and Dimed[=0x0022=][=0x000A=][=0x000A=]Section 1 - Currency[=0x000A=][=0x000A=]Price is a kind of value. $10.99 specifies a price with parts dollars and cents. A thing has a price. The price of a thing is usually $0.00.[=0x000A=][=0x000A=]Money is a kind of thing. Coin is a kind of money.[=0x000A=][=0x000A=]A dollar bill is a kind of money. The price of a dollar bill is $1.00. The printed name of a dollar bill is [=0x0022=]dollar bill[=0x0022=]. Rule for printing the plural name of a dollar bill: say [=0x0022=]dollar bills[=0x0022=]. The description of a dollar bill is [=0x0022=]It has George Washington[=0x0027=]s head on the front, which with a bit of creative folding can be scrunched to look like a mushroom. All important things really are learned in kindergarten.[=0x0022=][=0x000A=][=0x000A=]A five-dollar bill is a kind of money. The price of a five-dollar bill is $5.00. Understand [=0x0022=]five[=0x0022=] or [=0x0022=]five dollar[=0x0022=] as the five-dollar bill. The description of a five-dollar bill is [=0x0022=]Abraham Lincoln. He looks slightly less dignified here than he does on the penny.[=0x0022=][=0x000A=][=0x000A=]A hundred-dollar bill is a kind of money. The price of the hundred-dollar bill is $100.00. Understand [=0x0022=]hundred[=0x0022=] or [=0x0022=]hundred dollar[=0x0022=] as the hundred-dollar bill. Understand [=0x0022=]dollar[=0x0022=] as the dollar bill. The description of a hundred-dollar bill is [=0x0022=]It[=0x0027=]s got Benjamin Franklin, who always gets shafted: a denomination too large for anyone to carry conveniently, and a lot of local fame in Philadelphia.[=0x0022=][=0x000A=][=0x000A=][Our choice of understand rules guarantees that [=0x0022=]five dollar[=0x0022=] will be understood as the five, but [=0x0022=]dollar[=0x0022=] alone as the single. We will learn more about [=0x0022=]understand[=0x0022=] in later chapters, but here is a test to check the functionality:][=0x000A=][=0x000A=]Test bills with [=0x0022=]x hundred dollar bill / x five dollar bill / x hundred / x five / x dollar / x dollar bill[=0x0022=].[=0x000A=][=0x000A=]A quarter is a kind of coin. The price of a quarter is $0.25. The description of a quarter is [=0x0022=]One of the old-fashioned variety, not a state quarter.[=0x0022=][=0x000A=][=0x000A=]A dime is a kind of coin. The price of a dime is $0.10. The description of a dime is [=0x0022=]Franklin Roosevelt, trying not to look too annoyed that his coin is so small and thin.[=0x0022=][=0x000A=][=0x000A=]A nickel is a kind of coin. The price of a nickel is $0.05. The description of a nickel is [=0x0022=]A chubby coin, but you[=0x0027=]ve always liked Thomas Jefferson, and the Monticello on the back is a nice touch.[=0x0022=][=0x000A=][=0x000A=]A penny is a kind of coin. The price of a penny is $0.01. The description of the penny is [=0x0022=]A profile of Abe Lincoln. Sometime soon they[=0x0027=]ll stop minting these, you[=0x0027=]re sure of it.[=0x0022=][=0x000A=][=0x000A=]Section 2 - Ownership[=0x000A=][=0x000A=]Ownership relates one person (called the owner) to various things. The verb to own means the ownership relation.[=0x000A=][=0x000A=]Definition: a thing is owned if the player owns it.[=0x000A=][=0x000A=]Instead of buying something which is owned by the player:[=0x000A=][=0x0009=]say [=0x0022=]You already own [the noun].[=0x0022=][=0x000A=][=0x000A=]Instead of going somewhere when the player encloses something (called the stolen goods) which is not owned by the player:[=0x000A=][=0x0009=]if the owner of the stolen goods is not a person:[=0x000A=][=0x0009=][=0x0009=]now the player owns the stolen goods;[=0x000A=][=0x0009=][=0x0009=]continue the action;[=0x000A=][=0x0009=]if the owner of the stolen goods can see the player,[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][=0x0027=]Hey there buddy, not so fast,[=0x0027=] says [the owner of the stolen goods]. [=0x0027=]You going to buy [the stolen goods] first, or am I gonna call the cops?[=0x0027=][=0x0022=];[=0x000A=][=0x0009=]otherwise continue the action.[=0x000A=][=0x000A=]After taking inventory:[=0x000A=][=0x0009=]say [=0x0022=]Altogether, you[=0x0027=]ve got [the player[=0x0027=]s cash] on your person.[=0x0022=][=0x000A=][=0x000A=]To decide what price is the player[=0x0027=]s cash:[=0x000A=][=0x0009=]let sum be the total price of money enclosed by the player;[=0x000A=][=0x0009=]decide on sum.[=0x000A=][=0x000A=]To decide what price is the sum in (item - a container):[=0x000A=][=0x0009=]let sum be the total price of the money in the item;[=0x000A=][=0x0009=]decide on sum.[=0x000A=][=0x000A=]When play begins: now every thing carried by the player is owned by the player.[=0x000A=][=0x000A=]Section 3 - Purchasing and Sales[=0x000A=][=0x000A=]Definition: a thing is worthless if the price of it is $0.00. Definition: a thing is valuable if it is not worthless.[=0x000A=][=0x000A=]A thing can be for sale.[=0x000A=][=0x000A=]Rule for printing room description details of something (called target) which is for sale (this is the disclose prices in room description rule): say [=0x0022=] ([price of the target])[=0x0022=].[=0x000A=][=0x000A=]Before listing contents: group money together giving articles.[=0x000A=][=0x000A=]Instead of examining a for sale thing (this is the describe things by price rule):[=0x000A=][=0x0009=]say [=0x0022=][The noun] costs [the price of the noun], payable to [the owner of the noun].[=0x0022=][=0x000A=][=0x000A=][The cashbox is a theoretical construct, not something the player will ever encounter in the course of the game. It contains all the money that is available for non-player characters to use in making change. If we wanted, we could give each character his own stash of change, but this would increase the likelihood that any given person would run out of cash to make change with. (And in this example there is only one vendor anyway.)][=0x000A=][=0x000A=]The cashbox is a container. The cashbox contains 10 pennies. The cashbox contains 10 nickels.  The cashbox contains 10 dimes.  The cashbox contains 10 quarters.  The cashbox contains 10 dollar bills.  The cashbox contains 10 five-dollar bills.[=0x000A=][=0x000A=]The block buying rule is not listed in the check buying rules.[=0x000A=][=0x000A=]Check buying something:[=0x000A=][=0x0009=]if the noun is not for sale, say [=0x0022=][The owner of the noun] does not want to sell you [the noun].[=0x0022=] instead;[=0x000A=][=0x0009=]if the player[=0x0027=]s cash is less than the price of the noun, say [=0x0022=]You can[=0x0027=]t afford the asking price of [the price of the noun] for [the noun].[=0x0022=] instead.[=0x000A=][=0x000A=]Carry out buying something:[=0x000A=][=0x0009=]let sum paid be $0.00;[=0x000A=][=0x0009=]while sum paid is less than the price of the noun:[=0x000A=][=0x0009=][=0x0009=]let current target be the price of the noun minus the sum paid;[=0x000A=][=0x0009=][=0x0009=]let bill offered be the best money from the player for the current target;[=0x000A=][=0x0009=][=0x0009=]if the bill offered is money:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]move the bill offered to the owner of the noun;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]now the bill offered is spent;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]increase the sum paid by the price of the bill offered;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]let current target be the price of the noun minus the sum paid;[=0x000A=][=0x0009=]say [=0x0022=]You hand [the owner of the noun] [a list of spent money]. [run paragraph on][=0x0022=];[=0x000A=][=0x0009=]let change be $0.00;[=0x000A=][=0x0009=]if the sum paid is greater than the price of the noun:[=0x000A=][=0x0009=][=0x0009=]now the change is the sum paid minus the price of the noun;[=0x000A=][=0x0009=]if change is greater than the sum in the cashbox:[=0x000A=][=0x0009=][=0x0009=]now the player carries every spent money;[=0x000A=][=0x0009=][=0x0009=]now every spent thing is fresh;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][=0x0027=]Whoa,[=0x0027=] says [the owner of the noun], handing the cash back to you. [=0x0027=]I can[=0x0027=]t make change for that, man, sorry.[=0x0027=][=0x0022=] instead;[=0x000A=][=0x0009=]now every spent thing is in the cashbox;[=0x000A=][=0x0009=]now every spent thing is fresh;[=0x000A=][=0x0009=]while change is greater than $0.00:[=0x000A=][=0x0009=][=0x0009=]let change bill be the best money from the cashbox for change;[=0x000A=][=0x0009=][=0x0009=]decrease change by the price of the change bill;[=0x000A=][=0x0009=][=0x0009=]now change bill is spent;[=0x000A=][=0x0009=][=0x0009=]move change bill to player;[=0x000A=][=0x0009=]if money is spent, say [=0x0022=][The owner of the noun] makes change with [a list of spent money]. [run paragraph on][=0x0022=];[=0x000A=][=0x0009=]now every spent thing is fresh;[=0x000A=][=0x0009=]if the noun is not enclosed by the player and the owner of the noun can touch the noun:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][=0x0027=]Here ya go,[=0x0027=] says [the owner of the noun], handing [the noun] to you. [run paragraph on][=0x0022=];[=0x000A=][=0x0009=][=0x0009=]move the noun to the player;[=0x000A=][=0x0009=]now the player owns the noun.[=0x000A=][=0x000A=]Money can be spent or fresh.[=0x000A=][=0x000A=]Report buying something:[=0x000A=][=0x0009=]if the player owns the noun,[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Your transaction is now complete, leaving you with [the player[=0x0027=]s cash].[=0x0022=][=0x000A=][=0x000A=][We[=0x0027=]ve skipped over defining what makes a denomination the best for a given transaction, so we[=0x0027=]d better do that now. Our goal is to avoid ever having the player gratuitously overpay -- he should always offer the smallest amount of money that will meet the price of what he[=0x0027=]s buying.][=0x000A=][=0x000A=][We also assume that all money [=0x0022=]enclosed by the buyer[=0x0022=] -- that is, somewhere in the buyer[=0x0027=]s possession -- is available for use. This might not be true in a game where the player could pick up, say, a sealed lucite container with a ten-dollar bill inside; in that case we would have to define our terms more rigorously, perhaps by requiring that the bills be both enclosed and touchable by the buyer. The touchability check adds an extra layer of calculation, however, and since it is not necessary in this example (and probably not in most other cases either), we[=0x0027=]ll leave it out:][=0x000A=][=0x000A=]Definition: money is costly if its price is $2.50 or more. Definition: money is cheap if its price is $0.99 or less.[=0x000A=][=0x000A=]Functional relation is a kind of value. The functional relations are overpayment, underpayment and irrelevant. Money has a functional relation.[=0x000A=][=0x000A=]To decide what money is the best money from (buyer - a thing) for (cost - a price):[=0x000A=][=0x0009=]repeat with bill offered running through money:[=0x000A=][=0x0009=][=0x0009=]if the bill offered is enclosed by the buyer:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]if the price of the bill offered is the cost, decide on the bill offered;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]if the price of the bill offered is greater than the cost, now the functional relation of bill offered is overpayment;[=0x000A=][=0x0009=][=0x0009=][=0x0009=]otherwise now the functional relation of the bill offered is underpayment;[=0x000A=][=0x0009=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]now the functional relation of the bill offered is irrelevant;[=0x000A=][=0x0009=][say [=0x0022=]underpayment: [a list of underpayment money][=0x000A=][=0x0009=]overpayment: [a list of overpayment money][=0x0022=];][=0x000A=][=0x0009=]if the total price of underpayment money is less than the cost:[=0x000A=][=0x0009=][=0x0009=]decide on the cheapest money which is overpayment;[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]decide on the costliest money which is underpayment.[=0x000A=][=0x000A=][Notice the [=0x0022=]say underpayment/overpayment section...[=0x0022=] noted out, above. This is for debugging purposes: when writing complex code, it is sometimes useful to put in lines that will say explicitly what is going on. We can enclose them in brackets and Inform will ignore them as though they were comments; if we run into any problems with the code later, we can erase the brackets and see the diagnostic printed to the screen as we play.][=0x000A=][=0x000A=]Instead of giving money to someone:[=0x000A=][=0x0009=]say [=0x0022=]Best to keep the transaction simple by buying whatever you want.[=0x0022=][=0x000A=][=0x000A=]Section 4 - The Scenario[=0x000A=][=0x000A=]The player carries 2 dollar bills. The player carries a nickel. The player carries 2 pennies. The player carries a five-dollar bill. The player carries 1 hundred-dollar bill.[=0x000A=][=0x000A=]The Subway Station is a room.[=0x000A=][=0x000A=]The Bitterly Cold Street is north of the Subway Station. [=0x0022=]Even though there is no actual snow or ice, the street is about as cold as you can stand, for which reason walking the twenty blocks uptown is not an acceptable option.[=0x0022=] The Bitterly Cold Street contains a dollar bill.[=0x000A=][=0x000A=]The newspaper man is a man in the Subway Station. [=0x0022=]A newspaper man in a knit cap and fingerless gloves is hopping up and down behind his stand[if the turn count is 1]. Cold weather, caffeine overdose, or mental illness? You may never know. Welcome to New York[end if].[=0x0022=] The description is [=0x0022=]Eye contact with strangers is something to avoid around here.[=0x0022=][=0x000A=][=0x000A=]The stand is a supporter in the Station. The stand is scenery.[=0x000A=][=0x000A=]A copy of the New York Times is on the stand. The price of the New York Times is $1.25.[=0x000A=][=0x000A=]A pack of gum is on the stand. The price of the gum is $0.40.[=0x000A=][=0x000A=]A paperback novel is on the stand. The price of the paperback novel is $7.99.[=0x000A=][=0x000A=]A packet of trading cards is on the stand. The price of the packet is $0.99.[=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]now every thing on the stand is owned by the newspaper man;[=0x000A=][=0x0009=]now every thing on the stand is for sale.[=0x000A=][=0x000A=][We could have done all that by hand, but the initialization requires a little less work.][=0x000A=][=0x000A=]The ticket machine is a container in the Subway Station. It is fixed in place. The description of the ticket machine is [=0x0022=]An LED screen on the front instructs you to insert [remaining ticket total] to complete your purchase. You also notice that the NO CHANGE light is lit up.[=0x0022=] The light is part of the ticket machine. The printed name of the light is [=0x0022=]no change light[=0x0022=]. Understand [=0x0022=]no change[=0x0022=] or [=0x0022=]no change light[=0x0022=] as the light.[=0x000A=][=0x000A=]The description of the light is [=0x0022=]In the whole of your recollection, the ticket machine has actually had change a total of twice. Usually, as now, the no-change light gleams angrily, daring you to put in more than you owe.[=0x0022=] A cash return button is part of the ticket machine. Instead of pushing the cash return button: say [=0x0022=]The ticket machine regurgitates [the list of things in the ticket machine].[=0x0022=]; now every thing in the ticket machine is carried by the player. Instead of taking something which is in the ticket machine: say [=0x0022=]The ticket machine has swallowed your money, but it can be retrieved (you hope) with the cash return button.[=0x0022=][=0x000A=][=0x000A=]Instead of inserting a hundred-dollar bill into the ticket machine:[=0x000A=][=0x0009=]say [=0x0022=]What, are you nuts?[=0x0022=][=0x000A=][=0x000A=]To decide what price is the remaining ticket total:[=0x000A=][=0x0009=]let absolute cost be $2.25;[=0x000A=][=0x0009=]let remaining cost be absolute cost minus the total price of things in the ticket machine;[=0x000A=][=0x0009=]if remaining cost is less than $0.00, decide on $0.00;[=0x000A=][=0x0009=]decide on remaining cost.[=0x000A=][=0x000A=]Instead of inserting something which is not money into the ticket machine: say [=0x0022=]The ticket machine only accepts money, not other tokens of your esteem and regard.[=0x0022=][=0x000A=][=0x000A=]Instead of inserting a penny into the ticket machine:[=0x000A=][=0x0009=]say [=0x0022=]The penny rattles out again mockingly: not even the ticket machine thinks these are worth anything.[=0x0022=][=0x000A=][=0x000A=]A subway pass is a kind of thing. 15 subway passes are in the cashbox. The description of a subway pass is usually [=0x0022=]A rectangle of thick lavender paper with a black magnetic stripe running up the back side. It is good for one trip on the subway.[=0x0022=][=0x000A=][=0x000A=]After inserting something into the ticket machine:[=0x000A=][=0x0009=]if the remaining ticket total is $0.00:[=0x000A=][=0x0009=][=0x0009=]let purchased ticket be a random subway pass in the cashbox;[=0x000A=][=0x0009=][=0x0009=]if purchased ticket is not a subway pass, say [=0x0022=]The ticket machine grunts disobligingly and then the unwelcome word MALFUNCTION parades across the LED screen, three letters at a time.[=0x0022=] instead;[=0x000A=][=0x0009=][=0x0009=]repeat with item running through things in the machine:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]now the item is nowhere;[=0x000A=][=0x0009=][=0x0009=]move purchased ticket to player;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]The ticket machine beeps obligingly and disgorges a single subway pass.[=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]The ticket machine beeps obligingly and adjusts its price down to [remaining ticket total].[=0x0022=][=0x000A=][=0x000A=][And because even though the ticket machine is a container, we don[=0x0027=]t want to say (empty) after it in the room description:][=0x000A=][=0x000A=]Rule for printing room description details of the ticket machine:[=0x000A=][=0x0009=]do nothing instead.[=0x000A=][=0x000A=]Test me with [=0x0022=]buy novel / n / get dollar / s / buy novel[=0x0022=].[=0x000A=][=0x000A=][After all that, we should probably give the player a chance to win, as well:][=0x000A=][=0x000A=]The turnstile is south of the Subway Station. [=0x0022=]A turnstile is all that separates you from the subway platform stairs.[=0x0022=] The turnstile is north of the Platform. The turnstile is a door. Before going down in the presence of the turnstile, try going south instead. The turnstile is openable. The turnstile is open.[=0x000A=][=0x000A=]Instead of going through the turnstile when the player carries a subway pass: say [=0x0022=]You enter the turnstile and begin your journey uptown...[=0x0022=]; end the story finally saying [=0x0022=]At last[=0x0022=]. Instead of going through the turnstile: say [=0x0022=]You can[=0x0027=]t go through the turnstile without a subway pass. They[=0x0027=]re very strict about this.[=0x0022=][=0x000A=][=0x000A=]Instead of inserting money into the turnstile: say [=0x0022=]The turnstile takes passes, not money.[=0x0022=] Instead of inserting a subway pass into the turnstile, try entering the turnstile.[=0x000A=][=0x000A=]Test more with [=0x0022=]buy times / put all but five-dollar bill in machine / press button / buy gum / buy cards / i / put dollar in machine / g / put quarter in machine / i / d[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Nickel and Dimed&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4769_108" -->
<a id="c4769_108"></a><blockquote class="code"><p class="quoted">
Section 1 - Currency
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4770_108" -->
<a id="c4770_108"></a><blockquote class="code"><p class="quoted">
Price is a kind of value. $10.99 specifies a price with parts dollars and cents. A thing has a price. The price of a thing is usually $0.00.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4771_108" -->
<a id="c4771_108"></a><blockquote class="code"><p class="quoted">
Money is a kind of thing. Coin is a kind of money.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4772_108" -->
<a id="c4772_108"></a><blockquote class="code"><p class="quoted">
A dollar bill is a kind of money. The price of a dollar bill is $1.00. The printed name of a dollar bill is &quot;dollar bill&quot;. Rule for printing the plural name of a dollar bill: say &quot;dollar bills&quot;. The description of a dollar bill is &quot;It has George Washington's head on the front, which with a bit of creative folding can be scrunched to look like a mushroom. All important things really are learned in kindergarten.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4773_108" -->
<a id="c4773_108"></a><blockquote class="code"><p class="quoted">
A five-dollar bill is a kind of money. The price of a five-dollar bill is $5.00. Understand &quot;five&quot; or &quot;five dollar&quot; as the five-dollar bill. The description of a five-dollar bill is &quot;Abraham Lincoln. He looks slightly less dignified here than he does on the penny.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4774_108" -->
<a id="c4774_108"></a><blockquote class="code"><p class="quoted">
A hundred-dollar bill is a kind of money. The price of the hundred-dollar bill is $100.00. Understand &quot;hundred&quot; or &quot;hundred dollar&quot; as the hundred-dollar bill. Understand &quot;dollar&quot; as the dollar bill. The description of a hundred-dollar bill is &quot;It's got Benjamin Franklin, who always gets shafted: a denomination too large for anyone to carry conveniently, and a lot of local fame in Philadelphia.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Our choice of understand rules guarantees that &quot;five dollar&quot; will be understood as the five, but &quot;dollar&quot; alone as the single. We will learn more about &quot;understand&quot; in later chapters, but here is a test to check the functionality:</p>
<!-- START CODE "c4775_108" -->
<a id="c4775_108"></a><blockquote class="code"><p class="quoted">
Test bills with &quot;x hundred dollar bill / x five dollar bill / x hundred / x five / x dollar / x dollar bill&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4776_108" -->
<a id="c4776_108"></a><blockquote class="code"><p class="quoted">
A quarter is a kind of coin. The price of a quarter is $0.25. The description of a quarter is &quot;One of the old-fashioned variety, not a state quarter.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4777_108" -->
<a id="c4777_108"></a><blockquote class="code"><p class="quoted">
A dime is a kind of coin. The price of a dime is $0.10. The description of a dime is &quot;Franklin Roosevelt, trying not to look too annoyed that his coin is so small and thin.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4778_108" -->
<a id="c4778_108"></a><blockquote class="code"><p class="quoted">
A nickel is a kind of coin. The price of a nickel is $0.05. The description of a nickel is &quot;A chubby coin, but you've always liked Thomas Jefferson, and the Monticello on the back is a nice touch.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4779_108" -->
<a id="c4779_108"></a><blockquote class="code"><p class="quoted">
A penny is a kind of coin. The price of a penny is $0.01. The description of the penny is &quot;A profile of Abe Lincoln. Sometime soon they'll stop minting these, you're sure of it.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4780_108" -->
<a id="c4780_108"></a><blockquote class="code"><p class="quoted">
Section 2 - Ownership
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4781_108" -->
<a id="c4781_108"></a><blockquote class="code"><p class="quoted">
Ownership relates one person (called the owner) to various things. The verb to own means the ownership relation.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4782_108" -->
<a id="c4782_108"></a><blockquote class="code"><p class="quoted">
Definition: a thing is owned if the player owns it.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4783_108" -->
<a id="c4783_108"></a><blockquote class="code"><p class="quoted">
Instead of buying something which is owned by the player:
<br />&#160;&#160;&#160;&#160;say &quot;You already own [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4784_108" -->
<a id="c4784_108"></a><blockquote class="code"><p class="quoted">
Instead of going somewhere when the player encloses something (called the stolen goods) which is not owned by the player:
<br />&#160;&#160;&#160;&#160;if the owner of the stolen goods is not a person:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the player owns the stolen goods;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue the action;
<br />&#160;&#160;&#160;&#160;if the owner of the stolen goods can see the player,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;'Hey there buddy, not so fast,' says [the owner of the stolen goods]. 'You going to buy [the stolen goods] first, or am I gonna call the cops?'&quot;;
<br />&#160;&#160;&#160;&#160;otherwise continue the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4785_108" -->
<a id="c4785_108"></a><blockquote class="code"><p class="quoted">
After taking inventory:
<br />&#160;&#160;&#160;&#160;say &quot;Altogether, you've got [the player's cash] on your person.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4786_108" -->
<a id="c4786_108"></a><blockquote class="code"><p class="quoted">
To decide what price is the player's cash:
<br />&#160;&#160;&#160;&#160;let sum be the total price of money enclosed by the player;
<br />&#160;&#160;&#160;&#160;decide on sum.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4787_108" -->
<a id="c4787_108"></a><blockquote class="code"><p class="quoted">
To decide what price is the sum in (item - a container):
<br />&#160;&#160;&#160;&#160;let sum be the total price of the money in the item;
<br />&#160;&#160;&#160;&#160;decide on sum.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4788_108" -->
<a id="c4788_108"></a><blockquote class="code"><p class="quoted">
When play begins: now every thing carried by the player is owned by the player.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4789_108" -->
<a id="c4789_108"></a><blockquote class="code"><p class="quoted">
Section 3 - Purchasing and Sales
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4790_108" -->
<a id="c4790_108"></a><blockquote class="code"><p class="quoted">
Definition: a thing is worthless if the price of it is $0.00. Definition: a thing is valuable if it is not worthless.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4791_108" -->
<a id="c4791_108"></a><blockquote class="code"><p class="quoted">
A thing can be for sale.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4792_108" -->
<a id="c4792_108"></a><blockquote class="code"><p class="quoted">
Rule for printing room description details of something (called target) which is for sale (this is the disclose prices in room description rule): say &quot; ([price of the target])&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4793_108" -->
<a id="c4793_108"></a><blockquote class="code"><p class="quoted">
Before listing contents: group money together giving articles.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4794_108" -->
<a id="c4794_108"></a><blockquote class="code"><p class="quoted">
Instead of examining a for sale thing (this is the describe things by price rule):
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] costs [the price of the noun], payable to [the owner of the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>The cashbox is a theoretical construct, not something the player will ever encounter in the course of the game. It contains all the money that is available for non-player characters to use in making change. If we wanted, we could give each character his own stash of change, but this would increase the likelihood that any given person would run out of cash to make change with. (And in this example there is only one vendor anyway.)</p>
<!-- START CODE "c4795_108" -->
<a id="c4795_108"></a><blockquote class="code"><p class="quoted">
The cashbox is a container. The cashbox contains 10 pennies. The cashbox contains 10 nickels.  The cashbox contains 10 dimes.  The cashbox contains 10 quarters.  The cashbox contains 10 dollar bills.  The cashbox contains 10 five-dollar bills.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4796_108" -->
<a id="c4796_108"></a><blockquote class="code"><p class="quoted">
The block buying rule is not listed in the check buying rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4797_108" -->
<a id="c4797_108"></a><blockquote class="code"><p class="quoted">
Check buying something:
<br />&#160;&#160;&#160;&#160;if the noun is not for sale, say &quot;[The owner of the noun] does not want to sell you [the noun].&quot; instead;
<br />&#160;&#160;&#160;&#160;if the player's cash is less than the price of the noun, say &quot;You can't afford the asking price of [the price of the noun] for [the noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4798_108" -->
<a id="c4798_108"></a><blockquote class="code"><p class="quoted">
Carry out buying something:
<br />&#160;&#160;&#160;&#160;let sum paid be $0.00;
<br />&#160;&#160;&#160;&#160;while sum paid is less than the price of the noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let current target be the price of the noun minus the sum paid;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let bill offered be the best money from the player for the current target;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the bill offered is money:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the bill offered to the owner of the noun;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the bill offered is spent;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increase the sum paid by the price of the bill offered;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let current target be the price of the noun minus the sum paid;
<br />&#160;&#160;&#160;&#160;say &quot;You hand [the owner of the noun] [a list of spent money]. [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;let change be $0.00;
<br />&#160;&#160;&#160;&#160;if the sum paid is greater than the price of the noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the change is the sum paid minus the price of the noun;
<br />&#160;&#160;&#160;&#160;if change is greater than the sum in the cashbox:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the player carries every spent money;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now every spent thing is fresh;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;'Whoa,' says [the owner of the noun], handing the cash back to you. 'I can't make change for that, man, sorry.'&quot; instead;
<br />&#160;&#160;&#160;&#160;now every spent thing is in the cashbox;
<br />&#160;&#160;&#160;&#160;now every spent thing is fresh;
<br />&#160;&#160;&#160;&#160;while change is greater than $0.00:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let change bill be the best money from the cashbox for change;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;decrease change by the price of the change bill;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now change bill is spent;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move change bill to player;
<br />&#160;&#160;&#160;&#160;if money is spent, say &quot;[The owner of the noun] makes change with [a list of spent money]. [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;now every spent thing is fresh;
<br />&#160;&#160;&#160;&#160;if the noun is not enclosed by the player and the owner of the noun can touch the noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;'Here ya go,' says [the owner of the noun], handing [the noun] to you. [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the noun to the player;
<br />&#160;&#160;&#160;&#160;now the player owns the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4799_108" -->
<a id="c4799_108"></a><blockquote class="code"><p class="quoted">
Money can be spent or fresh.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4800_108" -->
<a id="c4800_108"></a><blockquote class="code"><p class="quoted">
Report buying something:
<br />&#160;&#160;&#160;&#160;if the player owns the noun,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Your transaction is now complete, leaving you with [the player's cash].&quot;
</p></blockquote>
<!-- END CODE -->
<p>We've skipped over defining what makes a denomination the best for a given transaction, so we'd better do that now. Our goal is to avoid ever having the player gratuitously overpay -- he should always offer the smallest amount of money that will meet the price of what he's buying.</p>
<p>We also assume that all money &quot;enclosed by the buyer&quot; -- that is, somewhere in the buyer's possession -- is available for use. This might not be true in a game where the player could pick up, say, a sealed lucite container with a ten-dollar bill inside; in that case we would have to define our terms more rigorously, perhaps by requiring that the bills be both enclosed and touchable by the buyer. The touchability check adds an extra layer of calculation, however, and since it is not necessary in this example (and probably not in most other cases either), we'll leave it out:</p>
<!-- START CODE "c4801_108" -->
<a id="c4801_108"></a><blockquote class="code"><p class="quoted">
Definition: money is costly if its price is $2.50 or more. Definition: money is cheap if its price is $0.99 or less.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4802_108" -->
<a id="c4802_108"></a><blockquote class="code"><p class="quoted">
Functional relation is a kind of value. The functional relations are overpayment, underpayment and irrelevant. Money has a functional relation.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4803_108" -->
<a id="c4803_108"></a><blockquote class="code"><p class="quoted">
To decide what money is the best money from (buyer - a thing) for (cost - a price):
<br />&#160;&#160;&#160;&#160;repeat with bill offered running through money:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the bill offered is enclosed by the buyer:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the price of the bill offered is the cost, decide on the bill offered;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the price of the bill offered is greater than the cost, now the functional relation of bill offered is overpayment;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise now the functional relation of the bill offered is underpayment;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the functional relation of the bill offered is irrelevant;
<br />&#160;&#160;&#160;&#160;[say &quot;underpayment: [a list of underpayment money]
<br />&#160;&#160;&#160;&#160;overpayment: [a list of overpayment money]&quot;;]
<br />&#160;&#160;&#160;&#160;if the total price of underpayment money is less than the cost:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;decide on the cheapest money which is overpayment;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;decide on the costliest money which is underpayment.
</p></blockquote>
<!-- END CODE -->
<p>Notice the &quot;say underpayment/overpayment section...&quot; noted out, above. This is for debugging purposes: when writing complex code, it is sometimes useful to put in lines that will say explicitly what is going on. We can enclose them in brackets and Inform will ignore them as though they were comments; if we run into any problems with the code later, we can erase the brackets and see the diagnostic printed to the screen as we play.</p>
<!-- START CODE "c4804_108" -->
<a id="c4804_108"></a><blockquote class="code"><p class="quoted">
Instead of giving money to someone:
<br />&#160;&#160;&#160;&#160;say &quot;Best to keep the transaction simple by buying whatever you want.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4805_108" -->
<a id="c4805_108"></a><blockquote class="code"><p class="quoted">
Section 4 - The Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4806_108" -->
<a id="c4806_108"></a><blockquote class="code"><p class="quoted">
The player carries 2 dollar bills. The player carries a nickel. The player carries 2 pennies. The player carries a five-dollar bill. The player carries 1 hundred-dollar bill.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4807_108" -->
<a id="c4807_108"></a><blockquote class="code"><p class="quoted">
The Subway Station is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4808_108" -->
<a id="c4808_108"></a><blockquote class="code"><p class="quoted">
The Bitterly Cold Street is north of the Subway Station. &quot;Even though there is no actual snow or ice, the street is about as cold as you can stand, for which reason walking the twenty blocks uptown is not an acceptable option.&quot; The Bitterly Cold Street contains a dollar bill.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4809_108" -->
<a id="c4809_108"></a><blockquote class="code"><p class="quoted">
The newspaper man is a man in the Subway Station. &quot;A newspaper man in a knit cap and fingerless gloves is hopping up and down behind his stand[if the turn count is 1]. Cold weather, caffeine overdose, or mental illness? You may never know. Welcome to New York[end if].&quot; The description is &quot;Eye contact with strangers is something to avoid around here.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4810_108" -->
<a id="c4810_108"></a><blockquote class="code"><p class="quoted">
The stand is a supporter in the Station. The stand is scenery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4811_108" -->
<a id="c4811_108"></a><blockquote class="code"><p class="quoted">
A copy of the New York Times is on the stand. The price of the New York Times is $1.25.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4812_108" -->
<a id="c4812_108"></a><blockquote class="code"><p class="quoted">
A pack of gum is on the stand. The price of the gum is $0.40.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4813_108" -->
<a id="c4813_108"></a><blockquote class="code"><p class="quoted">
A paperback novel is on the stand. The price of the paperback novel is $7.99.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4814_108" -->
<a id="c4814_108"></a><blockquote class="code"><p class="quoted">
A packet of trading cards is on the stand. The price of the packet is $0.99.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4815_108" -->
<a id="c4815_108"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;now every thing on the stand is owned by the newspaper man;
<br />&#160;&#160;&#160;&#160;now every thing on the stand is for sale.
</p></blockquote>
<!-- END CODE -->
<p>We could have done all that by hand, but the initialization requires a little less work.</p>
<!-- START CODE "c4816_108" -->
<a id="c4816_108"></a><blockquote class="code"><p class="quoted">
The ticket machine is a container in the Subway Station. It is fixed in place. The description of the ticket machine is &quot;An LED screen on the front instructs you to insert [remaining ticket total] to complete your purchase. You also notice that the NO CHANGE light is lit up.&quot; The light is part of the ticket machine. The printed name of the light is &quot;no change light&quot;. Understand &quot;no change&quot; or &quot;no change light&quot; as the light.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4817_108" -->
<a id="c4817_108"></a><blockquote class="code"><p class="quoted">
The description of the light is &quot;In the whole of your recollection, the ticket machine has actually had change a total of twice. Usually, as now, the no-change light gleams angrily, daring you to put in more than you owe.&quot; A cash return button is part of the ticket machine. Instead of pushing the cash return button: say &quot;The ticket machine regurgitates [the list of things in the ticket machine].&quot;; now every thing in the ticket machine is carried by the player. Instead of taking something which is in the ticket machine: say &quot;The ticket machine has swallowed your money, but it can be retrieved (you hope) with the cash return button.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4818_108" -->
<a id="c4818_108"></a><blockquote class="code"><p class="quoted">
Instead of inserting a hundred-dollar bill into the ticket machine:
<br />&#160;&#160;&#160;&#160;say &quot;What, are you nuts?&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4819_108" -->
<a id="c4819_108"></a><blockquote class="code"><p class="quoted">
To decide what price is the remaining ticket total:
<br />&#160;&#160;&#160;&#160;let absolute cost be $2.25;
<br />&#160;&#160;&#160;&#160;let remaining cost be absolute cost minus the total price of things in the ticket machine;
<br />&#160;&#160;&#160;&#160;if remaining cost is less than $0.00, decide on $0.00;
<br />&#160;&#160;&#160;&#160;decide on remaining cost.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4820_108" -->
<a id="c4820_108"></a><blockquote class="code"><p class="quoted">
Instead of inserting something which is not money into the ticket machine: say &quot;The ticket machine only accepts money, not other tokens of your esteem and regard.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4821_108" -->
<a id="c4821_108"></a><blockquote class="code"><p class="quoted">
Instead of inserting a penny into the ticket machine:
<br />&#160;&#160;&#160;&#160;say &quot;The penny rattles out again mockingly: not even the ticket machine thinks these are worth anything.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4822_108" -->
<a id="c4822_108"></a><blockquote class="code"><p class="quoted">
A subway pass is a kind of thing. 15 subway passes are in the cashbox. The description of a subway pass is usually &quot;A rectangle of thick lavender paper with a black magnetic stripe running up the back side. It is good for one trip on the subway.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4823_108" -->
<a id="c4823_108"></a><blockquote class="code"><p class="quoted">
After inserting something into the ticket machine:
<br />&#160;&#160;&#160;&#160;if the remaining ticket total is $0.00:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let purchased ticket be a random subway pass in the cashbox;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if purchased ticket is not a subway pass, say &quot;The ticket machine grunts disobligingly and then the unwelcome word MALFUNCTION parades across the LED screen, three letters at a time.&quot; instead;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with item running through things in the machine:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the item is nowhere;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move purchased ticket to player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;The ticket machine beeps obligingly and disgorges a single subway pass.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;The ticket machine beeps obligingly and adjusts its price down to [remaining ticket total].&quot;
</p></blockquote>
<!-- END CODE -->
<p>And because even though the ticket machine is a container, we don't want to say (empty) after it in the room description:</p>
<!-- START CODE "c4824_108" -->
<a id="c4824_108"></a><blockquote class="code"><p class="quoted">
Rule for printing room description details of the ticket machine:
<br />&#160;&#160;&#160;&#160;do nothing instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4825_108" -->
<a id="c4825_108"></a><blockquote class="code"><p class="quoted">
Test me with &quot;buy novel / n / get dollar / s / buy novel&quot;.
</p></blockquote>
<!-- END CODE -->
<p>After all that, we should probably give the player a chance to win, as well:</p>
<!-- START CODE "c4826_108" -->
<a id="c4826_108"></a><blockquote class="code"><p class="quoted">
The turnstile is south of the Subway Station. &quot;A turnstile is all that separates you from the subway platform stairs.&quot; The turnstile is north of the Platform. The turnstile is a door. Before going down in the presence of the turnstile, try going south instead. The turnstile is openable. The turnstile is open.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4827_108" -->
<a id="c4827_108"></a><blockquote class="code"><p class="quoted">
Instead of going through the turnstile when the player carries a subway pass: say &quot;You enter the turnstile and begin your journey uptown...&quot;; end the story finally saying &quot;At last&quot;. Instead of going through the turnstile: say &quot;You can't go through the turnstile without a subway pass. They're very strict about this.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4828_108" -->
<a id="c4828_108"></a><blockquote class="code"><p class="quoted">
Instead of inserting money into the turnstile: say &quot;The turnstile takes passes, not money.&quot; Instead of inserting a subway pass into the turnstile, try entering the turnstile.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c4829_108" -->
<a id="c4829_108"></a><blockquote class="code"><p class="quoted">
Test more with &quot;buy times / put all but five-dollar bill in machine / press button / buy gum / buy cards / i / put dollar in machine / g / put quarter in machine / i / d&quot;.
</p></blockquote>
<!-- END CODE -->
<p>In fairness to the Metropolitan Transit Authority, we should admit that most of the ticketing machines in the real New York subway are better than this, and will accept, say, a debit card. But that would be so much less exciting to implement.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc241.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc243.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
