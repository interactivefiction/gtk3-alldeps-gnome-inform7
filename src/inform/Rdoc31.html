<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>6.3. Modifying Existing Commands</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Modifying Existing Commands" -->
<!-- SEARCH SECTION "6.3" -->
<!-- SEARCH SORT "001-006-003-000" -->
<!-- START IGNORE 30 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="Rdoc30.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 6: Commands</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="Rdoc32.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง6.3. Modifying Existing Commands</p>
<p>Much of the rest of this chapter discusses the behavior of specific commands in Inform's command library, and how we might change and build on these. This section is instead an overview of the general principles: where and how can one intervene?</p>
<p>Whenever we are dealing with actions, the Actions Index is likely to be useful: it lists all the actions currently implemented, whether in our own source or in extensions or the Standard Rules, and lists the rules pertaining to each.</p>
<p>The lightest and easiest way to change behavior is with an Instead rule:</p>
<!-- START CODE "c11398" -->
<a id="c11398"></a><blockquote class="code"><p class="quoted">
Instead of eating the apple:
<br />&#160;&#160;&#160;&#160;say &quot;It turns out to be made of beeswax, so that's a non-starter.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11399" -->
<a id="c11399"></a><blockquote class="code"><p class="quoted">
Instead of tasting an edible thing:
<br />&#160;&#160;&#160;&#160;say &quot;It's delicious!&quot;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<p>The addition of &quot;rule succeeds&quot; tells Inform that the instead action was a success rather than a failure; this is not usually very important with the player's own actions, but can be useful for actions performed by other characters, so that a successfully replaced action is not followed by the disconcerting line</p>
<!-- START CODE "c11400" -->
<a id="c11400"></a><blockquote class="code"><p class="quoted">
Clark is unable to do that.
</p></blockquote>
<!-- END CODE -->
<p>Before and After offer alternative easy forms of modification; the Basic Actions chapter explains all three.</p>
<p>Changing the way an action works in all cases is usually better addressed by changing the main rulebook, rather than with one (or many) instead rules. We may add new check, carry out, and report rules to existing action rulebooks. The Advanced Actions chapter describes these, and ends with some guidelines on when to use before, instead, and after, and when to use check, carry out, and report.</p>
<p>Similarly, we may delete, move, or replace rules that are already present (see the chapter on Rulebooks). This is handy if we decide that an action has restrictions that we dislike and want to abolish. If the restriction we need to change is part of the accessibility rules - those which check whether the player can take, see, and touch items - we may need to look at Changing reachability or Changing visibility in the Advanced Actions chapter (to revise what is allowed), at Deciding the scope of something in the Activities chapter (to influence what can be seen when).</p>
<p>If, for instance, the player character is a burly fellow who can lift any other character he likes:</p>
<!-- START CODE "c11401" -->
<a id="c11401"></a><blockquote class="code"><p class="quoted">
The can't take other people rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<p>...and rip knobs off doors:</p>
<!-- START CODE "c11402" -->
<a id="c11402"></a><blockquote class="code"><p class="quoted">
The can't take component parts rule is not listed in the check taking rulebook.
</p></blockquote>
<!-- END CODE -->
<p>...and commit petty theft:</p>
<!-- START CODE "c11403" -->
<a id="c11403"></a><blockquote class="code"><p class="quoted">
The new can't take people's possessions rule is listed instead of the can't take people's possessions rule in the check taking rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11404" -->
<a id="c11404"></a><blockquote class="code"><p class="quoted">
This is the new can't take people's possessions rule:
<br />&#160;&#160;&#160;&#160;if someone (called the owner) carries the noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;(first waiting until [the owner] is distracted)&quot;;
</p></blockquote>
<!-- END CODE -->
<p>The right approach to use also depends a bit on how systematic a change we anticipate. We may find that instead rules become cumbersome when we want to specify behavior for a very large number of objects. It's fine to have</p>
<!-- START CODE "c11405" -->
<a id="c11405"></a><blockquote class="code"><p class="quoted">
Instead of tasting the arsenic:
<br />&#160;&#160;&#160;&#160;say &quot;You'll live to regret this very very shortly.&quot;;
<br />&#160;&#160;&#160;&#160;end the story.
</p></blockquote>
<!-- END CODE -->
<p>but a bit more tedious to have to write</p>
<!-- START CODE "c11406" -->
<a id="c11406"></a><blockquote class="code"><p class="quoted">
Instead of tasting the peppermint: ...
<br />Instead of tasting the plate: ...
<br />Instead of tasting the banister: ...
<br />Instead of tasting the donkey: ...
<br />(etc.)
</p></blockquote>
<!-- END CODE -->
<p>in a story in which most items have unique flavor descriptions. In that situation, it may be more sensible to overhaul the design of the action: create a new text property for things, and revise &quot;tasting&quot; so that it now consults this property:</p>
<!-- START CODE "c11407" -->
<a id="c11407"></a><blockquote class="code"><p class="quoted">
The block tasting rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11408" -->
<a id="c11408"></a><blockquote class="code"><p class="quoted">
A thing has some text called the flavor. The flavor of a thing is usually &quot;Nothing special.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11409" -->
<a id="c11409"></a><blockquote class="code"><p class="quoted">
Report tasting something:
<br />&#160;&#160;&#160;&#160;if the flavor of the noun is &quot;Nothing special.&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You taste nothing unexpected.&quot; instead;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[the flavor of the noun][paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11410" -->
<a id="c11410"></a><blockquote class="code"><p class="quoted">
Report someone tasting something:
<br />&#160;&#160;&#160;&#160;say &quot;[The actor] licks [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>Finally and most sweepingly, we can rip out whole passages of the Standard Rules and replace them - or not. This is a drastic measure and rarely necessary (or so we hope); but see the Extensions chapter for ways to replace sections of existing source, or even revise the Inform 6 template files on which Inform depends. By these means almost anything can be changed. We can throw out a whole range of existing commands and start from scratch, for instance, if we want Inform to know about a completely new and different command set.</p>
<p class="crossreference"><a href="Rdoc89.html" class="xreflink"><img class="asterisk" alt="*" src="inform:/doc_images/xref.png" />&#160;<i>See </i><b>Magic (Breaking the Laws of Physics)</b></a><i> for a hat that lets the player walk through closed doors, and an NPC able to reach through solid containers</i></p><hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "214: Slogar's Revenge" "e206" -->
<a id="e206"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example206'); return false;"><b>214</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example206'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Slogar's Revenge</span></b></a><br />Creating an amulet of tumblers that can be used to lock and unlock things even when it is worn, overriding the usual requirement that keys be carried.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc193.html#e206"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example206" style="display: none;">
<p>Under most circumstances, locking and unlocking require the player to be carrying the key he uses to unlock something. This makes sense -- unless the key is on a keychain, or on a chain around his neck, for instance. So here we explore one way to circumstantially override the carrying requirements, while still making sure that the player cannot unlock the door if the unlocking tool is nowhere in sight.</p>
<p>In essence, we are rewriting the carrying requirements rule with a different one of our own devising, and swapping it in only at those moments when it is correct to do so.</p>
<!-- START CODE "c11411_206" -->
<a id="c11411_206"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Slogar[=0x0027=]s Revenge[=0x0022=][=0x000A=][=0x000A=]Section 1 - Procedure[=0x000A=][=0x000A=]The amulet carrying rule substitutes for the carrying requirements rule when locking something with the Amulet of Tumblers.[=0x000A=][=0x000A=]The amulet carrying rule substitutes for the carrying requirements rule when unlocking something with the Amulet of Tumblers.[=0x000A=][=0x000A=][We can now replace the usual behavior of the carrying requirements rule (to check whether the player is carrying something and, if not, to generate an implicit take) with a similar rule of our own; note that [=0x0022=]if the player has the second noun[=0x0022=] is a more compact way to write [=0x0022=]if the player carries the second noun or the player wears the second noun[=0x0022=]:][=0x000A=][=0x000A=]This is the amulet carrying rule:[=0x000A=][=0x0009=]if the player has the second noun:[=0x000A=][=0x0009=][=0x0009=]continue the action;[=0x000A=][=0x0009=]say [=0x0022=](first picking up the amulet)[command clarification break][=0x0022=];[=0x000A=][=0x0009=]try silently taking the second noun;[=0x000A=][=0x0009=]if the player is not carrying the second noun:[=0x000A=][=0x0009=][=0x0009=]stop the action;[=0x000A=][=0x000A=]Section 2 - Scenario[=0x000A=][=0x000A=]The Daunting Dungeon is a room.[=0x000A=][=0x000A=]West of the Daunting Dungeon is the Disturbing Door. The Disturbing Door is a door. West of the Disturbing Door is the Fallow Field.[=0x000A=][=0x000A=]The Disturbing Door is closed and locked.[=0x000A=][=0x000A=]The player wears the Amulet of Tumblers. The Amulet of Tumblers unlocks the Disturbing Door.[=0x000A=][=0x000A=]Test me with [=0x0022=]unlock disturbing door with amulet / open door / west / remove amulet / close door / lock disturbing door with amulet / drop amulet / unlock disturbing door with amulet[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Slogar's Revenge&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11412_206" -->
<a id="c11412_206"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11413_206" -->
<a id="c11413_206"></a><blockquote class="code"><p class="quoted">
The amulet carrying rule substitutes for the carrying requirements rule when locking something with the Amulet of Tumblers.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11414_206" -->
<a id="c11414_206"></a><blockquote class="code"><p class="quoted">
The amulet carrying rule substitutes for the carrying requirements rule when unlocking something with the Amulet of Tumblers.
</p></blockquote>
<!-- END CODE -->
<p>We can now replace the usual behavior of the carrying requirements rule (to check whether the player is carrying something and, if not, to generate an implicit take) with a similar rule of our own; note that &quot;if the player has the second noun&quot; is a more compact way to write &quot;if the player carries the second noun or the player wears the second noun&quot;:</p>
<!-- START CODE "c11415_206" -->
<a id="c11415_206"></a><blockquote class="code"><p class="quoted">
This is the amulet carrying rule:
<br />&#160;&#160;&#160;&#160;if the player has the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;continue the action;
<br />&#160;&#160;&#160;&#160;say &quot;(first picking up the amulet)[command clarification break]&quot;;
<br />&#160;&#160;&#160;&#160;try silently taking the second noun;
<br />&#160;&#160;&#160;&#160;if the player is not carrying the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;stop the action;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11416_206" -->
<a id="c11416_206"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11417_206" -->
<a id="c11417_206"></a><blockquote class="code"><p class="quoted">
The Daunting Dungeon is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11418_206" -->
<a id="c11418_206"></a><blockquote class="code"><p class="quoted">
West of the Daunting Dungeon is the Disturbing Door. The Disturbing Door is a door. West of the Disturbing Door is the Fallow Field.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11419_206" -->
<a id="c11419_206"></a><blockquote class="code"><p class="quoted">
The Disturbing Door is closed and locked.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11420_206" -->
<a id="c11420_206"></a><blockquote class="code"><p class="quoted">
The player wears the Amulet of Tumblers. The Amulet of Tumblers unlocks the Disturbing Door.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c11421_206" -->
<a id="c11421_206"></a><blockquote class="code"><p class="quoted">
Test me with &quot;unlock disturbing door with amulet / open door / west / remove amulet / close door / lock disturbing door with amulet / drop amulet / unlock disturbing door with amulet&quot;.
</p></blockquote>
<!-- END CODE -->
<p>For a more systematic handling of the keychain problem (and a number of other refinements to the behavior of doors), see the Locksmith extension included with Inform.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="Rdoc30.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="Rdoc32.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
