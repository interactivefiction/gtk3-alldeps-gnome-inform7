<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>11.10. Repeat</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Repeat" -->
<!-- SEARCH SECTION "11.10" -->
<!-- SEARCH SORT "000-011-010-000" -->
<!-- START IGNORE 167 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="doc167.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 11: Phrases</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="doc169.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง11.10. Repeat</p>
<p>The other kind of loop in Inform is &quot;repeat&quot;. The trouble with &quot;while&quot; is that it's not obvious at a glance when or whether the loop will finish, and nor is there any book-keeping to measure progress. A &quot;repeat&quot; loop is much more predictable, and is more or less certain to finish.</p>
<p>There are several forms of &quot;repeat&quot;, of which the simplest is similar to the old FOR/NEXT loop from the home-computer programming language BASIC, for those with long memories:</p>
<!-- START PHRASE "defn129" -->
<div class="definition"><a id="defn129"></a><p class="defnprototype"><b>repeat with </b>(a name not so far used)<b> running from </b>(arithmetic value)<b> to </b>(arithmetic value)<b></b></p><br /><i>or:</i>&#160;&#160;&#160;<p class="defnprototype"><b>repeat with </b>(a name not so far used)<b> running from </b>(enumerated value)<b> to </b>(enumerated value)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_repeat -->

<p>This phrase causes the block of phrases following it to be repeated once for each value in the given range, storing that value in the named variable. (The variable exists only temporarily, within the repetition.) Example:</p>
<!-- START CODE "c2942" -->
<a id="c2942"></a><blockquote class="code"><p class="quoted">
repeat with counter running from 1 to 10:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>This, and runs through the given phrases ten times. Within those phrases, a special value called &quot;counter&quot; has the value 1 the first time through, then the value 2, then 3 and so on up to 10. (It can of course be called whatever we like: this is only an example.) The range can be from any kind where ranges make sense - anything on which arithmetic can be done, so for instance</p>
<!-- START CODE "c2943" -->
<a id="c2943"></a><blockquote class="code"><p class="quoted">
repeat with moment running from 4 PM to 4:07 PM:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>and also any enumeration:</p>
<!-- START CODE "c2944" -->
<a id="c2944"></a><blockquote class="code"><p class="quoted">
Colour is a kind of value. The colours are red, orange, yellow, green, blue, indigo and violet.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2945" -->
<a id="c2945"></a><blockquote class="code"><p class="quoted">
...
<br />&#160;&#160;&#160;&#160;repeat with hue running from orange to indigo:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>We are allowed to &quot;nest&quot; loops, that is, to put one inside another.</p>
<!-- START CODE "c2946" -->
<a id="c2946"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('To plot a grid with size (S - a number):[=0x000A=][=0x0009=]repeat with x running from 1 to S:[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=]Row [x]:[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]repeat with y running from 1 to S:[=0x000A=][=0x0009=][=0x0009=][=0x0009=]say [=0x0022=] [y][=0x0022=];[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=].[=0x0022=][=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> To plot a grid with size (S - a number):
<br />&#160;&#160;&#160;&#160;repeat with x running from 1 to S:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Row [x]:&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with y running from 1 to S:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot; [y]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;.&quot;
</p></blockquote>
<!-- END CODE -->
<p>If we then write</p>
<!-- START CODE "c2947" -->
<a id="c2947"></a><blockquote class="code"><p class="quoted">
plot a grid with size 5;
</p></blockquote>
<!-- END CODE -->
<p>then the result is</p>
<!-- START CODE "c2948" -->
<a id="c2948"></a><blockquote class="code"><p class="quoted">
Row 1: 1 2 3 4 5.
<br />Row 2: 1 2 3 4 5.
<br />Row 3: 1 2 3 4 5.
<br />Row 4: 1 2 3 4 5.
<br />Row 5: 1 2 3 4 5.
</p></blockquote>
<!-- END CODE -->
<p>Thus the innermost phrase, the say which mentions &quot;y&quot;, happens 25 times.</p>
<p>Whenever dealing with numbers in Inform we may need to remember that if the Settings for the project are set to use the Z-machine, the range is restricted to -32768 up to 32767. Repeating with a counter up to exactly 32767 is hazardous, because the counter can never break through this barrier: it's infinity, so far as Inform is concerned, and that can cause the repetitions to go on forever. (On Glulx, numbers can be very much larger.)</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "175: Wonka's Revenge" "e121" -->
<a id="e121"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example121'); return false;"><b>175</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example121'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Wonka's Revenge</span></b></a><br />A lottery drum which redistributes the tickets inside whenever the player spins it.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="Rdoc72.html#e121"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example121" style="display: none;">
<!-- START CODE "c2949_121" -->
<a id="c2949_121"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Wonka[=0x0027=]s Revenge[=0x0022=][=0x000A=][=0x000A=]The Caribou Lodge is a room. [=0x0022=]Hundreds of expectant faces are turned your way from every table.[=0x0022=] A lottery drum is in the Lodge. [=0x0022=]Before you is the lottery drum[if we have spun the drum], ready to disgorge a ticket[otherwise], waiting to be spun[end if].[=0x0022=] In the drum are a red ticket, an orange ticket, a yellow ticket, a green ticket, a blue ticket, a purple ticket, and a ticket of pure gold. The drum is closed and openable.[=0x000A=][=0x000A=]Understand [=0x0022=]spin [something][=0x0022=] as spinning.[=0x000A=][=0x000A=]Spinning is an action applying to one thing.[=0x000A=][=0x000A=]Check spinning: if the noun is an open container which contains something, say [=0x0022=][The list of things in the noun] would fly out.[=0x0022=] instead.[=0x000A=][=0x000A=]Carry out spinning a container:[=0x000A=][=0x0009=]shuffle the contents of the noun.[=0x000A=][=0x000A=]Report spinning:[=0x000A=][=0x0009=]if the noun contains something, say [=0x0022=]You rattle [if the noun is transparent][the list of things in the noun][otherwise]the stuff[end if] in [the noun].[=0x0022=];[=0x000A=][=0x0009=]otherwise say [=0x0022=]Nothing results of your shaking [the noun].[=0x0022=][=0x000A=][=0x000A=][Inform keeps track of the order in which things have been put into a container. If we want to change that order without the player[=0x0027=]s intervention, we can move the things ourselves.][=0x000A=][=0x000A=]To shuffle the contents of (basket - a container):[=0x000A=][=0x0009=]let moves be the number of things in the basket;[=0x000A=][=0x0009=]repeat with counter running from 1 to moves:[=0x000A=][=0x0009=][=0x0009=]move a random thing in the basket to the basket.[=0x000A=][=0x000A=]After opening the drum when we have spun the drum for the first time:[=0x000A=][=0x0009=]if something (called the pick) is in the drum:[=0x000A=][=0x0009=][=0x0009=]try searching the drum;[=0x000A=][=0x0009=][=0x0009=]say [=0x0022=][The pick] it is, then.[=0x0022=];[=0x000A=][=0x0009=][=0x0009=]silently try taking the pick;[=0x000A=][=0x0009=][=0x0009=]if the pick is the ticket of pure gold, end the story finally;[=0x000A=][=0x0009=][=0x0009=]otherwise end the story saying [=0x0022=]Oh well, better luck next time.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]open drum / look in drum / close drum / spin drum / open drum[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Wonka's Revenge&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2950_121" -->
<a id="c2950_121"></a><blockquote class="code"><p class="quoted">
The Caribou Lodge is a room. &quot;Hundreds of expectant faces are turned your way from every table.&quot; A lottery drum is in the Lodge. &quot;Before you is the lottery drum[if we have spun the drum], ready to disgorge a ticket[otherwise], waiting to be spun[end if].&quot; In the drum are a red ticket, an orange ticket, a yellow ticket, a green ticket, a blue ticket, a purple ticket, and a ticket of pure gold. The drum is closed and openable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2951_121" -->
<a id="c2951_121"></a><blockquote class="code"><p class="quoted">
Understand &quot;spin [something]&quot; as spinning.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2952_121" -->
<a id="c2952_121"></a><blockquote class="code"><p class="quoted">
Spinning is an action applying to one thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2953_121" -->
<a id="c2953_121"></a><blockquote class="code"><p class="quoted">
Check spinning: if the noun is an open container which contains something, say &quot;[The list of things in the noun] would fly out.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2954_121" -->
<a id="c2954_121"></a><blockquote class="code"><p class="quoted">
Carry out spinning a container:
<br />&#160;&#160;&#160;&#160;shuffle the contents of the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2955_121" -->
<a id="c2955_121"></a><blockquote class="code"><p class="quoted">
Report spinning:
<br />&#160;&#160;&#160;&#160;if the noun contains something, say &quot;You rattle [if the noun is transparent][the list of things in the noun][otherwise]the stuff[end if] in [the noun].&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;Nothing results of your shaking [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>Inform keeps track of the order in which things have been put into a container. If we want to change that order without the player's intervention, we can move the things ourselves.</p>
<!-- START CODE "c2956_121" -->
<a id="c2956_121"></a><blockquote class="code"><p class="quoted">
To shuffle the contents of (basket - a container):
<br />&#160;&#160;&#160;&#160;let moves be the number of things in the basket;
<br />&#160;&#160;&#160;&#160;repeat with counter running from 1 to moves:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move a random thing in the basket to the basket.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2957_121" -->
<a id="c2957_121"></a><blockquote class="code"><p class="quoted">
After opening the drum when we have spun the drum for the first time:
<br />&#160;&#160;&#160;&#160;if something (called the pick) is in the drum:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try searching the drum;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The pick] it is, then.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;silently try taking the pick;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the pick is the ticket of pure gold, end the story finally;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise end the story saying &quot;Oh well, better luck next time.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c2958_121" -->
<a id="c2958_121"></a><blockquote class="code"><p class="quoted">
Test me with &quot;open drum / look in drum / close drum / spin drum / open drum&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="doc167.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="doc169.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
