<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Generated by indoc on 24 Dec 2015 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_RB.css" rel="stylesheet" type="text/css" />
<title>6.17. Clarification and Correction</title>
<script type="text/javascript">
    function showExtra(id, imid) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
            document.getElementById(imid).src = 'inform:/doc_images/extra.png';
        } else {
            document.getElementById(id).style.display = 'block';
            document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
        }
    }
    function onLoaded() {
        if (window.location.hash) {
            var hash = window.location.hash.substring(2);
            if (hash.search("_") >= 0) {
                var res = hash.split("_");
                showExample("example"+res[1]);
            } else {
                showExample("example"+hash);
            }
        }
    }
    window.onload=onLoaded;
    function showExample(id) {
        if (document.getElementById(id).style.display == 'block') {
            document.getElementById(id).style.display = 'none';
        } else {
            document.getElementById(id).style.display = 'block';
        }
    }
    function openExtra(id, imid) {
        document.getElementById(id).style.display = 'block';
        document.getElementById(imid).src = 'inform:/doc_images/extraclose.png';
    }
    function closeExtra(id, imid) {
        document.getElementById(id).style.display = 'none';
        document.getElementById(imid).src = 'inform:/doc_images/extra.png';
    }
</script>
</head>
<body class="paper papertint"><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<script language="JavaScript">
function createNewProject(code, title) {
    var myProject = window.Project;

    myProject.createNewProject(title, code);
}
</script>

<!-- SEARCH TITLE "Clarification and Correction" -->
<!-- SEARCH SECTION "6.17" -->
<!-- SEARCH SORT "001-006-017-000" -->
<!-- START IGNORE 44 -->
<div class="bookheader">
<table class="fullwidth midnightblack"><tr><td class="midnightbannerleftcell"><a href="Rdoc44.html" class="standardlink"><img alt="Hookleft.png" src="inform:/doc_images/Hookleft.png" id="hookleft" /></a></td><td class="midnightbannercentrecell"><a href="index.html" class="standardlink"><span class="midnightbannertext">Chapter 6: Commands</span></a></td><td class="midnightbannerrightcell"><a href="index.html" class="standardlink"><img alt="Hookup.png" src="inform:/doc_images/Hookup.png" id="hookup" /></a><a href="Rdoc46.html" class="standardlink"><img alt="Hookright.png" src="inform:/doc_images/Hookright.png" id="hookright" /></a></td></tr></table></div>
<!-- END IGNORE -->
<p class="sectionheading">ยง6.17. Clarification and Correction</p>
<p>Some commands and some objects raise special challenges when it comes to working out the player's intention.</p>
<p>Sometimes this can be done with good rules about the assumptions Inform should make. <span class="boldface">Alpaca Farm</span> demonstrates a USE command, always a challenge because USE can mean very different actions with different items.</p>
<p>There are also times when we need to ask the player for more information. <span class="boldface">Apples</span> demonstrates how sensibly to use properties to disambiguate between similar objects, while <span class="boldface">Walls and Noses</span> rephrases the disambiguation question when special objects are involved: examining one of the walls of the room will make the story ask &quot;In which direction?&quot; and EXAMINE NOSE will lead to &quot;Whose nose do you mean, Frederica's, Betty's, Wilma's or your own?&quot;</p>
<p>At other times, the player types something that is wrong in a predictable way: for instance, we might want to remove all the &quot;with...&quot; phrases from commands like</p>
<!-- START CODE "c12048" -->
<a id="c12048"></a><blockquote class="code"><p class="quoted">
HIT DOOR WITH FIST
<br />KICK DRAGON WITH FOOT
<br />LOOK WEST WITH EYES
</p></blockquote>
<!-- END CODE -->
<p>and merely parse the remainder of the command. (That last command may be unlikely, but novice players do quite often type commands that refer unnecessarily to body parts.) <span class="boldface">Cave-troll</span> demonstrates how.</p>
<p><span class="boldface">WXPQ</span> demonstrates how to modify the error message the parser gives in response to a command it doesn't understand; this particular example focuses on the &quot;That noun doesn't make sense in this context&quot; message that arises from using the &quot;[any thing]&quot; or &quot;[any room]&quot; tokens, but the techniques could be adapted to handling other parser errors as well.</p>
<p>For catching typing errors, Cedric Knight's extension Mistype may also be of use: it provides an automatic typo-correction function that the player can turn on or off.</p>
<hr />
<div class="bookexamples">
<p class="chapterheading"></p><!-- START EXAMPLE "290: Alpaca Farm" "e166" -->
<a id="e166"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example166'); return false;"><b>290</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example166'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Alpaca Farm</span></b></a><br />A generic USE action which behaves sensibly with a range of different objects.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc266.html#e166"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example166" style="display: none;">
<p>This example takes the ordering of grammar lines to its logical extreme, sorting the player's input into different categories depending on the kind and condition of the objects mentioned.</p>
<!-- START CODE "c12049_166" -->
<a id="c12049_166"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Alpaca Farm[=0x0022=][=0x000A=][=0x000A=]Understand [=0x0022=]use [an edible thing][=0x0022=] as eating.[=0x000A=][=0x000A=]Understand [=0x0022=]use [a wearable thing][=0x0022=] as wearing.[=0x000A=][=0x000A=]Understand [=0x0022=]use [a closed openable container][=0x0022=] as opening. Understand [=0x0022=]use [an open openable container][=0x0022=] as closing.[=0x000A=][=0x000A=]Understand [=0x0022=]use [something preferably held] on [a locked lockable thing][=0x0022=] as unlocking it with (with nouns reversed). Understand [=0x0022=]use [something preferably held] on [an unlocked lockable thing][=0x0022=] as locking it with (with nouns reversed).[=0x000A=][=0x000A=]Understand [=0x0022=]use [a switched off device][=0x0022=] as switching on.[=0x000A=][=0x000A=]Understand [=0x0022=]use [something][=0x0022=] as using. Using is an action applying to one thing. Carry out using: say [=0x0022=]You will have to be more specific about your intentions.[=0x0022=][=0x000A=][=0x000A=]Understand [=0x0022=]use [a door][=0x0022=] as opening. Understand [=0x0022=]use [an open door][=0x0022=] as entering.[=0x000A=][=0x000A=]The Llama Pen is a room. North of the Pen is the gate. The gate is a door. North of the gate is the Rocky Path. The brown llama is an animal in the Llama Pen.[=0x000A=][=0x000A=]Appearance is a kind of value. The appearances are muddy, scruffy, fluffy, and dapper. The brown llama has an appearance. The brown llama is muddy. Before printing the name of the brown llama, say [=0x0022=][appearance] [=0x0022=]. Before printing the name of the brown llama while grooming: say [=0x0022=]now-[if appearance of the brown llama is less than dapper]merely-[end if][=0x0022=].[=0x000A=][=0x000A=]A grooming tool is a kind of thing. Understand [=0x0022=]use [a grooming tool] on [something][=0x0022=] as grooming it with (with nouns reversed). Grooming it with is an action applying to two things. Understand [=0x0022=]groom [something] with [something][=0x0022=] as grooming it with.[=0x000A=][=0x000A=]Carry out grooming it with:[=0x000A=][=0x0009=]if the appearance of the noun is less than dapper, now the appearance of the noun is the appearance after the appearance of the noun.[=0x000A=][=0x000A=]Report grooming it with:[=0x000A=][=0x0009=]say [=0x0022=]You attend diligently to the appearance and hygiene of [the noun].[=0x0022=][=0x000A=][=0x000A=]Instead of using a grooming tool in the presence of the brown llama:[=0x000A=][=0x0009=]try grooming the brown llama with the noun.[=0x000A=][=0x000A=]The player carries some nail nippers, a slicker brush, and an apple. The apple is edible. The brush and the nippers are grooming tools. The player wears a sombrero.[=0x000A=][=0x000A=]The description of the nail nippers is [=0x0022=]Ten inches long, to give you the necessary leverage to cut tough llama toenails. It still helps to soften them up by making the llama stand in a bucket of water first, though.[=0x0022=][=0x000A=][=0x000A=]The description of the slicker brush is [=0x0022=]Fine, angled soft bristles set into a broad back, perfect for removing mud from the coat of a long-woolled llama.[=0x0022=][=0x000A=][=0x000A=]The industrial-strength blower is a fixed in place device in the Llama Pen. [=0x0022=]Attached to the nearest wall, on its own movable boom, is an industrial-strength blower for doing llama hair.[=0x0022=][=0x000A=][=0x000A=]Understand [=0x0022=]use [switched off blower][=0x0022=] as switching on. Understand [=0x0022=]use [switched on blower] on [brown llama][=0x0022=] as grooming it with (with nouns reversed). Instead of using the blower in the presence of the brown llama, try grooming the brown llama with the blower.[=0x000A=][=0x000A=]Test me with [=0x0022=]use gate / use blower / use nippers / use brush / use apple / remove sombrero / use sombrero[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Alpaca Farm&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12050_166" -->
<a id="c12050_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [an edible thing]&quot; as eating.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12051_166" -->
<a id="c12051_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [a wearable thing]&quot; as wearing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12052_166" -->
<a id="c12052_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [a closed openable container]&quot; as opening. Understand &quot;use [an open openable container]&quot; as closing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12053_166" -->
<a id="c12053_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [something preferably held] on [a locked lockable thing]&quot; as unlocking it with (with nouns reversed). Understand &quot;use [something preferably held] on [an unlocked lockable thing]&quot; as locking it with (with nouns reversed).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12054_166" -->
<a id="c12054_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [a switched off device]&quot; as switching on.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12055_166" -->
<a id="c12055_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [something]&quot; as using. Using is an action applying to one thing. Carry out using: say &quot;You will have to be more specific about your intentions.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12056_166" -->
<a id="c12056_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [a door]&quot; as opening. Understand &quot;use [an open door]&quot; as entering.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12057_166" -->
<a id="c12057_166"></a><blockquote class="code"><p class="quoted">
The Llama Pen is a room. North of the Pen is the gate. The gate is a door. North of the gate is the Rocky Path. The brown llama is an animal in the Llama Pen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12058_166" -->
<a id="c12058_166"></a><blockquote class="code"><p class="quoted">
Appearance is a kind of value. The appearances are muddy, scruffy, fluffy, and dapper. The brown llama has an appearance. The brown llama is muddy. Before printing the name of the brown llama, say &quot;[appearance] &quot;. Before printing the name of the brown llama while grooming: say &quot;now-[if appearance of the brown llama is less than dapper]merely-[end if]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12059_166" -->
<a id="c12059_166"></a><blockquote class="code"><p class="quoted">
A grooming tool is a kind of thing. Understand &quot;use [a grooming tool] on [something]&quot; as grooming it with (with nouns reversed). Grooming it with is an action applying to two things. Understand &quot;groom [something] with [something]&quot; as grooming it with.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12060_166" -->
<a id="c12060_166"></a><blockquote class="code"><p class="quoted">
Carry out grooming it with:
<br />&#160;&#160;&#160;&#160;if the appearance of the noun is less than dapper, now the appearance of the noun is the appearance after the appearance of the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12061_166" -->
<a id="c12061_166"></a><blockquote class="code"><p class="quoted">
Report grooming it with:
<br />&#160;&#160;&#160;&#160;say &quot;You attend diligently to the appearance and hygiene of [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12062_166" -->
<a id="c12062_166"></a><blockquote class="code"><p class="quoted">
Instead of using a grooming tool in the presence of the brown llama:
<br />&#160;&#160;&#160;&#160;try grooming the brown llama with the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12063_166" -->
<a id="c12063_166"></a><blockquote class="code"><p class="quoted">
The player carries some nail nippers, a slicker brush, and an apple. The apple is edible. The brush and the nippers are grooming tools. The player wears a sombrero.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12064_166" -->
<a id="c12064_166"></a><blockquote class="code"><p class="quoted">
The description of the nail nippers is &quot;Ten inches long, to give you the necessary leverage to cut tough llama toenails. It still helps to soften them up by making the llama stand in a bucket of water first, though.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12065_166" -->
<a id="c12065_166"></a><blockquote class="code"><p class="quoted">
The description of the slicker brush is &quot;Fine, angled soft bristles set into a broad back, perfect for removing mud from the coat of a long-woolled llama.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12066_166" -->
<a id="c12066_166"></a><blockquote class="code"><p class="quoted">
The industrial-strength blower is a fixed in place device in the Llama Pen. &quot;Attached to the nearest wall, on its own movable boom, is an industrial-strength blower for doing llama hair.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12067_166" -->
<a id="c12067_166"></a><blockquote class="code"><p class="quoted">
Understand &quot;use [switched off blower]&quot; as switching on. Understand &quot;use [switched on blower] on [brown llama]&quot; as grooming it with (with nouns reversed). Instead of using the blower in the presence of the brown llama, try grooming the brown llama with the blower.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12068_166" -->
<a id="c12068_166"></a><blockquote class="code"><p class="quoted">
Test me with &quot;use gate / use blower / use nippers / use brush / use apple / remove sombrero / use sombrero&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Whether we actually want a USE action is a subject of some theoretical debate in the IF community. On the one hand, it helps avoid guess-the-verb problems where the player cannot figure out what term to use in order to express a fairly simple idea. On the other, it encourages the player to think that all items have one and exactly one use, rather than getting him to consider the range of possibilities that arise from having a complex vocabulary.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "369: Apples" "e201" -->
<a id="e201"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example201'); return false;"><b>369</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example201'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Apples</span></b></a><br />Prompting the player on how to disambiguate otherwise similar objects.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc317.html#e201"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example201" style="display: none;">
<p>Inform by default detects whether two objects can be disambiguated by any vocabulary available to the player. If so, it asks a question; if not, it picks one of the identical objects at random.</p>
<p>Generally this produces good behavior. Occasionally, though, two objects have some distinguishing characteristic that doesn't appear in the object name. For instance, suppose we've created a class of apples that can be told apart depending on whether they've been bitten or not:</p>
<!-- START CODE "c12069_201" -->
<a id="c12069_201"></a><blockquote class="code"><p class="quoted">
An apple is a kind of thing. Consumption is a kind of value. The consumptions are pristine and bitten. An apple has a consumption. The description of an apple is &quot;It is [consumption].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12070_201" -->
<a id="c12070_201"></a><blockquote class="code"><p class="quoted">
Understand the consumption property as describing an apple.
</p></blockquote>
<!-- END CODE -->
<p>The player can meaningfully type</p>
<!-- START CODE "c12071_201" -->
<a id="c12071_201"></a><blockquote class="code"><p class="quoted">
&gt;EAT BITTEN APPLE
</p></blockquote>
<!-- END CODE -->
<p>or</p>
<!-- START CODE "c12072_201" -->
<a id="c12072_201"></a><blockquote class="code"><p class="quoted">
&gt;EAT PRISTINE APPLE
</p></blockquote>
<!-- END CODE -->
<p>but if he types</p>
<!-- START CODE "c12073_201" -->
<a id="c12073_201"></a><blockquote class="code"><p class="quoted">
&gt;EAT APPLE
</p></blockquote>
<!-- END CODE -->
<p>Inform will, annoyingly, ask</p>
<!-- START CODE "c12074_201" -->
<a id="c12074_201"></a><blockquote class="code"><p class="quoted">
Which do you mean, an apple or the apple?
</p></blockquote>
<!-- END CODE -->
<p>This gives the player no indication of why Inform is making a distinction. So here we add a special &quot;printing the name&quot; rule to get around that situation:</p>
<!-- START CODE "c12075_201" -->
<a id="c12075_201"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]Apples[=0x0022=][=0x000A=][=0x000A=]Orchard is a room.[=0x000A=][=0x000A=]An apple is a kind of thing. Consumption is a kind of value. The consumptions are pristine and bitten. An apple has a consumption. The description of an apple is [=0x0022=]It is [consumption].[=0x0022=][=0x000A=][=0x000A=]Understand the consumption property as describing an apple.[=0x000A=][=0x000A=]Before printing the name of an apple while asking which do you mean: say [=0x0022=][consumption] [=0x0022=]. Before printing the plural name of an apple while asking which do you mean: say [=0x0022=][consumption] [=0x0022=].[=0x000A=][=0x000A=]The player carries three apples.[=0x000A=][=0x000A=]Instead of eating a pristine apple (called the fruit):[=0x000A=][=0x0009=]say [=0x0022=]You take a satisfying bite.[=0x0022=];[=0x000A=][=0x0009=]now the fruit is bitten.[=0x000A=][=0x000A=]Instead of eating a bitten apple (called the fruit):[=0x000A=][=0x0009=]say [=0x0022=]You consume the apple entirely.[=0x0022=];[=0x000A=][=0x0009=]now the fruit is nowhere.[=0x000A=][=0x000A=][Inform will also separate the bitten from the pristine apples in inventory listings and room descriptions, even though it[=0x0027=]s not clear why; we can improve on that behavior thus:][=0x000A=][=0x000A=]Before listing contents: group apples together.[=0x000A=][=0x000A=]Rule for grouping together an apple (called target):[=0x000A=][=0x0009=]let source be the holder of the target;[=0x000A=][=0x0009=]say [=0x0022=][number of apples held by the source in words] apple[s], some bitten[=0x0022=].[=0x000A=][=0x000A=]Before printing the plural name of an apple (called target):[=0x000A=][=0x0009=]let source be the holder of the target;[=0x000A=][=0x0009=]if every apple held by the source is bitten, say [=0x0022=]bitten [=0x0022=];[=0x000A=][=0x0009=]if every apple held by the source is pristine, say [=0x0022=]pristine [=0x0022=].[=0x000A=][=0x000A=]Test me with [=0x0022=]i / eat apple / i / eat apple / pristine / i / eat apple / pristine / i[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a>  &quot;Apples&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12076_201" -->
<a id="c12076_201"></a><blockquote class="code"><p class="quoted">
Orchard is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12077_201" -->
<a id="c12077_201"></a><blockquote class="code"><p class="quoted">
An apple is a kind of thing. Consumption is a kind of value. The consumptions are pristine and bitten. An apple has a consumption. The description of an apple is &quot;It is [consumption].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12078_201" -->
<a id="c12078_201"></a><blockquote class="code"><p class="quoted">
Understand the consumption property as describing an apple.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12079_201" -->
<a id="c12079_201"></a><blockquote class="code"><p class="quoted">
Before printing the name of an apple while asking which do you mean: say &quot;[consumption] &quot;. Before printing the plural name of an apple while asking which do you mean: say &quot;[consumption] &quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12080_201" -->
<a id="c12080_201"></a><blockquote class="code"><p class="quoted">
The player carries three apples.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12081_201" -->
<a id="c12081_201"></a><blockquote class="code"><p class="quoted">
Instead of eating a pristine apple (called the fruit):
<br />&#160;&#160;&#160;&#160;say &quot;You take a satisfying bite.&quot;;
<br />&#160;&#160;&#160;&#160;now the fruit is bitten.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12082_201" -->
<a id="c12082_201"></a><blockquote class="code"><p class="quoted">
Instead of eating a bitten apple (called the fruit):
<br />&#160;&#160;&#160;&#160;say &quot;You consume the apple entirely.&quot;;
<br />&#160;&#160;&#160;&#160;now the fruit is nowhere.
</p></blockquote>
<!-- END CODE -->
<p>Inform will also separate the bitten from the pristine apples in inventory listings and room descriptions, even though it's not clear why; we can improve on that behavior thus:</p>
<!-- START CODE "c12083_201" -->
<a id="c12083_201"></a><blockquote class="code"><p class="quoted">
Before listing contents: group apples together.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12084_201" -->
<a id="c12084_201"></a><blockquote class="code"><p class="quoted">
Rule for grouping together an apple (called target):
<br />&#160;&#160;&#160;&#160;let source be the holder of the target;
<br />&#160;&#160;&#160;&#160;say &quot;[number of apples held by the source in words] apple[s], some bitten&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12085_201" -->
<a id="c12085_201"></a><blockquote class="code"><p class="quoted">
Before printing the plural name of an apple (called target):
<br />&#160;&#160;&#160;&#160;let source be the holder of the target;
<br />&#160;&#160;&#160;&#160;if every apple held by the source is bitten, say &quot;bitten &quot;;
<br />&#160;&#160;&#160;&#160;if every apple held by the source is pristine, say &quot;pristine &quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12086_201" -->
<a id="c12086_201"></a><blockquote class="code"><p class="quoted">
Test me with &quot;i / eat apple / i / eat apple / pristine / i / eat apple / pristine / i&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "380: WXPQ" "e0" -->
<a id="e0"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example0'); return false;"><b>380</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example0'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">WXPQ</span></b></a><br />Creating a more sensible parser error than "that noun did not make sense in this context".</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc321.html#e0"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example0" style="display: none;">
<p>The parser error &quot;That noun did not make sense in this context&quot; arises instead of &quot;You can't see any such thing&quot; when the player uses a command that could apply to any item in the game -- that is, a command such as</p>
<!-- START CODE "c12087_0" -->
<a id="c12087_0"></a><blockquote class="code"><p class="quoted">
Understand &quot;go to [any room]&quot; as going directly to.
<br />Understand &quot;talk about [any subject]&quot; as discussing.
</p></blockquote>
<!-- END CODE -->
<p>...and so on. The idea here is that &quot;You can't see any such thing&quot; isn't a sensible rejoinder when the player doesn't really need to be able to see the object.</p>
<p>Nonetheless, &quot;That noun did not make sense...&quot; is itself a fairly dry and uninformative response, and we may want to override it to something more appropriate for the specific kind of context in which it might appear. For instance:</p>
<!-- START CODE "c12088_0" -->
<a id="c12088_0"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode(' [=0x0022=]WXPQ[=0x0022=][=0x000A=][=0x000A=]WXPQ Studio is a room. [=0x0022=]After about 2 AM, no one is listening anyway, so you can more or less make up whatever you like to fill the airwaves.[=0x0022=][=0x000A=][=0x000A=]John F Kennedy, Elvis, Ralph Nader, Tony Blair, and single-origin chocolate are things.[=0x000A=][=0x000A=]Understand [=0x0022=]talk about [any thing][=0x0022=] or [=0x0022=]discuss [any thing][=0x0022=] as discussing. Discussing is an action applying to one visible thing.[=0x000A=][=0x000A=]Carry out discussing:[=0x000A=][=0x0009=]say [=0x0022=]You babble for a while about your [one of]interest in[or]hatred of[or]passionate devotion to[or]conspiracy theory concerning[or]mother[=0x0027=]s secret love affair with[as decreasingly likely outcomes] [the noun].[=0x0022=][=0x000A=][=0x000A=]Rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:[=0x000A=][=0x0009=]say [=0x0022=]For once, you[=0x0027=]re at a loss for anything to say.[=0x0022=][=0x000A=][=0x000A=]Test me with [=0x0022=]discuss Elvis / discuss Kennedy / discuss chocolate / discuss narratology vs ludology debate[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a>  &quot;WXPQ&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12089_0" -->
<a id="c12089_0"></a><blockquote class="code"><p class="quoted">
WXPQ Studio is a room. &quot;After about 2 AM, no one is listening anyway, so you can more or less make up whatever you like to fill the airwaves.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12090_0" -->
<a id="c12090_0"></a><blockquote class="code"><p class="quoted">
John F Kennedy, Elvis, Ralph Nader, Tony Blair, and single-origin chocolate are things.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12091_0" -->
<a id="c12091_0"></a><blockquote class="code"><p class="quoted">
Understand &quot;talk about [any thing]&quot; or &quot;discuss [any thing]&quot; as discussing. Discussing is an action applying to one visible thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12092_0" -->
<a id="c12092_0"></a><blockquote class="code"><p class="quoted">
Carry out discussing:
<br />&#160;&#160;&#160;&#160;say &quot;You babble for a while about your [one of]interest in[or]hatred of[or]passionate devotion to[or]conspiracy theory concerning[or]mother's secret love affair with[as decreasingly likely outcomes] [the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12093_0" -->
<a id="c12093_0"></a><blockquote class="code"><p class="quoted">
Rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
<br />&#160;&#160;&#160;&#160;say &quot;For once, you're at a loss for anything to say.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12094_0" -->
<a id="c12094_0"></a><blockquote class="code"><p class="quoted">
Test me with &quot;discuss Elvis / discuss Kennedy / discuss chocolate / discuss narratology vs ludology debate&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Note that this solution works as simply as it does because we only have one command in the game that can apply to an &quot;[any]&quot; token. If we had several, we'd need to distinguish between the parser error attached to &quot;discuss&quot; and the parser error attached to &quot;go to&quot; (for instance). In that case, we might instead write something like</p>
<!-- START CODE "c12095_0" -->
<a id="c12095_0"></a><blockquote class="code"><p class="quoted">
Rule for printing a parser error when the latest parser error is the noun did not make sense in that context error:
<br />if the player's command includes &quot;go&quot;:
<br />&#160;&#160;&#160;&#160;say &quot;There's no such place you know how to get to.&quot;;
<br />otherwise:
<br />&#160;&#160;&#160;&#160;say &quot;For once, you're at a loss for anything to say.&quot;
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "370: Walls and Noses" "e183" -->
<a id="e183"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example183'); return false;"><b>370</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example183'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Walls and Noses</span></b></a><br />Responding to "EXAMINE WALL" with "In which direction?", and to "EXAMINE NOSE" with "Whose nose do you mean, Frederica's, Betty's, Wilma's or your own?"</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc317.html#e183"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example183" style="display: none;">
<p>Suppose we want our game to respond to &quot;EXAMINE WALL&quot; with &quot;In which direction?&quot;, and to &quot;EXAMINE NOSE&quot; with &quot;Whose nose do you mean, Frederica's, Betty's, Wilma's or your own?&quot;</p>
<p>For the case of EXAMINE WALL, we need a way to determine whether every item being disambiguated is a direction. We'll start by making a &quot;matched&quot; adjective which will identify items being disambiguated:</p>
<!-- START CODE "c12096_183" -->
<a id="c12096_183"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Walls and Noses[=0x0022=][=0x000A=][=0x000A=]Eight-Walled Chamber is a room. [=0x0022=]A perfectly octagonal room whose walls are tinted in various hues.[=0x0022=][=0x000A=][=0x000A=]Understand [=0x0022=]wall[=0x0022=] as a direction.[=0x000A=][=0x000A=]Definition: a direction is matched if it fits the parse list.[=0x000A=]Definition: a room is matched if it fits the parse list.[=0x000A=]Definition: a thing is matched if it fits the parse list.[=0x000A=][=0x000A=]Rule for asking which do you mean when everything matched is direction:[=0x000A=][=0x0009=]say [=0x0022=]In which direction?[=0x0022=][=0x000A=][=0x000A=][Checking the parse list requires a bit of behind-the-scenes work with Inform 6. Fortunately, you don[=0x0027=]t have to understand this entirely in order to use the rest of the example:][=0x000A=][=0x000A=]To decide whether (N - an object) fits the parse list:[=0x000A=][=0x0009=](- (FindInParseList({N})) -)[=0x000A=][=0x000A=]Include (-[=0x000A=][ FindInParseList obj i k marker;[=0x000A=][=0x0009=]marker = 0;[=0x000A=][=0x0009=]for (i=1 : i[=0x003C=]=number_of_classes : i++) {[=0x000A=][=0x0009=]while (((match_classes--[=0x003E=]marker) ~= i) [=0x0026=][=0x0026=] ((match_classes--[=0x003E=]marker) ~= -i)) marker++;[=0x000A=][=0x0009=]k = match_list--[=0x003E=]marker;[=0x000A=][=0x0009=]if (k==obj) rtrue;[=0x000A=][=0x0009=]}[=0x000A=][=0x0009=]rfalse;[=0x000A=]];[=0x000A=]-)[=0x000A=][=0x000A=][Now that we[=0x0027=]ve defined our [=0x0022=]matched[=0x0022=] adjective, we can use it for other purposes as well -- even generating our own lists. Our second challenge was to respond to EXAMINE NOSE with [=0x0022=]Whose nose do you mean, Frederica[=0x0027=]s, Betty[=0x0027=]s, Wilma[=0x0027=]s or your own?[=0x0022=]][=0x000A=][=0x000A=][Here we need to change the way the question is worded (not [=0x0022=]which do you mean[=0x0022=] but [=0x0022=]whose nose do you mean[=0x0022=]). We also have to the names of the noses as they[=0x0027=]re printed in this particular context, so that they don[=0x0027=]t repeat the word [=0x0022=]nose[=0x0022=] over and over. And -- as a point of good English style -- we also want [=0x0022=]your own[=0x0022=] nose always to be last on the list.][=0x000A=][=0x000A=][For this purpose we may want to use the built-in [=0x0022=]Complex Listing[=0x0022=] extension, which allows us to print specially ordered lists. So:][=0x000A=][=0x000A=]Include Complex Listing by Emily Short.[=0x000A=][=0x000A=]Wilma, Betty, and Frederica are women in the Eight-Walled Chamber. Understand [=0x0022=]lady[=0x0022=] or [=0x0022=]woman[=0x0022=] as a woman. A nose is a kind of thing. A nose is part of every person.[=0x000A=][=0x000A=]Rule for asking which do you mean when everything matched is a nose:[=0x000A=][=0x0009=]prepare a list of matched things;[=0x000A=][=0x0009=]if your nose is an output listed in the Table of Scored Listing:[=0x000A=][=0x0009=][=0x0009=]choose row with an output of your nose in the Table of Scored Listing;[=0x000A=][=0x0009=][=0x0009=]now the assigned score entry is -1;[=0x000A=][=0x0009=]say [=0x0022=]Whose nose do you mean, [the prepared list delimited in disjunctive style]?[=0x0022=][=0x000A=][=0x000A=]Rule for printing the name of a nose (called target) while asking which do you mean :[=0x000A=][=0x0009=]if everything matched is a nose:[=0x000A=][=0x0009=][=0x0009=]if the target is part of a person (called owner):[=0x000A=][=0x0009=][=0x0009=][=0x0009=]if the owner is the player, say [=0x0022=]your own[=0x0022=];[=0x000A=][=0x0009=][=0x0009=][=0x0009=]otherwise say [=0x0022=][the owner][apostrophe]s[=0x0022=];[=0x000A=][=0x0009=]otherwise:[=0x000A=][=0x0009=][=0x0009=]make no decision.[=0x000A=][=0x000A=]Understand [=0x0022=]own[=0x0022=] or [=0x0022=]mine[=0x0022=] as your nose.[=0x000A=][=0x000A=]Test me with [=0x0022=]x wall / north / x nose / mine[=0x0022=].[=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Walls and Noses&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12097_183" -->
<a id="c12097_183"></a><blockquote class="code"><p class="quoted">
Eight-Walled Chamber is a room. &quot;A perfectly octagonal room whose walls are tinted in various hues.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12098_183" -->
<a id="c12098_183"></a><blockquote class="code"><p class="quoted">
Understand &quot;wall&quot; as a direction.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12099_183" -->
<a id="c12099_183"></a><blockquote class="code"><p class="quoted">
Definition: a direction is matched if it fits the parse list.
<br />Definition: a room is matched if it fits the parse list.
<br />Definition: a thing is matched if it fits the parse list.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12100_183" -->
<a id="c12100_183"></a><blockquote class="code"><p class="quoted">
Rule for asking which do you mean when everything matched is direction:
<br />&#160;&#160;&#160;&#160;say &quot;In which direction?&quot;
</p></blockquote>
<!-- END CODE -->
<p>Checking the parse list requires a bit of behind-the-scenes work with Inform 6. Fortunately, you don't have to understand this entirely in order to use the rest of the example:</p>
<!-- START CODE "c12101_183" -->
<a id="c12101_183"></a><blockquote class="code"><p class="quoted">
To decide whether (N - an object) fits the parse list:
<br />&#160;&#160;&#160;&#160;(- (FindInParseList({N})) -)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12102_183" -->
<a id="c12102_183"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ FindInParseList obj i k marker;
<br />&#160;&#160;&#160;&#160;marker = 0;
<br />&#160;&#160;&#160;&#160;for (i=1 : i&lt;=number_of_classes : i++) {
<br />&#160;&#160;&#160;&#160;while (((match_classes--&gt;marker) ~= i) &amp;&amp; ((match_classes--&gt;marker) ~= -i)) marker++;
<br />&#160;&#160;&#160;&#160;k = match_list--&gt;marker;
<br />&#160;&#160;&#160;&#160;if (k==obj) rtrue;
<br />&#160;&#160;&#160;&#160;}
<br />&#160;&#160;&#160;&#160;rfalse;
<br />];
<br />-)
</p></blockquote>
<!-- END CODE -->
<p>Now that we've defined our &quot;matched&quot; adjective, we can use it for other purposes as well -- even generating our own lists. Our second challenge was to respond to EXAMINE NOSE with &quot;Whose nose do you mean, Frederica's, Betty's, Wilma's or your own?&quot;</p>
<p>Here we need to change the way the question is worded (not &quot;which do you mean&quot; but &quot;whose nose do you mean&quot;). We also have to the names of the noses as they're printed in this particular context, so that they don't repeat the word &quot;nose&quot; over and over. And -- as a point of good English style -- we also want &quot;your own&quot; nose always to be last on the list.</p>
<p>For this purpose we may want to use the built-in &quot;Complex Listing&quot; extension, which allows us to print specially ordered lists. So:</p>
<!-- START CODE "c12103_183" -->
<a id="c12103_183"></a><blockquote class="code"><p class="quoted">
Include Complex Listing by Emily Short.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12104_183" -->
<a id="c12104_183"></a><blockquote class="code"><p class="quoted">
Wilma, Betty, and Frederica are women in the Eight-Walled Chamber. Understand &quot;lady&quot; or &quot;woman&quot; as a woman. A nose is a kind of thing. A nose is part of every person.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12105_183" -->
<a id="c12105_183"></a><blockquote class="code"><p class="quoted">
Rule for asking which do you mean when everything matched is a nose:
<br />&#160;&#160;&#160;&#160;prepare a list of matched things;
<br />&#160;&#160;&#160;&#160;if your nose is an output listed in the Table of Scored Listing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;choose row with an output of your nose in the Table of Scored Listing;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the assigned score entry is -1;
<br />&#160;&#160;&#160;&#160;say &quot;Whose nose do you mean, [the prepared list delimited in disjunctive style]?&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12106_183" -->
<a id="c12106_183"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a nose (called target) while asking which do you mean :
<br />&#160;&#160;&#160;&#160;if everything matched is a nose:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the target is part of a person (called owner):
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the owner is the player, say &quot;your own&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise say &quot;[the owner][apostrophe]s&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;make no decision.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12107_183" -->
<a id="c12107_183"></a><blockquote class="code"><p class="quoted">
Understand &quot;own&quot; or &quot;mine&quot; as your nose.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12108_183" -->
<a id="c12108_183"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x wall / north / x nose / mine&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<!-- START EXAMPLE "424: Cave-troll" "e342" -->
<a id="e342"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="#" class="eglink" onclick="showExample('example342'); return false;"><b>424</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="#" class="eglink" onclick="showExample('example342'); return false;"><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><img class="asterisk" alt="*" src="inform:/doc_images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Cave-troll</span></b></a><br />Determining that the command the player typed is invalid, editing it, and re-examining it to see whether it now reads correctly.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="doc350.html#e342"><i>WI</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example342" style="display: none;">
<p>Novice players of interactive fiction, unfamiliar with its conventions, will often try to add extra phrases to a command that the game cannot properly parse: HIT DOOR WITH FIST, for instance, instead of HIT DOOR.</p>
<p>While we can deal with some of these instances by expanding our range of actions, at some point it becomes impossible to account for all the possible prepositional phrases that the player might want to tack on. So what do we do if we want to handle those appended bits of text sensibly?</p>
<p>We could go through and remove any piece of text containing &quot;with ...&quot; from the end of a player's command; the problem with that is that it overzealously lops off the ends of valid commands like UNLOCK DOOR WITH KEY, as well. So clearly we don't want to do this as part of the &quot;After reading a command...&quot; stage.</p>
<p>A better time to cut off the offending text is right before issuing a parser error. At that point, Inform has already determined that it definitely cannot parse the instruction as given, so we know that there's something wrong with it.</p>
<p>The next problem, though, is that after we've edited the player's text we want to feed the corrected version back to Inform and try once more to interpret it.</p>
<p>This is where we have a valid reason to write a new &quot;rule for reading a command&quot;. We will tell Inform that when we have just corrected the player's input to something new, it should not ask for a new command (by printing a prompt and waiting for another line of input); it should instead paste our stored corrected command back into &quot;the player's command&quot; and proceed as though that new text had just been typed.</p>
<p>Thanks to John Clemens for the specifics of the implementation.</p>
<!-- START CODE "c12109_342" -->
<a id="c12109_342"></a><blockquote class="code"><p class="quoted">
<a href="javascript:pasteCode('[=0x0022=]Cave-troll[=0x0022=] by JDC[=0x000A=][=0x000A=]Section 1 - The Mechanism[=0x000A=][=0x000A=]The last command is a text that varies.[=0x000A=][=0x000A=]The parser error flag is a truth state that varies. The parser error flag is false.[=0x000A=][=0x000A=]Rule for printing a parser error when the latest parser error is the only understood as far as error and the player[=0x0027=]s command matches the text [=0x0022=]with[=0x0022=]:[=0x000A=][=0x0009=]now the last command is the player[=0x0027=]s command;[=0x000A=][=0x0009=]now the parser error flag is true;[=0x000A=][=0x0009=]let n be [=0x0022=][the player[=0x0027=]s command][=0x0022=];[=0x000A=][=0x0009=]replace the regular expression [=0x0022=].* with (.*)[=0x0022=] in n with [=0x0022=]with [=0x005C=]1[=0x0022=];[=0x000A=][=0x0009=]say [=0x0022=](ignoring the unnecessary words [=0x0027=][n][=0x0027=])[line break][=0x0022=];[=0x000A=][=0x0009=]replace the regular expression [=0x0022=]with .*[=0x0022=] in the last command with [=0x0022=][=0x0022=].[=0x000A=][=0x000A=]Rule for reading a command when the parser error flag is true:[=0x000A=][=0x0009=]now the parser error flag is false;[=0x000A=][=0x0009=]change the text of the player[=0x0027=]s command to the last command.[=0x000A=][=0x000A=]Section 2 - The Scenario[=0x000A=][=0x000A=]The Cave is a room.[=0x000A=][=0x000A=]The troll is a man in the cave.[=0x000A=][=0x000A=]The player carries a sword.[=0x000A=][=0x000A=]The chest is a locked lockable container in the cave.[=0x000A=][=0x000A=]Test me with [=0x0022=]attack troll with sword / unlock chest with sword / attack troll as a test[=0x0022=].[=0x000A=][=0x000A=]\n')"><img alt="paste.png" src="inform:/doc_images/paste.png" /></a> &quot;Cave-troll&quot; by JDC
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12110_342" -->
<a id="c12110_342"></a><blockquote class="code"><p class="quoted">
Section 1 - The Mechanism
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12111_342" -->
<a id="c12111_342"></a><blockquote class="code"><p class="quoted">
The last command is a text that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12112_342" -->
<a id="c12112_342"></a><blockquote class="code"><p class="quoted">
The parser error flag is a truth state that varies. The parser error flag is false.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12113_342" -->
<a id="c12113_342"></a><blockquote class="code"><p class="quoted">
Rule for printing a parser error when the latest parser error is the only understood as far as error and the player's command matches the text &quot;with&quot;:
<br />&#160;&#160;&#160;&#160;now the last command is the player's command;
<br />&#160;&#160;&#160;&#160;now the parser error flag is true;
<br />&#160;&#160;&#160;&#160;let n be &quot;[the player's command]&quot;;
<br />&#160;&#160;&#160;&#160;replace the regular expression &quot;.* with (.*)&quot; in n with &quot;with \1&quot;;
<br />&#160;&#160;&#160;&#160;say &quot;(ignoring the unnecessary words '[n]')[line break]&quot;;
<br />&#160;&#160;&#160;&#160;replace the regular expression &quot;with .*&quot; in the last command with &quot;&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12114_342" -->
<a id="c12114_342"></a><blockquote class="code"><p class="quoted">
Rule for reading a command when the parser error flag is true:
<br />&#160;&#160;&#160;&#160;now the parser error flag is false;
<br />&#160;&#160;&#160;&#160;change the text of the player's command to the last command.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12115_342" -->
<a id="c12115_342"></a><blockquote class="code"><p class="quoted">
Section 2 - The Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12116_342" -->
<a id="c12116_342"></a><blockquote class="code"><p class="quoted">
The Cave is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12117_342" -->
<a id="c12117_342"></a><blockquote class="code"><p class="quoted">
The troll is a man in the cave.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12118_342" -->
<a id="c12118_342"></a><blockquote class="code"><p class="quoted">
The player carries a sword.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12119_342" -->
<a id="c12119_342"></a><blockquote class="code"><p class="quoted">
The chest is a locked lockable container in the cave.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c12120_342" -->
<a id="c12120_342"></a><blockquote class="code"><p class="quoted">
Test me with &quot;attack troll with sword / unlock chest with sword / attack troll as a test&quot;.
</p></blockquote>
<!-- END CODE -->
<p>A caveat about using this method in a larger game: &quot;parser error flag&quot; will not automatically control the behavior of any rules we might have written for Before reading a command... or After reading a command..., so they may now fire at inappropriate times. It is a good idea to check for parser error flag in those rules as well.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<div class="bookfooter">
<table class="fullwidth"><tr><td class="footerprevious"><a href="Rdoc44.html" class="footerlink">Previous</a></td><td class="footercontents"><a href="index.html" class="footerlink">Contents</a></td><td class="footernext"><a href="Rdoc46.html" class="footerlink">Next</a></td></tr></table>
</div>
<!-- END IGNORE -->
</body>
</html>
